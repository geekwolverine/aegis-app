exports.id=552,exports.ids=[552],exports.modules={54552:(e,t,r)=>{const o=r(873),s=r(16996),i=r(737),n=r(88691),a=r(42972),c=r(75320),p=r(18279),d=r(9955),u=r(77666),l=r(13595),h=r(34517),m=r(98203),f=r(29879),{LEVELS:g}=r(10354);e.exports={Kafka:o,PartitionAssigners:s,AssignerProtocol:i,Partitioners:n,logLevel:g,CompressionTypes:a.Types,CompressionCodecs:a.Codecs,ResourceTypes:c,ConfigResourceTypes:p,AclResourceTypes:u,AclOperationTypes:l,AclPermissionTypes:h,ResourcePatternTypes:m,ConfigSource:d,...f}},55929:(e,t,r)=>{const o=r(99701),s=r(74358),i=r(86335),n=r(53163),a=r(40763),c=r(52190),{events:p,wrap:d,unwrap:u}=r(87881),{LEVELS:l}=r(10354),{KafkaJSNonRetriableError:h,KafkaJSDeleteGroupsError:m,KafkaJSBrokerNotFound:f,KafkaJSDeleteTopicRecordsError:g,KafkaJSAggregateError:I}=r(29879),{staleMetadata:y}=r(21701),w=r(18279),T=r(77666),E=r(13595),b=r(34517),S=r(98203),{EARLIEST_OFFSET:A,LATEST_OFFSET:O}=r(53904),{CONNECT:C,DISCONNECT:N}=p,{values:R,keys:k,entries:x}=Object,v=R(p),_=k(p).map((e=>`admin.events.${e}`)).join(", "),B=async(e,t)=>(await e.addTargetTopic(t),await e.refreshMetadataIfNecessary(),e.findTopicPartitionMetadata(t).map((({partitionId:e})=>e)).sort());e.exports=({logger:e,instrumentationEmitter:t,retry:r,cluster:k})=>{const P=e.namespace("Admin"),L=t||new c,D=async e=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic ${e}`);return o(r)((async(t,r,o)=>{try{await k.addTargetTopic(e),await k.refreshMetadataIfNecessary();const t=k.findTopicPartitionMetadata(e),r=await k.fetchTopicsOffset([{topic:e,fromBeginning:!1,partitions:t.map((e=>({partition:e.partitionId})))}]),o=await k.fetchTopicsOffset([{topic:e,fromBeginning:!0,partitions:t.map((e=>({partition:e.partitionId})))}]),{partitions:s}=r.pop(),{partitions:i}=o.pop();return s.map((({partition:e,offset:t})=>({partition:e,offset:t,high:t,low:i.find((({partition:t})=>t===e)).offset})))}catch(e){if("UNKNOWN_TOPIC_OR_PARTITION"===e.type)throw await k.refreshMetadata(),e;t(e)}}))},M=async({groupId:t,topic:r,partitions:o})=>{if(!t)throw new h(`Invalid groupId ${t}`);if(!r)throw new h(`Invalid topic ${r}`);if(!o||0===o.length)throw new h("Invalid partitions");const s=a({logger:e.namespace("Admin",l.NOTHING),cluster:k,groupId:t});await s.subscribe({topic:r,fromBeginning:!0});const i=await s.describeGroup();if(!(e=>["Empty","Dead"].includes(e.state))(i))throw new h(`The consumer group must have no running instances, current state: ${i.state}`);return new Promise(((e,t)=>{s.on(s.events.FETCH,(async()=>s.stop().then(e).catch(t))),s.run({eachBatchAutoResolve:!1,eachBatch:async()=>!0}).catch(t),s.pause([{topic:r}]);for(const e of o)s.seek({topic:r,...e})}))},q=({resources:e,defaultBroker:t})=>n(e,(async({type:e,name:r})=>(e=>[w.BROKER,w.BROKER_LOGGER].includes(e))(e)?await k.findBroker({nodeId:String(r)}):t));return{connect:async()=>{await k.connect(),L.emit(C)},disconnect:async()=>{await k.disconnect(),L.emit(N)},listTopics:async()=>{const{topicMetadata:e}=await k.metadata();return e.map((e=>e.topic))},createTopics:async({topics:e,validateOnly:t,timeout:s,waitForLeaders:n=!0})=>{if(!e||!Array.isArray(e))throw new h(`Invalid topics array ${e}`);if(e.filter((({topic:e})=>"string"!=typeof e)).length>0)throw new h("Invalid topics array, the topic names have to be a valid string");const a=new Set(e.map((({topic:e})=>e)));if(a.size<e.length)throw new h("Invalid topics array, it cannot have multiple entries for the same topic");return o(r)((async(r,o,c)=>{try{await k.refreshMetadata();const r=await k.findControllerBroker();if(await r.createTopics({topics:e,validateOnly:t,timeout:s}),n){const e=Array.from(a.values());await((e,t={})=>i((async()=>{try{return await e()}catch(e){if("LEADER_NOT_AVAILABLE"!==e.type)throw e;return!1}}),t))((async()=>await r.metadata(e)),{delay:100,maxWait:s,timeoutMessage:"Timed out while waiting for topic leaders"})}return!0}catch(e){if("NOT_CONTROLLER"===e.type)throw P.warn("Could not create topics",{error:e.message,retryCount:o,retryTime:c}),e;if(e instanceof I&&e.errors.every((e=>"TOPIC_ALREADY_EXISTS"===e.type)))return!1;r(e)}}))},deleteTopics:async({topics:e,timeout:t})=>{if(!e||!Array.isArray(e))throw new h(`Invalid topics array ${e}`);if(e.filter((e=>"string"!=typeof e)).length>0)throw new h("Invalid topics array, the names must be a valid string");return o(r)((async(r,o,s)=>{try{await k.refreshMetadata();const r=await k.findControllerBroker();await r.deleteTopics({topics:e,timeout:t});for(const t of e)k.targetTopics.delete(t);await k.refreshMetadata()}catch(e){if(["NOT_CONTROLLER","UNKNOWN_TOPIC_OR_PARTITION"].includes(e.type))throw P.warn("Could not delete topics",{error:e.message,retryCount:o,retryTime:s}),e;"REQUEST_TIMED_OUT"===e.type&&P.error('Could not delete topics, check if "delete.topic.enable" is set to "true" (the default value is "false") or increase the timeout',{error:e.message,retryCount:o,retryTime:s}),r(e)}}))},createPartitions:async({topicPartitions:e,validateOnly:t,timeout:s})=>{if(!e||!Array.isArray(e))throw new h(`Invalid topic partitions array ${e}`);if(0===e.length)throw new h("Empty topic partitions array");if(e.filter((({topic:e})=>"string"!=typeof e)).length>0)throw new h("Invalid topic partitions array, the topic names have to be a valid string");if(new Set(e.map((({topic:e})=>e))).size<e.length)throw new h("Invalid topic partitions array, it cannot have multiple entries for the same topic");return o(r)((async(r,o,i)=>{try{await k.refreshMetadata();const r=await k.findControllerBroker();await r.createPartitions({topicPartitions:e,validateOnly:t,timeout:s})}catch(e){if("NOT_CONTROLLER"===e.type)throw P.warn("Could not create topics",{error:e.message,retryCount:o,retryTime:i}),e;r(e)}}))},getTopicMetadata:async e=>{const{topics:t}=e||{};t&&await Promise.all(t.map((async e=>{if(!e)throw new h(`Invalid topic ${e}`);try{await k.addTargetTopic(e)}catch(t){throw t.message=`Failed to add target topic ${e}: ${t.message}`,t}}))),await k.refreshMetadataIfNecessary();const r=t||[...k.targetTopics];return{topics:await Promise.all(r.map((async e=>({name:e,partitions:k.findTopicPartitionMetadata(e)}))))}},fetchTopicMetadata:async({topics:e=[]}={})=>(e&&e.forEach((e=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic ${e}`)})),{topics:(await k.metadata({topics:e})).topicMetadata.map((e=>({name:e.topic,partitions:e.partitionMetadata})))}),describeCluster:async()=>{const{brokers:e,clusterId:t,controllerId:r}=await k.metadata({topics:[]});return{brokers:e.map((({nodeId:e,host:t,port:r})=>({nodeId:e,host:t,port:r}))),controller:null==r||-1===r?null:r,clusterId:t}},events:p,fetchOffsets:async({groupId:e,topic:t,topics:r,resolveOffsets:o=!1})=>{if(!e)throw new h(`Invalid groupId ${e}`);if(t||r||(r=[]),!t&&!Array.isArray(r))throw new h("Expected topic or topics array to be set");if(t&&r)throw new h("Either topic or topics must be set, not both");t&&(r=[t]);const s=await k.findGroupCoordinator({groupId:e}),i=await Promise.all(r.map((async e=>({topic:e,partitions:(await B(k,e)).map((e=>({partition:e})))}))));let{responses:n}=await s.offsetFetch({groupId:e,topics:i});o&&(n=await Promise.all(n.map((async({topic:t,partitions:r})=>{const o=(await D(t)).reduce(((e,{partition:t,...r})=>Object.assign(e,{[t]:{...r}})),{}),s=r.map((({offset:e,partition:t,...r})=>{let s=e;return Number(e)===A&&(s=o[t].low),Number(e)===O&&(s=o[t].high),{partition:t,offset:s,...r}}));return await M({groupId:e,topic:t,partitions:s}),{topic:t,partitions:s}}))));const a=n.map((({topic:e,partitions:t})=>({topic:e,partitions:t.map((({partition:e,offset:t,metadata:r})=>({partition:e,offset:t,metadata:r||null})))})));return t?a.pop().partitions:a},fetchTopicOffsets:D,fetchTopicOffsetsByTimestamp:async(e,t)=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic ${e}`);return o(r)((async(r,o,s)=>{try{await k.addTargetTopic(e),await k.refreshMetadataIfNecessary();const r=k.findTopicPartitionMetadata(e).map((e=>({partition:e.partitionId}))),o=await k.fetchTopicsOffset([{topic:e,fromBeginning:!1,partitions:r}]),{partitions:s}=o.pop(),i=await k.fetchTopicsOffset([{topic:e,fromTimestamp:t,partitions:r}]),{partitions:n}=i.pop();return n.map((({partition:e,offset:t})=>({partition:e,offset:parseInt(t,10)>=0?t:s.find((({partition:t})=>t===e)).offset})))}catch(e){if("UNKNOWN_TOPIC_OR_PARTITION"===e.type)throw await k.refreshMetadata(),e;r(e)}}))},setOffsets:M,resetOffsets:async({groupId:e,topic:t,earliest:r=!1})=>{if(!e)throw new h(`Invalid groupId ${e}`);if(!t)throw new h(`Invalid topic ${t}`);const o=(await B(k,t)).map((e=>({partition:e,offset:k.defaultOffset({fromBeginning:r})})));return M({groupId:e,topic:t,partitions:o})},describeConfigs:async({resources:e,includeSynonyms:t})=>{if(!e||!Array.isArray(e))throw new h(`Invalid resources array ${e}`);if(0===e.length)throw new h("Resources array cannot be empty");const s=Object.values(w),i=e.find((e=>!s.includes(e.type)));if(i)throw new h(`Invalid resource type ${i.type}: ${JSON.stringify(i)}`);const n=e.find((e=>!e.name||"string"!=typeof e.name));if(n)throw new h(`Invalid resource name ${n.name}: ${JSON.stringify(n)}`);const a=e.find((e=>!Array.isArray(e.configNames)&&null!=e.configNames));if(a){const{configNames:e}=a;throw new h(`Invalid resource configNames ${e}: ${JSON.stringify(a)}`)}return o(r)((async(r,o,s)=>{try{await k.refreshMetadata();const r=await k.findControllerBroker(),o=await q({resources:e,defaultBroker:r}),s=async e=>{const s=e||r;return s.describeConfigs({resources:o.get(s),includeSynonyms:t})},i=Array.from(o.keys()),n=(await Promise.all(i.map(s))).reduce(((e,{resources:t})=>[...e,...t]),[]);return{resources:n}}catch(e){if("NOT_CONTROLLER"===e.type)throw P.warn("Could not describe configs",{error:e.message,retryCount:o,retryTime:s}),e;r(e)}}))},alterConfigs:async({resources:e,validateOnly:t})=>{if(!e||!Array.isArray(e))throw new h(`Invalid resources array ${e}`);if(0===e.length)throw new h("Resources array cannot be empty");const s=Object.values(w),i=e.find((e=>!s.includes(e.type)));if(i)throw new h(`Invalid resource type ${i.type}: ${JSON.stringify(i)}`);const n=e.find((e=>!e.name||"string"!=typeof e.name));if(n)throw new h(`Invalid resource name ${n.name}: ${JSON.stringify(n)}`);const a=e.find((e=>!Array.isArray(e.configEntries)));if(a){const{configEntries:e}=a;throw new h(`Invalid resource configEntries ${e}: ${JSON.stringify(a)}`)}const c=e.find((e=>e.configEntries.some((e=>"string"!=typeof e.name||"string"!=typeof e.value))));if(c)throw new h(`Invalid resource config value: ${JSON.stringify(c)}`);return o(r)((async(r,o,s)=>{try{await k.refreshMetadata();const r=await k.findControllerBroker(),o=await q({resources:e,defaultBroker:r}),s=async e=>{const s=e||r;return s.alterConfigs({resources:o.get(s),validateOnly:!!t})},i=Array.from(o.keys()),n=(await Promise.all(i.map(s))).reduce(((e,{resources:t})=>[...e,...t]),[]);return{resources:n}}catch(e){if("NOT_CONTROLLER"===e.type)throw P.warn("Could not alter configs",{error:e.message,retryCount:o,retryTime:s}),e;r(e)}}))},on:(e,t)=>{if(!v.includes(e))throw new h(`Event name should be one of ${_}`);return L.addListener(u(e),(r=>{r.type=d(r.type),Promise.resolve(t(r)).catch((t=>{P.error(`Failed to execute listener: ${t.message}`,{eventName:e,stack:t.stack})}))}))},logger:()=>P,listGroups:async()=>{await k.refreshMetadata();let e=[];for(var t in k.brokerPool.brokers){const r=await k.findBroker({nodeId:t}),o=await r.listGroups();e=e.concat(o.groups)}return{groups:e}},describeGroups:async e=>{const t=await Promise.all(e.map((async e=>({coordinator:await k.findGroupCoordinator({groupId:e}),groupId:e})))),s=Object.values(t.reduce(((e,{coordinator:t,groupId:r})=>{const o=e[t.nodeId];return e[t.nodeId]=o?{...o,groupIds:[...o.groupIds,r]}:{coordinator:t,groupIds:[r]},e}),{})),i=await Promise.all(s.map((async({coordinator:e,groupIds:t})=>{const s=o(r),{groups:i}=await s((()=>e.describeGroups({groupIds:t})));return i})));return{groups:[].concat.apply([],i)}},deleteGroups:async e=>{if(!e||!Array.isArray(e))throw new h(`Invalid groupIds array ${e}`);const t=e.some((e=>"string"!=typeof e));if(t)throw new h(`Invalid groupId name: ${JSON.stringify(t)}`);const i=o(r);let n=[],a=e.slice();return i((async(e,t,r)=>{try{if(0===a.length)return[];await k.refreshMetadata();const e={},t={};for(const r of a){const o=await k.findGroupCoordinator({groupId:r});void 0===e[o.nodeId]&&(e[o.nodeId]=[]),e[o.nodeId].push(r),t[o.nodeId]=o}const r=await Promise.all(Object.keys(t).map((async r=>await t[r].deleteGroups(e[r])))),o=s(r.map((({results:e})=>e.map((({groupId:e,errorCode:t,error:r})=>({groupId:e,errorCode:t,error:r})))))).filter((({errorCode:e})=>0!==e));if(a=o.map((({groupId:e})=>e)),o.length>0)throw new m("Error in DeleteGroups",o);return n=s(r.map((({results:e})=>e))),n}catch(o){if("NOT_CONTROLLER"===o.type||"COORDINATOR_NOT_AVAILABLE"===o.type)throw P.warn("Could not delete groups",{error:o.message,retryCount:t,retryTime:r}),o;e(o)}}))},describeAcls:async({resourceType:e,resourceName:t,resourcePatternType:s,principal:i,host:n,operation:a,permissionType:c})=>{if("string"!=typeof i&&void 0!==i)throw new h("Invalid principal, the principal have to be a valid string");if("string"!=typeof n&&void 0!==n)throw new h("Invalid host, the host have to be a valid string");if("string"!=typeof t&&void 0!==t)throw new h("Invalid resourceName, the resourceName have to be a valid string");if(!Object.values(E).includes(a))throw new h(`Invalid operation type ${a}`);if(!Object.values(S).includes(s))throw new h(`Invalid resource pattern filter type ${s}`);if(!Object.values(b).includes(c))throw new h(`Invalid permission type ${c}`);if(!Object.values(T).includes(e))throw new h(`Invalid resource type ${e}`);return o(r)((async(r,o,p)=>{try{await k.refreshMetadata();const r=await k.findControllerBroker(),{resources:o}=await r.describeAcls({resourceType:e,resourceName:t,resourcePatternType:s,principal:i,host:n,operation:a,permissionType:c});return{resources:o}}catch(e){if("NOT_CONTROLLER"===e.type)throw P.warn("Could not describe ACL",{error:e.message,retryCount:o,retryTime:p}),e;r(e)}}))},deleteAcls:async({filters:e})=>{if(!e||!Array.isArray(e))throw new h(`Invalid ACL Filter array ${e}`);if(0===e.length)throw new h("Empty ACL Filter array");if(e.some((({principal:e})=>"string"!=typeof e&&void 0!==e)))throw new h("Invalid ACL Filter array, the principals have to be a valid string");if(e.some((({host:e})=>"string"!=typeof e&&void 0!==e)))throw new h("Invalid ACL Filter array, the hosts have to be a valid string");if(e.some((({resourceName:e})=>"string"!=typeof e&&void 0!==e)))throw new h("Invalid ACL Filter array, the resourceNames have to be a valid string");let t;const s=Object.values(E);if(t=e.find((e=>!s.includes(e.operation))),t)throw new h(`Invalid operation type ${t.operation}: ${JSON.stringify(t)}`);const i=Object.values(S);if(t=e.find((e=>!i.includes(e.resourcePatternType))),t)throw new h(`Invalid resource pattern type ${t.resourcePatternType}: ${JSON.stringify(t)}`);const n=Object.values(b);if(t=e.find((e=>!n.includes(e.permissionType))),t)throw new h(`Invalid permission type ${t.permissionType}: ${JSON.stringify(t)}`);const a=Object.values(T);if(t=e.find((e=>!a.includes(e.resourceType))),t)throw new h(`Invalid resource type ${t.resourceType}: ${JSON.stringify(t)}`);return o(r)((async(t,r,o)=>{try{await k.refreshMetadata();const t=await k.findControllerBroker(),{filterResponses:r}=await t.deleteAcls({filters:e});return{filterResponses:r}}catch(e){if("NOT_CONTROLLER"===e.type)throw P.warn("Could not delete ACL",{error:e.message,retryCount:r,retryTime:o}),e;t(e)}}))},createAcls:async({acl:e})=>{if(!e||!Array.isArray(e))throw new h(`Invalid ACL array ${e}`);if(0===e.length)throw new h("Empty ACL array");if(e.some((({principal:e})=>"string"!=typeof e)))throw new h("Invalid ACL array, the principals have to be a valid string");if(e.some((({host:e})=>"string"!=typeof e)))throw new h("Invalid ACL array, the hosts have to be a valid string");if(e.some((({resourceName:e})=>"string"!=typeof e)))throw new h("Invalid ACL array, the resourceNames have to be a valid string");let t;const s=Object.values(E);if(t=e.find((e=>!s.includes(e.operation))),t)throw new h(`Invalid operation type ${t.operation}: ${JSON.stringify(t)}`);const i=Object.values(S);if(t=e.find((e=>!i.includes(e.resourcePatternType))),t)throw new h(`Invalid resource pattern type ${t.resourcePatternType}: ${JSON.stringify(t)}`);const n=Object.values(b);if(t=e.find((e=>!n.includes(e.permissionType))),t)throw new h(`Invalid permission type ${t.permissionType}: ${JSON.stringify(t)}`);const a=Object.values(T);if(t=e.find((e=>!a.includes(e.resourceType))),t)throw new h(`Invalid resource type ${t.resourceType}: ${JSON.stringify(t)}`);return o(r)((async(t,r,o)=>{try{await k.refreshMetadata();const t=await k.findControllerBroker();return await t.createAcls({acl:e}),!0}catch(e){if("NOT_CONTROLLER"===e.type)throw P.warn("Could not create ACL",{error:e.message,retryCount:r,retryTime:o}),e;t(e)}}))},deleteTopicRecords:async({topic:e,partitions:t})=>{if(!e||"string"!=typeof e)throw new h(`Invalid topic "${e}"`);if(!t||0===t.length)throw new h("Invalid partitions");const i=k.findLeaderForPartitions(e,t.map((e=>e.partition))),n=s(R(i)),a=await D(e),c=[];if(t.forEach((({partition:t,offset:r})=>{if(!n.includes(t))return void c.push({partition:t,offset:r,error:new f("Could not find the leader for the partition",{retriable:!1})});const{low:o}=a.find((e=>e.partition===t))||{high:void 0,low:void 0};parseInt(r)<parseInt(o)&&-1!==parseInt(r)&&P.warn("The requested offset is before the earliest offset maintained on the partition - no records will be deleted from this partition",{topic:e,partition:t,offset:r})})),c.length>0)throw new g({topic:e,partitions:c});const p=x(i).reduce(((r,[o,s])=>(r[o]={topic:e,partitions:t.filter((e=>s.includes(e.partition)))},r)),{});return o(r)((async t=>{try{const t=[],r=x(p).map((([e,{topic:t,partitions:r}])=>async()=>{const o=await k.findBroker({nodeId:e});await o.deleteRecords({topics:[{topic:t,partitions:r}]}),delete p[e]}));if(await Promise.all(r.map((e=>e().catch((e=>{if("KafkaJSDeleteTopicRecordsError"!==e.name)throw e;e.partitions.forEach((({partition:e,offset:r,error:o})=>{t.push({partition:e,offset:r,error:o})}))}))))),t.length>0)throw new g({topic:e,partitions:t})}catch(e){throw e.retriable&&e.partitions.some((({error:e})=>y(e)||"KafkaJSMetadataNotLoaded"===e.name))&&await k.refreshMetadata(),e}}))}}}},87881:(e,t,r)=>{const o=r(76),s=r(28202),i=r(51429)("admin"),n={CONNECT:i("connect"),DISCONNECT:i("disconnect"),REQUEST:i(s.NETWORK_REQUEST),REQUEST_TIMEOUT:i(s.NETWORK_REQUEST_TIMEOUT),REQUEST_QUEUE_SIZE:i(s.NETWORK_REQUEST_QUEUE_SIZE)},a={[n.REQUEST]:s.NETWORK_REQUEST,[n.REQUEST_TIMEOUT]:s.NETWORK_REQUEST_TIMEOUT,[n.REQUEST_QUEUE_SIZE]:s.NETWORK_REQUEST_QUEUE_SIZE},c=o(a);e.exports={events:n,wrap:e=>c[e]||e,unwrap:e=>a[e]||e}},266:(e,t,r)=>{const o=r(73278),s=r(4105),{Types:i}=r(42972),{requests:n,lookup:a}=r(63146),{KafkaJSNonRetriableError:c}=r(29879),p=r(99211),d=r(80722),u=r(42464),{ApiVersions:l}=r(99211),h=r(89026),m=Symbol("private:Broker:shouldReauthenticate"),f=Symbol("private:Broker:sendRequest"),g=Symbol("private:Broker:authenticate"),I=()=>{throw new Error("Broker not connected")};e.exports=class{constructor({connection:e,logger:t,nodeId:r=null,versions:i=null,authenticationTimeout:n=1e3,reauthenticationThreshold:a=1e4,allowAutoTopicCreation:c=!0,supportAuthenticationProtocol:p=null}){this.connection=e,this.nodeId=r,this.rootLogger=t,this.logger=t.namespace("Broker"),this.versions=i,this.authenticationTimeout=n,this.reauthenticationThreshold=a,this.allowAutoTopicCreation=c,this.supportAuthenticationProtocol=p,this.authenticatedAt=null,this.sessionLifetime=o.ZERO;const u=2*this.connection.connectionTimeout+this.authenticationTimeout;this.brokerAddress=`${this.connection.host}:${this.connection.port}`,this.lock=new s({timeout:u,description:`connect to broker ${this.brokerAddress}`}),this.lookupRequest=I,this[g]=h((async()=>{if(this.connection.sasl&&!this.isAuthenticated()){const e=new d(this.connection,this.rootLogger,this.versions,this.supportAuthenticationProtocol);await e.authenticate(),this.authenticatedAt=process.hrtime(),this.sessionLifetime=o.fromValue(e.sessionLifetime)}}))}isAuthenticated(){return null!=this.authenticatedAt&&!this[m]()}isConnected(){const{connected:e,sasl:t}=this.connection;return t?e&&this.isAuthenticated():e}async connect(){try{if(await this.lock.acquire(),this.isConnected())return;if(this.authenticatedAt=null,await this.connection.connect(),this.versions||(this.versions=await this.apiVersions()),this.lookupRequest=a(this.versions),null===this.supportAuthenticationProtocol){try{this.lookupRequest(p.SaslAuthenticate,n.SaslAuthenticate),this.supportAuthenticationProtocol=!0}catch(e){this.supportAuthenticationProtocol=!1}this.logger.debug("Verified support for SaslAuthenticate",{broker:this.brokerAddress,supportAuthenticationProtocol:this.supportAuthenticationProtocol})}await this[g]()}finally{await this.lock.release()}}async disconnect(){this.authenticatedAt=null,await this.connection.disconnect()}async apiVersions(){let e;const t=n.ApiVersions.versions.map(Number).sort().reverse();for(const r of t)try{const t=n.ApiVersions.protocol({version:r});e=await this[f]({...t(),requestTimeout:this.connection.connectionTimeout});break}catch(e){if("UNSUPPORTED_VERSION"!==e.type)throw e}if(!e)throw new c("API Versions not supported");return e.apiVersions.reduce(((e,t)=>Object.assign(e,{[t.apiKey]:{minVersion:t.minVersion,maxVersion:t.maxVersion}})),{})}async metadata(e=[]){const t=this.lookupRequest(p.Metadata,n.Metadata),r=u(e);return await this[f](t({topics:r,allowAutoTopicCreation:this.allowAutoTopicCreation}))}async produce({topicData:e,transactionalId:t,producerId:r,producerEpoch:o,acks:s=-1,timeout:a=3e4,compression:c=i.None}){const d=this.lookupRequest(p.Produce,n.Produce);return await this[f](d({acks:s,timeout:a,compression:c,topicData:e,transactionalId:t,producerId:r,producerEpoch:o}))}async fetch({replicaId:e,isolationLevel:t,maxWaitTime:r=5e3,minBytes:o=1,maxBytes:s=10485760,topics:i,rackId:a=""}){const c=this.lookupRequest(p.Fetch,n.Fetch),d=i.reduce(((e,{topic:t,partitions:r})=>(r.forEach((r=>{e.push({topic:t,partition:r})})),e)),[]),l=u(d).reduce(((e,{topic:t,partition:r})=>{const o=e[e.length-1];return null!=o&&o.topic===t?e[e.length-1].partitions.push(r):e.push({topic:t,partitions:[r]}),e}),[]);return await this[f](c({replicaId:e,isolationLevel:t,maxWaitTime:r,minBytes:o,maxBytes:s,topics:l,rackId:a}))}async heartbeat({groupId:e,groupGenerationId:t,memberId:r}){const o=this.lookupRequest(p.Heartbeat,n.Heartbeat);return await this[f](o({groupId:e,groupGenerationId:t,memberId:r}))}async findGroupCoordinator({groupId:e,coordinatorType:t}){const r=this.lookupRequest(p.GroupCoordinator,n.GroupCoordinator);return await this[f](r({groupId:e,coordinatorType:t}))}async joinGroup({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:o="",protocolType:s="consumer",groupProtocols:i}){const a=this.lookupRequest(p.JoinGroup,n.JoinGroup),c=(n=o)=>this[f](a({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:n,protocolType:s,groupProtocols:i}));try{return await c()}catch(e){if("KafkaJSMemberIdRequired"===e.name)return c(e.memberId);throw e}}async leaveGroup({groupId:e,memberId:t}){const r=this.lookupRequest(p.LeaveGroup,n.LeaveGroup);return await this[f](r({groupId:e,memberId:t}))}async syncGroup({groupId:e,generationId:t,memberId:r,groupAssignment:o}){const s=this.lookupRequest(p.SyncGroup,n.SyncGroup);return await this[f](s({groupId:e,generationId:t,memberId:r,groupAssignment:o}))}async listOffsets({replicaId:e,isolationLevel:t,topics:r}){const o=this.lookupRequest(p.ListOffsets,n.ListOffsets),s=await this[f](o({replicaId:e,isolationLevel:t,topics:r}));for(const e of s.responses)e.partitions=e.partitions.map((({offsets:e,...t})=>e?{...t,offset:e.pop()}:t));return s}async offsetCommit({groupId:e,groupGenerationId:t,memberId:r,retentionTime:o,topics:s}){const i=this.lookupRequest(p.OffsetCommit,n.OffsetCommit);return await this[f](i({groupId:e,groupGenerationId:t,memberId:r,retentionTime:o,topics:s}))}async offsetFetch({groupId:e,topics:t}){const r=this.lookupRequest(p.OffsetFetch,n.OffsetFetch);return await this[f](r({groupId:e,topics:t}))}async describeGroups({groupIds:e}){const t=this.lookupRequest(p.DescribeGroups,n.DescribeGroups);return await this[f](t({groupIds:e}))}async createTopics({topics:e,validateOnly:t=!1,timeout:r=5e3}){const o=this.lookupRequest(p.CreateTopics,n.CreateTopics);return await this[f](o({topics:e,validateOnly:t,timeout:r}))}async createPartitions({topicPartitions:e,validateOnly:t=!1,timeout:r=5e3}){const o=this.lookupRequest(p.CreatePartitions,n.CreatePartitions);return await this[f](o({topicPartitions:e,validateOnly:t,timeout:r}))}async deleteTopics({topics:e,timeout:t=5e3}){const r=this.lookupRequest(p.DeleteTopics,n.DeleteTopics);return await this[f](r({topics:e,timeout:t}))}async describeConfigs({resources:e,includeSynonyms:t=!1}){const r=this.lookupRequest(p.DescribeConfigs,n.DescribeConfigs);return await this[f](r({resources:e,includeSynonyms:t}))}async alterConfigs({resources:e,validateOnly:t=!1}){const r=this.lookupRequest(p.AlterConfigs,n.AlterConfigs);return await this[f](r({resources:e,validateOnly:t}))}async initProducerId({transactionalId:e,transactionTimeout:t}){const r=this.lookupRequest(p.InitProducerId,n.InitProducerId);return await this[f](r({transactionalId:e,transactionTimeout:t}))}async addPartitionsToTxn({transactionalId:e,producerId:t,producerEpoch:r,topics:o}){const s=this.lookupRequest(p.AddPartitionsToTxn,n.AddPartitionsToTxn);return await this[f](s({transactionalId:e,producerId:t,producerEpoch:r,topics:o}))}async addOffsetsToTxn({transactionalId:e,producerId:t,producerEpoch:r,groupId:o}){const s=this.lookupRequest(p.AddOffsetsToTxn,n.AddOffsetsToTxn);return await this[f](s({transactionalId:e,producerId:t,producerEpoch:r,groupId:o}))}async txnOffsetCommit({transactionalId:e,groupId:t,producerId:r,producerEpoch:o,topics:s}){const i=this.lookupRequest(p.TxnOffsetCommit,n.TxnOffsetCommit);return await this[f](i({transactionalId:e,groupId:t,producerId:r,producerEpoch:o,topics:s}))}async endTxn({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:o}){const s=this.lookupRequest(p.EndTxn,n.EndTxn);return await this[f](s({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:o}))}async listGroups(){const e=this.lookupRequest(p.ListGroups,n.ListGroups);return await this[f](e())}async deleteGroups(e){const t=this.lookupRequest(p.DeleteGroups,n.DeleteGroups);return await this[f](t(e))}async deleteRecords({topics:e}){const t=this.lookupRequest(p.DeleteRecords,n.DeleteRecords);return await this[f](t({topics:e}))}async createAcls({acl:e}){const t=this.lookupRequest(p.CreateAcls,n.CreateAcls);return await this[f](t({creations:e}))}async describeAcls({resourceType:e,resourceName:t,resourcePatternType:r,principal:o,host:s,operation:i,permissionType:a}){const c=this.lookupRequest(p.DescribeAcls,n.DescribeAcls);return await this[f](c({resourceType:e,resourceName:t,resourcePatternType:r,principal:o,host:s,operation:i,permissionType:a}))}async deleteAcls({filters:e}){const t=this.lookupRequest(p.DeleteAcls,n.DeleteAcls);return await this[f](t({filters:e}))}[m](){if(this.sessionLifetime.equals(o.ZERO))return!1;if(null==this.authenticatedAt)return!0;const[e,t]=process.hrtime(this.authenticatedAt);return o.fromValue(e).multiply(1e3).add(o.fromValue(t).divide(1e6)).add(this.reauthenticationThreshold).greaterThanOrEqual(this.sessionLifetime)}async[f](e){this.isAuthenticated()||e.request.apiKey===l||await this[g]();try{return await this.connection.send(e)}catch(e){throw"KafkaJSConnectionClosedError"===e.name&&await this.disconnect(),e}}}},8931:(e,t,r)=>{const o=r(71128),{KafkaJSSASLAuthenticationError:s}=r(29879);e.exports=class{constructor(e,t,r){this.connection=e,this.logger=t.namespace("SASLAWSIAMAuthenticator"),this.saslAuthenticate=r}async authenticate(){const{sasl:e}=this.connection;if(!e.authorizationIdentity)throw new s("SASL AWS-IAM: Missing authorizationIdentity");if(!e.accessKeyId)throw new s("SASL AWS-IAM: Missing accessKeyId");if(!e.secretAccessKey)throw new s("SASL AWS-IAM: Missing secretAccessKey");e.sessionToken||(e.sessionToken="");const t=o.request(e),r=o.response,{host:i,port:n}=this.connection,a=`${i}:${n}`;try{this.logger.debug("Authenticate with SASL AWS-IAM",{broker:a}),await this.saslAuthenticate({request:t,response:r}),this.logger.debug("SASL AWS-IAM authentication successful",{broker:a})}catch(e){const t=new s(`SASL AWS-IAM authentication failed: ${e.message}`);throw this.logger.error(t.message,{broker:a}),t}}}},80722:(e,t,r)=>{const{requests:o,lookup:s}=r(63146),i=r(99211),n=r(7891),a=r(55667),c=r(20527),p=r(8931),d=r(53938),{KafkaJSSASLAuthenticationError:u}=r(29879),l={PLAIN:n,"SCRAM-SHA-256":a,"SCRAM-SHA-512":c,AWS:p,OAUTHBEARER:d},h=Object.keys(l);e.exports=class{constructor(e,t,r,n){this.connection=e,this.logger=t,this.sessionLifetime="0";const a=s(r);this.saslHandshake=a(i.SaslHandshake,o.SaslHandshake),this.protocolAuthentication=n?a(i.SaslAuthenticate,o.SaslAuthenticate):null}async authenticate(){const e=this.connection.sasl.mechanism.toUpperCase();if(!h.includes(e))throw new u(`SASL ${e} mechanism is not supported by the client`);if(!(await this.connection.send(this.saslHandshake({mechanism:e}))).enabledMechanisms.includes(e))throw new u(`SASL ${e} mechanism is not supported by the server`);const t=l[e];await new t(this.connection,this.logger,(async({request:e,response:t,authExpectResponse:r})=>{if(this.protocolAuthentication){const{buffer:o}=await e.encode(),s=await this.connection.send(this.protocolAuthentication({authBytes:o}));if(this.sessionLifetime=s.sessionLifetimeMs||"0",!r)return;const{authBytes:i}=s,n=await t.decode(i);return t.parse(n)}return this.connection.authenticate({request:e,response:t,authExpectResponse:r})})).authenticate()}}},53938:(e,t,r)=>{const o=r(13860),{KafkaJSSASLAuthenticationError:s}=r(29879);e.exports=class{constructor(e,t,r){this.connection=e,this.logger=t.namespace("SASLOAuthBearerAuthenticator"),this.saslAuthenticate=r}async authenticate(){const{sasl:e}=this.connection;if(null==e.oauthBearerProvider)throw new s("SASL OAUTHBEARER: Missing OAuth bearer token provider");const{oauthBearerProvider:t}=e,r=await t();if(null==r.value)throw new s("SASL OAUTHBEARER: Invalid OAuth bearer token");const i=await o.request(e,r),n=o.response,{host:a,port:c}=this.connection,p=`${a}:${c}`;try{this.logger.debug("Authenticate with SASL OAUTHBEARER",{broker:p}),await this.saslAuthenticate({request:i,response:n}),this.logger.debug("SASL OAUTHBEARER authentication successful",{broker:p})}catch(e){const t=new s(`SASL OAUTHBEARER authentication failed: ${e.message}`);throw this.logger.error(t.message,{broker:p}),t}}}},7891:(e,t,r)=>{const o=r(17733),{KafkaJSSASLAuthenticationError:s}=r(29879);e.exports=class{constructor(e,t,r){this.connection=e,this.logger=t.namespace("SASLPlainAuthenticator"),this.saslAuthenticate=r}async authenticate(){const{sasl:e}=this.connection;if(null==e.username||null==e.password)throw new s("SASL Plain: Invalid username or password");const t=o.request(e),r=o.response,{host:i,port:n}=this.connection,a=`${i}:${n}`;try{this.logger.debug("Authenticate with SASL PLAIN",{broker:a}),await this.saslAuthenticate({request:t,response:r}),this.logger.debug("SASL PLAIN authentication successful",{broker:a})}catch(e){const t=new s(`SASL PLAIN authentication failed: ${e.message}`);throw this.logger.error(t.message,{broker:a}),t}}}},81818:(e,t,r)=>{const o=r(6113),s=r(82337),{KafkaJSSASLAuthenticationError:i,KafkaJSNonRetriableError:n}=r(29879),a=/=/g,c=/,/g,p=/\+/g,d=/\//g,u=/=+$/,l=e=>Buffer.from(e).toString("base64");class h{static sanitizeString(e){return e.replace(a,"=3D").replace(c,"=2C")}static nonce(){return o.randomBytes(16).toString("base64").replace(p,"-").replace(d,"_").replace(u,"").toString("ascii")}static hi(e,t,r,s){return new Promise(((i,n)=>{o.pbkdf2(e,t,r,s.length,s.type,((e,t)=>e?n(e):i(t)))}))}static xor(e,t){const r=Buffer.from(e),o=Buffer.from(t),s=Buffer.byteLength(r);if(s!==Buffer.byteLength(o))throw new n("Buffers must be of the same length");const i=[];for(let e=0;e<s;e++)i.push(r[e]^o[e]);return Buffer.from(i)}constructor(e,t,r,o){this.connection=e,this.logger=t,this.saslAuthenticate=r,this.digestDefinition=o;const s=o.type.toUpperCase();this.PREFIX=`SASL SCRAM ${s} authentication`,this.currentNonce=h.nonce()}async authenticate(){const{PREFIX:e}=this,{host:t,port:r,sasl:o}=this.connection,s=`${t}:${r}`;if(null==o.username||null==o.password)throw new i(`${this.PREFIX}: Invalid username or password`);try{this.logger.debug("Exchanging first client message",{broker:s});const t=await this.sendClientFirstMessage();this.logger.debug("Sending final message",{broker:s});const r=await this.sendClientFinalMessage(t);if(r.e)throw new Error(r.e);const o=await this.serverKey(t),i=this.serverSignature(o,t);if(r.v!==i)throw new Error("Invalid server signature in server final message");this.logger.debug(`${e} successful`,{broker:s})}catch(t){const r=new i(`${e} failed: ${t.message}`);throw this.logger.error(r.message,{broker:s}),r}}async sendClientFirstMessage(){const e=`n,,${this.firstMessageBare()}`,t=s.firstMessage.request({clientFirstMessage:e}),r=s.firstMessage.response;return this.saslAuthenticate({authExpectResponse:!0,request:t,response:r})}async sendClientFinalMessage(e){const{PREFIX:t}=this,r=parseInt(e.i,10),{minIterations:o}=this.digestDefinition;if(!e.r.startsWith(this.currentNonce))throw new i(`${t} failed: Invalid server nonce, it does not start with the client nonce`);if(r<o)throw new i(`${t} failed: Requested iterations ${r} is less than the minimum ${o}`);const n=`${this.finalMessageWithoutProof(e)},p=${await this.clientProof(e)}`,a=s.finalMessage.request({finalMessage:n}),c=s.finalMessage.response;return this.saslAuthenticate({authExpectResponse:!0,request:a,response:c})}async clientProof(e){const t=await this.clientKey(e),r=this.H(t),o=this.clientSignature(r,e);return l(h.xor(t,o))}async clientKey(e){const t=await this.saltPassword(e);return this.HMAC(t,"Client Key")}async serverKey(e){const t=await this.saltPassword(e);return this.HMAC(t,"Server Key")}clientSignature(e,t){return this.HMAC(e,this.authMessage(t))}serverSignature(e,t){return l(this.HMAC(e,this.authMessage(t)))}authMessage(e){return[this.firstMessageBare(),e.original,this.finalMessageWithoutProof(e)].join(",")}async saltPassword(e){const t=Buffer.from(e.s,"base64"),r=parseInt(e.i,10);return h.hi(this.encodedPassword(),t,r,this.digestDefinition)}firstMessageBare(){return`n=${this.encodedUsername()},r=${this.currentNonce}`}finalMessageWithoutProof(e){const t=e.r;return`c=${l("n,,")},r=${t}`}encodedUsername(){const{username:e}=this.connection.sasl;return h.sanitizeString(e).toString("utf-8")}encodedPassword(){const{password:e}=this.connection.sasl;return e.toString("utf-8")}H(e){return o.createHash(this.digestDefinition.type).update(e).digest()}HMAC(e,t){return o.createHmac(this.digestDefinition.type,e).update(t).digest()}}e.exports={DIGESTS:{SHA256:{length:32,type:"sha256",minIterations:4096},SHA512:{length:64,type:"sha512",minIterations:4096}},SCRAM:h}},55667:(e,t,r)=>{const{SCRAM:o,DIGESTS:s}=r(81818);e.exports=class extends o{constructor(e,t,r){super(e,t.namespace("SCRAM256Authenticator"),r,s.SHA256)}}},20527:(e,t,r)=>{const{SCRAM:o,DIGESTS:s}=r(81818);e.exports=class extends o{constructor(e,t,r){super(e,t.namespace("SCRAM512Authenticator"),r,s.SHA512)}}},71625:(e,t,r)=>{const o=r(266),s=r(99701),i=r(42464),n=r(8351),{KafkaJSBrokerNotFound:a,KafkaJSProtocolError:c}=r(29879),{keys:p,assign:d,values:u}=Object;e.exports=class{constructor({connectionBuilder:e,logger:t,retry:r,allowAutoTopicCreation:i,authenticationTimeout:n,reauthenticationThreshold:a,metadataMaxAge:c}){this.rootLogger=t,this.connectionBuilder=e,this.metadataMaxAge=c||0,this.logger=t.namespace("BrokerPool"),this.retrier=s(d({},r)),this.createBroker=e=>new o({allowAutoTopicCreation:i,authenticationTimeout:n,reauthenticationThreshold:a,...e}),this.brokers={},this.seedBroker=void 0,this.metadata=null,this.metadataExpireAt=null,this.versions=null,this.supportAuthenticationProtocol=null}hasConnectedBrokers(){return!!u(this.brokers).find((e=>e.isConnected()))||!!this.seedBroker&&this.seedBroker.isConnected()}async createSeedBroker(){this.seedBroker&&await this.seedBroker.disconnect(),this.seedBroker=this.createBroker({connection:await this.connectionBuilder.build(),logger:this.rootLogger})}async connect(){if(!this.hasConnectedBrokers())return this.seedBroker||await this.createSeedBroker(),this.retrier((async(e,t,r)=>{try{await this.seedBroker.connect(),this.versions=this.seedBroker.versions}catch(o){if("KafkaJSConnectionError"===o.name||"ILLEGAL_SASL_STATE"===o.type?(await this.createSeedBroker(),this.logger.error(`Failed to connect to seed broker, trying another broker from the list: ${o.message}`,{retryCount:t,retryTime:r})):this.logger.error(o.message,{retryCount:t,retryTime:r}),o.retriable)throw o;e(o)}}))}async disconnect(){this.seedBroker&&await this.seedBroker.disconnect(),await Promise.all(u(this.brokers).map((e=>e.disconnect()))),this.brokers={},this.metadata=null,this.versions=null,this.supportAuthenticationProtocol=null}removeBroker({host:e,port:t}){const r=u(this.brokers).find((r=>r.connection.host===e&&r.connection.port===t));r&&(delete this.brokers[r.nodeId],this.metadataExpireAt=null,this.seedBroker.nodeId===r.nodeId&&(this.seedBroker=i(u(this.brokers))[0]))}async refreshMetadata(e){const t=await this.findConnectedBroker(),{host:r,port:o}=this.seedBroker.connection;return this.retrier((async(s,i,a)=>{try{this.metadata=await t.metadata(e),this.metadataExpireAt=Date.now()+this.metadataMaxAge;const s=[];this.brokers=await this.metadata.brokers.reduce((async(e,{nodeId:t,host:i,port:n,rack:a})=>{const c=await e;if(c[t]){if(!((e,{host:t,port:r,rack:o})=>e.connection.host!==t||e.connection.port!==r||e.connection.rack!==o)(c[t],{host:i,port:n,rack:a}))return c;s.push(c[t])}return i===r&&n===o?(this.seedBroker.nodeId=t,this.seedBroker.connection.rack=a,d(c,{[t]:this.seedBroker})):d(c,{[t]:this.createBroker({logger:this.rootLogger,versions:this.versions,supportAuthenticationProtocol:this.supportAuthenticationProtocol,connection:await this.connectionBuilder.build({host:i,port:n,rack:a}),nodeId:t})})}),this.brokers);const i=this.metadata.brokers.map((({nodeId:e})=>`${e}`)).sort(),a=p(this.brokers).sort(),c=n(a,i).map((e=>this.brokers[e].disconnect().then((()=>{delete this.brokers[e]})))),u=s.map((e=>e.disconnect()));await Promise.all([...c,...u])}catch(e){if("LEADER_NOT_AVAILABLE"===e.type)throw e;s(e)}}))}async refreshMetadataIfNecessary(e){if(null==this.metadata||null==this.metadataExpireAt||Date.now()>this.metadataExpireAt||!e.every((e=>this.metadata.topicMetadata.some((t=>t.topic===e)))))return this.refreshMetadata(e)}async findBroker({nodeId:e}){const t=this.brokers[e];if(!t)throw new a(`Broker ${e} not found in the cached metadata`);return await this.connectBroker(t),t}async withBroker(e){const t=i(p(this.brokers));if(0===t.length)throw new a("No brokers in the broker pool");for(const r of t){const t=await this.findBroker({nodeId:r});try{return await e({nodeId:r,broker:t})}catch(e){}}return null}async findConnectedBroker(){const e=i(p(this.brokers)),t=e.find((e=>this.brokers[e].isConnected()));if(t)return await this.findBroker({nodeId:t});for(const t of e)try{return await this.findBroker({nodeId:t})}catch(e){}return await this.connect(),this.seedBroker}async connectBroker(e){if(!e.isConnected())return this.retrier((async(t,r,o)=>{try{await e.connect()}catch(s){if("KafkaJSConnectionError"!==s.name&&"ILLEGAL_SASL_STATE"!==s.type||await e.disconnect(),"KafkaJSConnectionError"===s.name)return t(s);if("ILLEGAL_SASL_STATE"===s.type)throw e.connection=await this.connectionBuilder.build({host:e.connection.host,port:e.connection.port,rack:e.connection.rack}),this.logger.error("Failed to connect to broker, reconnecting",{retryCount:r,retryTime:o}),new c(s,{retriable:!0});if(s.retriable)throw s;this.logger.error(s,{retryCount:r,retryTime:o,stack:s.stack}),t(s)}}))}}},15482:(e,t,r)=>{const o=r(62109),{KafkaJSConnectionError:s,KafkaJSNonRetriableError:i}=r(29879);e.exports=({socketFactory:e,brokers:t,ssl:r,sasl:n,clientId:a,requestTimeout:c,enforceRequestTimeout:p,connectionTimeout:d,maxInFlightRequests:u,logger:l,instrumentationEmitter:h=null})=>{let m=0;return{build:async({host:f,port:g,rack:I}={})=>{if(!f){const e=await(async()=>{let e;if("function"==typeof t)try{e=await t()}catch(e){const t=new s(`Failed to connect: "config.brokers" threw: ${e.message}`);throw t.stack=`${t.name}\n  Caused by: ${e.stack}`,t}else e=t;return(e=>{if(!e)throw new i("Failed to connect: brokers should not be null");if(Array.isArray(e)){if(!e.length)throw new i("Failed to connect: brokers array is empty");e.forEach(((e,t)=>{if(!(e=>e&&"string"==typeof e&&e.length>0)(e))throw new i(`Failed to connect: broker at index ${t} is invalid "${typeof e}"`)}))}})(e),e})(),r=e[m++%e.length];f=r.split(":")[0],g=Number(r.split(":")[1])}return new o({host:f,port:g,rack:I,sasl:n,ssl:r,clientId:a,socketFactory:e,connectionTimeout:d,requestTimeout:c,enforceRequestTimeout:p,maxInFlightRequests:u,instrumentationEmitter:h,logger:l})}}}},8048:(e,t,r)=>{const o=r(71625),s=r(4105),i=r(99701),n=r(15482),a=r(74358),{EARLIEST_OFFSET:c,LATEST_OFFSET:p}=r(53904),{KafkaJSError:d,KafkaJSBrokerNotFound:u,KafkaJSMetadataNotLoaded:l,KafkaJSTopicMetadataNotLoaded:h,KafkaJSGroupCoordinatorNotFound:m}=r(29879),f=r(7022),{keys:g}=Object,I=(e,{topic:t,partitions:r})=>({...e,[t]:[...e[t]||[],...r]});e.exports=class{constructor({logger:e,socketFactory:t,brokers:r,ssl:a,sasl:c,clientId:p,connectionTimeout:d,authenticationTimeout:u,reauthenticationThreshold:l,requestTimeout:h=3e4,enforceRequestTimeout:m,metadataMaxAge:f,retry:g,allowAutoTopicCreation:I,maxInFlightRequests:y,isolationLevel:w,instrumentationEmitter:T=null,offsets:E=new Map}){this.rootLogger=e,this.logger=e.namespace("Cluster"),this.retrier=i(g),this.connectionBuilder=n({logger:e,instrumentationEmitter:T,socketFactory:t,brokers:r,ssl:a,sasl:c,clientId:p,connectionTimeout:d,requestTimeout:h,enforceRequestTimeout:m,maxInFlightRequests:y}),this.targetTopics=new Set,this.mutatingTargetTopics=new s({description:"updating target topics",timeout:h}),this.isolationLevel=w,this.brokerPool=new o({connectionBuilder:this.connectionBuilder,logger:this.rootLogger,retry:g,allowAutoTopicCreation:I,authenticationTimeout:u,reauthenticationThreshold:l,metadataMaxAge:f}),this.committedOffsetsByGroup=E}isConnected(){return this.brokerPool.hasConnectedBrokers()}async connect(){await this.brokerPool.connect()}async disconnect(){await this.brokerPool.disconnect()}removeBroker({host:e,port:t}){this.brokerPool.removeBroker({host:e,port:t})}async refreshMetadata(){await this.brokerPool.refreshMetadata(Array.from(this.targetTopics))}async refreshMetadataIfNecessary(){await this.brokerPool.refreshMetadataIfNecessary(Array.from(this.targetTopics))}async metadata({topics:e=[]}={}){return this.retrier((async(t,r,o)=>{try{return await this.brokerPool.refreshMetadataIfNecessary(e),this.brokerPool.withBroker((async({broker:t})=>t.metadata(e)))}catch(e){if("LEADER_NOT_AVAILABLE"===e.type)throw e;t(e)}}))}async addTargetTopic(e){return this.addMultipleTargetTopics([e])}async addMultipleTargetTopics(e){await this.mutatingTargetTopics.acquire();try{const t=this.targetTopics.size,r=new Set(this.targetTopics);for(const t of e)this.targetTopics.add(t);if(t!==this.targetTopics.size||!this.brokerPool.metadata)try{await this.refreshMetadata()}catch(e){throw"INVALID_TOPIC_EXCEPTION"!==e.type&&"UNKNOWN_TOPIC_OR_PARTITION"!==e.type||(this.targetTopics=r),e}}finally{await this.mutatingTargetTopics.release()}}async findBroker({nodeId:e}){try{return await this.brokerPool.findBroker({nodeId:e})}catch(e){throw"KafkaJSBrokerNotFound"!==e.name&&"KafkaJSLockTimeout"!==e.name&&"KafkaJSConnectionError"!==e.name||await this.refreshMetadata(),e}}async findControllerBroker(){const{metadata:e}=this.brokerPool;if(!e||null==e.controllerId)throw new l("Topic metadata not loaded");const t=await this.findBroker({nodeId:e.controllerId});if(!t)throw new u(`Controller broker with id ${e.controllerId} not found in the cached metadata`);return t}findTopicPartitionMetadata(e){const{metadata:t}=this.brokerPool;if(!t||!t.topicMetadata)throw new h("Topic metadata not loaded",{topic:e});const r=t.topicMetadata.find((t=>t.topic===e));return r?r.partitionMetadata:[]}findLeaderForPartitions(e,t){const r=this.findTopicPartitionMetadata(e);return t.reduce(((t,o)=>{const s=parseInt(o,10),i=r.find((e=>e.partitionId===s));if(!i)return t;if(null===i.leader||void 0===i.leader)throw new d("Invalid partition metadata",{topic:e,partitionId:s,metadata:i});const{leader:n}=i,a=t[n]||[];return{...t,[n]:[...a,s]}}),{})}async findGroupCoordinator({groupId:e,coordinatorType:t=f.GROUP}){return this.retrier((async(r,o,s)=>{try{const{coordinator:r}=await this.findGroupCoordinatorMetadata({groupId:e,coordinatorType:t});return await this.findBroker({nodeId:r.nodeId})}catch(t){if("KafkaJSBrokerNotFound"===t.name||"GROUP_COORDINATOR_NOT_AVAILABLE"===t.type)throw this.logger.debug(`${t.message}, refreshing metadata and trying again...`,{groupId:e,retryCount:o,retryTime:s}),await this.refreshMetadata(),t;if("ECONNREFUSED"===t.code)throw t;r(t)}}))}async findGroupCoordinatorMetadata({groupId:e,coordinatorType:t}){const r=await this.brokerPool.withBroker((async({nodeId:r,broker:o})=>await this.retrier((async(s,i,n)=>{try{const r=await o.findGroupCoordinator({groupId:e,coordinatorType:t});return this.logger.debug("Found group coordinator",{broker:r.host,nodeId:r.coordinator.nodeId}),r}catch(e){if(this.logger.debug("Tried to find group coordinator",{nodeId:r,error:e}),"GROUP_COORDINATOR_NOT_AVAILABLE"===e.type)throw this.logger.debug("Group coordinator not available, retrying...",{nodeId:r,retryCount:i,retryTime:n}),e;s(e)}}))));if(r)return r;throw new m("Failed to find group coordinator")}defaultOffset({fromBeginning:e}){return e?c:p}async fetchTopicsOffset(e){const t={},r={},o=e=>t=>{const{timestamp:o}=r[e];return{...t,timestamp:o}};for(const o of e){const{topic:e,partitions:s,fromBeginning:i,fromTimestamp:n}=o,a=this.findLeaderForPartitions(e,s.map((e=>e.partition))),c=null!=n?n:this.defaultOffset({fromBeginning:i});r[e]={timestamp:c},g(a).forEach((r=>{t[r]=t[r]||{},t[r][e]=s.filter((e=>a[r].includes(e.partition)))}))}const s=g(t).map((async e=>{const r=await this.findBroker({nodeId:e}),s=t[e],{responses:i}=await r.listOffsets({isolationLevel:this.isolationLevel,topics:g(s).map((e=>({topic:e,partitions:s[e].map(o(e))})))});return i})),i=await Promise.all(s),n=a(i).reduce(I,{});return g(n).map((e=>({topic:e,partitions:n[e].map((({partition:e,offset:t})=>({partition:e,offset:t})))})))}committedOffsets({groupId:e}){return this.committedOffsetsByGroup.has(e)||this.committedOffsetsByGroup.set(e,{}),this.committedOffsetsByGroup.get(e)}markOffsetAsCommitted({groupId:e,topic:t,partition:r,offset:o}){const s=this.committedOffsets({groupId:e});s[t]=s[t]||{},s[t][r]=o}}},53904:e=>{const t=Math.pow(2,32);e.exports={EARLIEST_OFFSET:-2,LATEST_OFFSET:-1,INT_32_MAX_VALUE:t}},737:(e,t,r)=>{const o=r(28783),s=r(56341),i={encode:({version:e,topics:t,userData:r=Buffer.alloc(0)})=>(new o).writeInt16(e).writeArray(t).writeBytes(r).buffer,decode(e){const t=new s(e);return{version:t.readInt16(),topics:t.readArray((e=>e.readString())),userData:t.readBytes()}}},n={encode:({version:e,assignment:t,userData:r=Buffer.alloc(0)})=>(new o).writeInt16(e).writeArray(Object.keys(t).map((e=>(new o).writeString(e).writeArray(t[e])))).writeBytes(r).buffer,decode(e){const t=new s(e),r=e=>e.readInt32();return t.canReadInt16()?{version:t.readInt16(),assignment:t.readArray((e=>({topic:e.readString(),partitions:e.readArray(r)}))).reduce(((e,{topic:t,partitions:r})=>Object.assign(e,{[t]:r})),{}),userData:t.readBytes()}:null}};e.exports={MemberMetadata:i,MemberAssignment:n}},16996:(e,t,r)=>{const o=r(62786);e.exports={roundRobin:o}},62786:(e,t,r)=>{const{MemberMetadata:o,MemberAssignment:s}=r(737),i=r(74358);e.exports=({cluster:e})=>({name:"RoundRobinAssigner",version:1,async assign({members:t,topics:r}){const o=t.length,n=t.map((({memberId:e})=>e)).sort(),a={},c=r.map((t=>e.findTopicPartitionMetadata(t).map((e=>({topic:t,partitionId:e.partitionId})))));return i(c).forEach(((e,t)=>{const r=n[t%o];a[r]||(a[r]=Object.create(null)),a[r][e.topic]||(a[r][e.topic]=[]),a[r][e.topic].push(e.partitionId)})),Object.keys(a).map((e=>({memberId:e,memberAssignment:s.encode({version:this.version,assignment:a[e]})})))},protocol({topics:e}){return{name:this.name,metadata:o.encode({version:this.version,topics:e})}}})},24722:e=>{e.exports=()=>{let e,t;return{lock:new Promise((r=>{e=r,t=r})),unlock:e,unlockWithError:t}}},13529:(e,t,r)=>{const o=r(73278),s=r(72948);e.exports=class{constructor(e,t,r){this.fetchedOffset=t;const i=o.fromValue(this.fetchedOffset),{abortedTransactions:n,messages:a}=r;this.topic=e,this.partition=r.partition,this.highWatermark=r.highWatermark,this.rawMessages=a,this.messagesWithinOffset=this.rawMessages.filter((e=>o.fromValue(e.offset).gte(i))),this.messages=s({messages:this.messagesWithinOffset,abortedTransactions:n}).filter((e=>!e.isControlRecord))}isEmpty(){return 0===this.messages.length}isEmptyIncludingFiltered(){return 0===this.messagesWithinOffset.length}isEmptyDueToFiltering(){return this.isEmpty()&&this.rawMessages.length>0}isEmptyControlRecord(){return this.isEmpty()&&this.messagesWithinOffset.some((({isControlRecord:e})=>e))}isEmptyDueToLogCompactedMessages(){return this.rawMessages.length>0&&this.isEmptyIncludingFiltered()}firstOffset(){return this.isEmptyIncludingFiltered()?null:this.messagesWithinOffset[0].offset}lastOffset(){return this.isEmptyDueToLogCompactedMessages()?this.fetchedOffset:this.isEmptyIncludingFiltered()?o.fromValue(this.highWatermark).add(-1).toString():this.messagesWithinOffset[this.messagesWithinOffset.length-1].offset}offsetLag(){const e=o.fromValue(this.highWatermark).add(-1),t=o.fromValue(this.lastOffset());return e.add(t.multiply(-1)).toString()}offsetLagLow(){if(this.isEmptyIncludingFiltered())return"0";const e=o.fromValue(this.highWatermark).add(-1),t=o.fromValue(this.firstOffset());return e.add(t.multiply(-1)).toString()}}},90019:(e,t,r)=>{const o=r(74358),s=r(34742),i=r(15002),n=r(6779),a=r(8351),c=r(99701),p=r(89026),d=r(61770),u=r(13529),l=r(42499),h=r(11381),{events:{GROUP_JOIN:m,HEARTBEAT:f,CONNECT:g,RECEIVED_UNSUBSCRIBED_TOPICS:I}}=r(39311),{MemberAssignment:y}=r(737),{KafkaJSError:w,KafkaJSNonRetriableError:T,KafkaJSStaleTopicMetadataAssignment:E}=r(29879),{keys:b}=Object,S=["LEADER_NOT_AVAILABLE","NOT_LEADER_FOR_PARTITION","FENCED_LEADER_EPOCH","UNKNOWN_LEADER_EPOCH","UNKNOWN_TOPIC_OR_PARTITION"],A=Symbol("private:ConsumerGroup:join"),O=Symbol("private:ConsumerGroup:sync"),C=(Symbol("private:ConsumerGroup:heartbeat"),Symbol("private:ConsumerGroup:sharedHeartbeat"));e.exports=class{constructor({retry:e,cluster:t,groupId:r,topics:o,topicConfigurations:s,logger:i,instrumentationEmitter:n,assigners:a,sessionTimeout:d,rebalanceTimeout:u,maxBytesPerPartition:m,minBytes:g,maxBytes:I,maxWaitTimeInMs:y,autoCommit:w,autoCommitInterval:T,autoCommitThreshold:E,isolationLevel:b,rackId:S,metadataMaxAge:A}){this.cluster=t,this.groupId=r,this.topics=o,this.topicsSubscribed=o,this.topicConfigurations=s,this.logger=i.namespace("ConsumerGroup"),this.instrumentationEmitter=n,this.retrier=c(Object.assign({},e)),this.assigners=a,this.sessionTimeout=d,this.rebalanceTimeout=u,this.maxBytesPerPartition=m,this.minBytes=g,this.maxBytes=I,this.maxWaitTime=y,this.autoCommit=w,this.autoCommitInterval=T,this.autoCommitThreshold=E,this.isolationLevel=b,this.rackId=S,this.metadataMaxAge=A,this.seekOffset=new l,this.coordinator=null,this.generationId=null,this.leaderId=null,this.memberId=null,this.members=null,this.groupProtocol=null,this.partitionsPerSubscribedTopic=null,this.preferredReadReplicasPerTopicPartition={},this.offsetManager=null,this.subscriptionState=new h,this.lastRequest=Date.now(),this[C]=p((async({interval:e})=>{const{groupId:t,generationId:r,memberId:o}=this,s=Date.now();if(o&&s>=this.lastRequest+e){const e={groupId:t,memberId:o,groupGenerationId:r};await this.coordinator.heartbeat(e),this.instrumentationEmitter.emit(f,e),this.lastRequest=Date.now()}}))}isLeader(){return this.leaderId&&this.memberId===this.leaderId}async connect(){await this.cluster.connect(),this.instrumentationEmitter.emit(g),await this.cluster.refreshMetadataIfNecessary()}async[A](){const{groupId:e,sessionTimeout:t,rebalanceTimeout:r}=this;this.coordinator=await this.cluster.findGroupCoordinator({groupId:e});const o=await this.coordinator.joinGroup({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:this.memberId||"",groupProtocols:this.assigners.map((e=>e.protocol({topics:this.topicsSubscribed})))});this.generationId=o.generationId,this.leaderId=o.leaderId,this.memberId=o.memberId,this.members=o.members,this.groupProtocol=o.groupProtocol}async leave(){const{groupId:e,memberId:t}=this;t&&(await this.coordinator.leaveGroup({groupId:e,memberId:t}),this.memberId=null)}async[O](){let e=[];const{groupId:t,generationId:r,memberId:o,members:s,groupProtocol:i,topics:c,topicsSubscribed:p,coordinator:u}=this;if(this.isLeader()){this.logger.debug("Chosen as group leader",{groupId:t,generationId:r,memberId:o,topics:c});const n=this.assigners.find((({name:e})=>e===i));if(!n)throw new T(`Unsupported partition assigner "${i}", the assigner wasn't found in the assigners list`);await this.cluster.refreshMetadata(),e=await n.assign({members:s,topics:p}),this.logger.debug("Group assignment",{groupId:t,generationId:r,groupProtocol:i,assignment:e,topics:p})}this.partitionsPerSubscribedTopic=this.generatePartitionsPerSubscribedTopic();const{memberAssignment:l}=await this.coordinator.syncGroup({groupId:t,generationId:r,memberId:o,groupAssignment:e}),h=y.decode(l),m=null!=h?h.assignment:{};this.logger.debug("Received assignment",{groupId:t,generationId:r,memberId:o,memberAssignment:m});const f=b(m),g=a(f,p);if(g.length>0){const e={groupId:t,generationId:r,memberId:o,assignedTopics:f,topicsSubscribed:p,topicsNotSubscribed:g};this.instrumentationEmitter.emit(I,e),this.logger.warn("Consumer group received unsubscribed topics",{...e,helpUrl:n("docs/faq","why-am-i-receiving-messages-for-topics-i-m-not-subscribed-to")})}const w=a(f,g).map((e=>({topic:e,partitions:m[e]})));for(const e of w){const{topic:s,partitions:i}=e,n=this.partitionsPerSubscribedTopic.get(s);if(!i.every((e=>n.includes(e)))){this.logger.warn("Consumer is not aware of all assigned partitions, refreshing metadata",{groupId:t,generationId:r,memberId:o,topic:s,knownPartitions:n,assignedPartitions:i}),await this.cluster.refreshMetadata(),this.partitionsPerSubscribedTopic=this.generatePartitionsPerSubscribedTopic();break}}this.topics=w.map((({topic:e})=>e)),this.subscriptionState.assign(w),this.offsetManager=new d({cluster:this.cluster,topicConfigurations:this.topicConfigurations,instrumentationEmitter:this.instrumentationEmitter,memberAssignment:w.reduce(((e,{topic:t,partitions:r})=>({...e,[t]:r})),{}),autoCommit:this.autoCommit,autoCommitInterval:this.autoCommitInterval,autoCommitThreshold:this.autoCommitThreshold,coordinator:u,groupId:t,generationId:r,memberId:o})}joinAndSync(){const e=Date.now();return this.retrier((async t=>{try{await this[A](),await this[O]();const t=this.assigned().reduce(((e,{topic:t,partitions:r})=>({...e,[t]:r})),{}),r={groupId:this.groupId,memberId:this.memberId,leaderId:this.leaderId,isLeader:this.isLeader(),memberAssignment:t,groupProtocol:this.groupProtocol,duration:Date.now()-e};this.instrumentationEmitter.emit(m,r),this.logger.info("Consumer has joined the group",r)}catch(e){if((e=>"REBALANCE_IN_PROGRESS"===e.type||"NOT_COORDINATOR_FOR_GROUP"===e.type)(e))throw new w(e);t(e)}}))}resetOffset({topic:e,partition:t}){this.offsetManager.resetOffset({topic:e,partition:t})}resolveOffset({topic:e,partition:t,offset:r}){this.offsetManager.resolveOffset({topic:e,partition:t,offset:r})}seek({topic:e,partition:t,offset:r}){this.seekOffset.set(e,t,r)}pause(e){this.logger.info(`Pausing fetching from ${e.length} topics`,{topicPartitions:e}),this.subscriptionState.pause(e)}resume(e){this.logger.info(`Resuming fetching from ${e.length} topics`,{topicPartitions:e}),this.subscriptionState.resume(e)}assigned(){return this.subscriptionState.assigned()}paused(){return this.subscriptionState.paused()}async commitOffsetsIfNecessary(){await this.offsetManager.commitOffsetsIfNecessary()}async commitOffsets(e){await this.offsetManager.commitOffsets(e)}uncommittedOffsets(){return this.offsetManager.uncommittedOffsets()}async heartbeat({interval:e}){return this[C]({interval:e})}async fetch(){try{const{topics:e,maxBytesPerPartition:t,maxWaitTime:r,minBytes:n,maxBytes:a}=this,c={};for(await this.cluster.refreshMetadataIfNecessary(),this.checkForStaleAssignment();this.seekOffset.size>0;){const e=this.seekOffset.pop();this.logger.debug("Seek offset",{groupId:this.groupId,memberId:this.memberId,seek:e}),await this.offsetManager.seek(e)}const p=this.subscriptionState.paused(),d=this.subscriptionState.active(),l=o(d.map((({partitions:e})=>e))),h=d.filter((({partitions:e})=>e.length>0)).map((({topic:e})=>e));if(0===l.length)return this.logger.debug(`No active topic partitions, sleeping for ${this.maxWaitTime}ms`,{topics:e,activeTopicPartitions:d,pausedTopicPartitions:p}),await s(this.maxWaitTime),i([]);await this.offsetManager.resolveOffsets(),this.logger.debug(`Fetching from ${l.length} partitions for ${h.length} out of ${e.length} topics`,{topics:e,activeTopicPartitions:d,pausedTopicPartitions:p});for(const e of d){const r=this.findReadReplicaForPartitions(e.topic,e.partitions),o=b(r),s=this.offsetManager.committedOffsets();for(const i of o){const o=r[i].filter((t=>null!=s[e.topic][t])).map((r=>({partition:r,fetchOffset:this.offsetManager.nextOffset(e.topic,r).toString(),maxBytes:t})));c[i]=c[i]||[],c[i].push({topic:e.topic,partitions:o})}}const m=b(c).map((async e=>{const t=await this.cluster.findBroker({nodeId:e}),{responses:s}=await t.fetch({maxWaitTime:r,minBytes:n,maxBytes:a,isolationLevel:this.isolationLevel,topics:c[e],rackId:this.rackId}),i=s.map((({topicName:t,partitions:r})=>{const o=c[e].find((({topic:e})=>e===t));let s=this.preferredReadReplicasPerTopicPartition[t];return s||(this.preferredReadReplicasPerTopicPartition[t]=s={}),r.filter((e=>!this.seekOffset.has(t,e.partition)&&!this.subscriptionState.isPaused(t,e.partition))).map((e=>{const{partition:r,preferredReadReplica:i}=e;if(null!=i&&-1!==i){const{nodeId:e}=s[r]||{};e!==i&&this.logger.info(`Preferred read replica is now ${i}`,{groupId:this.groupId,memberId:this.memberId,topic:t,partition:r}),s[r]={nodeId:i,expireAt:Date.now()+this.metadataMaxAge}}const n=o.partitions.find((({partition:t})=>t===e.partition)),a=n.fetchOffset;return new u(t,a,e)}))}));return o(i)}));return 0===m.length?(await s(this.maxWaitTime),i([])):i(m,(e=>this.recoverFromFetch(e)))}catch(e){await this.recoverFromFetch(e)}}async recoverFromFetch(e){if(S.includes(e.type)||"KafkaJSTopicMetadataNotLoaded"===e.name)throw this.logger.debug("Stale cluster metadata, refreshing...",{groupId:this.groupId,memberId:this.memberId,error:e.message}),await this.cluster.refreshMetadata(),await this.joinAndSync(),new w(e.message);throw"KafkaJSStaleTopicMetadataAssignment"===e.name&&(this.logger.warn(`${e.message}, resync group`,{groupId:this.groupId,memberId:this.memberId,topic:e.topic,unknownPartitions:e.unknownPartitions}),await this.joinAndSync()),"KafkaJSOffsetOutOfRange"===e.name&&await this.recoverFromOffsetOutOfRange(e),"KafkaJSConnectionClosedError"===e.name&&this.cluster.removeBroker({host:e.host,port:e.port}),"KafkaJSBrokerNotFound"!==e.name&&"KafkaJSConnectionClosedError"!==e.name||(this.logger.debug(`${e.message}, refreshing metadata and retrying...`),await this.cluster.refreshMetadata()),e}async recoverFromOffsetOutOfRange(e){const t=this.preferredReadReplicasPerTopicPartition[e.topic];t&&"number"==typeof t[e.partition]?(this.logger.info("Offset out of range while fetching from follower, retrying with leader",{topic:e.topic,partition:e.partition,groupId:this.groupId,memberId:this.memberId}),delete t[e.partition]):(this.logger.error("Offset out of range, resetting to default offset",{topic:e.topic,partition:e.partition,groupId:this.groupId,memberId:this.memberId}),await this.offsetManager.setDefaultOffset({topic:e.topic,partition:e.partition}))}generatePartitionsPerSubscribedTopic(){const e=new Map;for(const t of this.topicsSubscribed){const r=this.cluster.findTopicPartitionMetadata(t).map((e=>e.partitionId)).sort();e.set(t,r)}return e}checkForStaleAssignment(){if(!this.partitionsPerSubscribedTopic)return;const e=this.generatePartitionsPerSubscribedTopic();for(const[t,r]of e){const e=a(r,this.partitionsPerSubscribedTopic.get(t));if(e.length>0)throw new E("Topic has been updated",{topic:t,unknownPartitions:e})}}hasSeekOffset({topic:e,partition:t}){return this.seekOffset.has(e,t)}findReadReplicaForPartitions(e,t){const r=this.cluster.findTopicPartitionMetadata(e),o=this.preferredReadReplicasPerTopicPartition[e];return t.reduce(((t,s)=>{const i=parseInt(s,10),n=r.find((e=>e.partitionId===i));if(!n)return t;if(null==n.leader)throw new w("Invalid partition metadata",{topic:e,partitionId:i,metadata:n});let a=n.leader;if(o){const{nodeId:t,expireAt:r}=o[i]||{};if(Date.now()>=r)this.logger.debug("Preferred read replica information has expired, using leader",{topic:e,partitionId:i,groupId:this.groupId,memberId:this.memberId,preferredReadReplica:t,leader:n.leader}),delete o[i];else if(null!=t){const r=n.offlineReplicas;Array.isArray(r)&&r.includes(a)?this.logger.debug("Preferred read replica is offline, using leader",{topic:e,partitionId:i,groupId:this.groupId,memberId:this.memberId,preferredReadReplica:t,leader:n.leader}):a=t}}const c=t[a]||[];return{...t,[a]:[...c,i]}}),{})}}},72948:(e,t,r)=>{const o=r(73278),s=Buffer.from([0,0,0,0]);e.exports=({messages:e,abortedTransactions:t})=>{const r=new Map;if(!t||!t.length)return e;const i=[...t];return e.filter((e=>{if(i.length&&o.fromValue(e.offset).gte(i[0].firstOffset)){const{producerId:e}=i.shift();r.set(e,!0)}const{producerId:t,inTransaction:n}=e.batchContext;if((({key:e})=>!!e&&Buffer.from(e).equals(s))(e))r.delete(t);else if(r.has(t)&&n)return!1;return!0}))}},40763:(e,t,r)=>{const o=r(73278),s=r(99701),{initialRetryTime:i}=r(27727),n=r(90019),a=r(82436),{events:c,wrap:p,unwrap:d}=r(39311),u=r(52190),{KafkaJSNonRetriableError:l}=r(29879),{roundRobin:h}=r(16996),{EARLIEST_OFFSET:m,LATEST_OFFSET:f}=r(53904),g=r(52845),{keys:I,values:y}=Object,{CONNECT:w,DISCONNECT:T,STOP:E,CRASH:b}=c,S=y(c),A=I(c).map((e=>`consumer.events.${e}`)).join(", "),O=[o.fromValue(m).toString(),o.fromValue(f).toString()];e.exports=({cluster:e,groupId:t,retry:r,logger:m,partitionAssigners:f=[h],sessionTimeout:y=3e4,rebalanceTimeout:C=6e4,heartbeatInterval:N=3e3,maxBytesPerPartition:R=1048576,minBytes:k=1,maxBytes:x=10485760,maxWaitTimeInMs:v=5e3,isolationLevel:_=g.READ_COMMITTED,rackId:B="",instrumentationEmitter:P,metadataMaxAge:L})=>{if(!t)throw new l("Consumer groupId must be a non-empty string.");const D=m.namespace("Consumer"),M=P||new u,q=f.map((r=>r({groupId:t,logger:D,cluster:e}))),K={};let V=null,G=null;if(N>=y)throw new l(`Consumer heartbeatInterval (${N}) must be lower than sessionTimeout (${y}). It is recommended to set heartbeatInterval to approximately a third of the sessionTimeout.`);const U=({autoCommit:o,autoCommitInterval:s,autoCommitThreshold:i})=>new n({logger:m,topics:I(K),topicConfigurations:K,retry:r,cluster:e,groupId:t,assigners:q,sessionTimeout:y,rebalanceTimeout:C,maxBytesPerPartition:R,minBytes:k,maxBytes:x,maxWaitTimeInMs:v,instrumentationEmitter:M,autoCommit:o,autoCommitInterval:s,autoCommitThreshold:i,isolationLevel:_,rackId:B,metadataMaxAge:L}),F=async()=>{try{await $(),D.debug("consumer has stopped, disconnecting",{groupId:t}),await e.disconnect(),M.emit(T)}catch(e){throw D.error(`Caught error when disconnecting the consumer: ${e.message}`,{stack:e.stack,groupId:t}),e}},$=async()=>{try{V&&(await V.stop(),V=null,G=null,M.emit(E)),D.info("Stopped",{groupId:t})}catch(e){throw D.error(`Caught error when stopping the consumer: ${e.message}`,{stack:e.stack,groupId:t}),e}};return{connect:async()=>{await e.connect(),M.emit(w)},disconnect:F,subscribe:async({topic:r,fromBeginning:o=!1})=>{if(G)throw new l("Cannot subscribe to topic while consumer is running");if(!r)throw new l(`Invalid topic ${r}`);const s=r instanceof RegExp;if("string"!=typeof r&&!s)throw new l(`Invalid topic ${r} (${typeof r}), the topic name has to be a String or a RegExp`);const i=[];if(s){const o=r,s=(await e.metadata()).topicMetadata.map((({topic:e})=>e)).filter((e=>o.test(e)));D.debug("Subscription based on RegExp",{groupId:t,topicRegExp:o.toString(),matchedTopics:s}),i.push(...s)}else i.push(r);for(const e of i)K[e]={fromBeginning:o};await e.addMultipleTargetTopics(i)},stop:$,run:async({autoCommit:o=!0,autoCommitInterval:s=null,autoCommitThreshold:n=null,eachBatchAutoResolve:c=!0,partitionsConsumedConcurrently:p=1,eachBatch:d=null,eachMessage:u=null}={})=>{if(G)return void D.warn("consumer#run was called, but the consumer is already running",{groupId:t});G=U({autoCommit:o,autoCommitInterval:s,autoCommitThreshold:n});const l=async e=>{D.info("Starting",{groupId:t}),V=(({eachBatchAutoResolve:e,eachBatch:t,eachMessage:o,onCrash:s,autoCommit:i,partitionsConsumedConcurrently:n})=>new a({autoCommit:i,logger:m,consumerGroup:G,instrumentationEmitter:M,eachBatchAutoResolve:e,eachBatch:t,eachMessage:o,heartbeatInterval:N,retry:r,onCrash:s,partitionsConsumedConcurrently:n}))({autoCommit:o,eachBatchAutoResolve:c,eachBatch:d,eachMessage:u,onCrash:e,partitionsConsumedConcurrently:p}),await V.start()},h=async o=>{D.error(`Crash: ${o.name}: ${o.message}`,{groupId:t,retryCount:o.retryCount,stack:o.stack}),"KafkaJSConnectionClosedError"===o.name&&e.removeBroker({host:o.host,port:o.port}),await F();const a=("KafkaJSNumberOfRetriesExceeded"===o.name||!0===o.retriable)&&(!r||!r.restartOnFailure||await r.restartOnFailure(o).catch((e=>(D.error('Caught error when invoking user-provided "restartOnFailure" callback. Defaulting to restarting.',{error:e.message||e,originalError:o.message||o,groupId:t}),!0))));if(M.emit(b,{error:o,groupId:t,restart:a}),a){const e=o.retryTime||r&&r.initialRetryTime||i;D.error(`Restarting the consumer in ${e}ms`,{retryCount:o.retryCount,retryTime:e,groupId:t}),setTimeout((()=>(e=>{G=U({autoCommitInterval:s,autoCommitThreshold:n}),l(e)})(h)),e)}};await l(h)},commitOffsets:async(e=[])=>{const t=e.reduce(((e,{topic:t,partition:r,offset:s,metadata:i=null})=>{if(!t)throw new l(`Invalid topic ${t}`);if(isNaN(r))throw new l(`Invalid partition, expected a number received ${r}`);let n;try{n=o.fromValue(s)}catch(e){throw new l(`Invalid offset, expected a long received ${s}`)}if(n.lessThan(0))throw new l("Offset must not be a negative number");if(null!==i&&"string"!=typeof i)throw new l(`Invalid offset metadata, expected string or null, received ${i}`);const a=e[t]||[];return a.push({partition:r,offset:n,metadata:i}),{...e,[t]:a}}),{});if(!G)throw new l("Consumer group was not initialized, consumer#run must be called first");const r=Object.keys(t);return V.commitOffsets({topics:r.map((e=>({topic:e,partitions:t[e]})))})},seek:({topic:e,partition:t,offset:r})=>{if(!e)throw new l(`Invalid topic ${e}`);if(isNaN(t))throw new l(`Invalid partition, expected a number received ${t}`);let s;try{s=o.fromValue(r)}catch(e){throw new l(`Invalid offset, expected a long received ${r}`)}if(s.lessThan(0)&&!O.includes(s.toString()))throw new l("Offset must not be a negative number");if(!G)throw new l("Consumer group was not initialized, consumer#run must be called first");G.seek({topic:e,partition:t,offset:s.toString()})},describeGroup:async()=>{const o=await e.findGroupCoordinator({groupId:t});return s(r)((async()=>{const{groups:e}=await o.describeGroups({groupIds:[t]});return e.find((e=>e.groupId===t))}))},pause:(e=[])=>{for(const t of e){if(!t||!t.topic)throw new l(`Invalid topic ${t&&t.topic||t}`);if(void 0!==t.partitions&&(!Array.isArray(t.partitions)||t.partitions.some(isNaN)))throw new l(`Array of valid partitions required to pause specific partitions instead of ${t.partitions}`)}if(!G)throw new l("Consumer group was not initialized, consumer#run must be called first");G.pause(e)},paused:()=>G?G.paused():[],resume:(e=[])=>{for(const t of e){if(!t||!t.topic)throw new l(`Invalid topic ${t&&t.topic||t}`);if(void 0!==t.partitions&&(!Array.isArray(t.partitions)||t.partitions.some(isNaN)))throw new l(`Array of valid partitions required to resume specific partitions instead of ${t.partitions}`)}if(!G)throw new l("Consumer group was not initialized, consumer#run must be called first");G.resume(e)},on:(e,t)=>{if(!S.includes(e))throw new l(`Event name should be one of ${A}`);return M.addListener(d(e),(r=>{r.type=p(r.type),Promise.resolve(t(r)).catch((t=>{D.error(`Failed to execute listener: ${t.message}`,{eventName:e,stack:t.stack})}))}))},events:c,logger:()=>D}}},39311:(e,t,r)=>{const o=r(76),s=r(51429),i=r(28202),n=s("consumer"),a={HEARTBEAT:n("heartbeat"),COMMIT_OFFSETS:n("commit_offsets"),GROUP_JOIN:n("group_join"),FETCH:n("fetch"),FETCH_START:n("fetch_start"),START_BATCH_PROCESS:n("start_batch_process"),END_BATCH_PROCESS:n("end_batch_process"),CONNECT:n("connect"),DISCONNECT:n("disconnect"),STOP:n("stop"),CRASH:n("crash"),REBALANCING:n("rebalancing"),RECEIVED_UNSUBSCRIBED_TOPICS:n("received_unsubscribed_topics"),REQUEST:n(i.NETWORK_REQUEST),REQUEST_TIMEOUT:n(i.NETWORK_REQUEST_TIMEOUT),REQUEST_QUEUE_SIZE:n(i.NETWORK_REQUEST_QUEUE_SIZE)},c={[a.REQUEST]:i.NETWORK_REQUEST,[a.REQUEST_TIMEOUT]:i.NETWORK_REQUEST_TIMEOUT,[a.REQUEST_QUEUE_SIZE]:i.NETWORK_REQUEST_QUEUE_SIZE},p=o(c);e.exports={events:a,wrap:e=>p[e]||e,unwrap:e=>c[e]||e}},61770:(e,t,r)=>{const o=r(73278),s=r(74358),i=r(96390),n=r(54137),{events:{COMMIT_OFFSETS:a}}=r(39311),{keys:c,assign:p}=Object,d=Symbol("private:OffsetManager:committedOffsets");e.exports=class{constructor({cluster:e,coordinator:t,memberAssignment:r,autoCommit:o,autoCommitInterval:s,autoCommitThreshold:i,topicConfigurations:n,instrumentationEmitter:a,groupId:p,generationId:d,memberId:u}){this.cluster=e,this.coordinator=t,this.memberAssignment=r,this.topicConfigurations=n,this.instrumentationEmitter=a,this.groupId=p,this.generationId=d,this.memberId=u,this.autoCommit=o,this.autoCommitInterval=s,this.autoCommitThreshold=i,this.lastCommit=Date.now(),this.topics=c(r),this.clearAllOffsets()}nextOffset(e,t){this.resolvedOffsets[e][t]||(this.resolvedOffsets[e][t]=this.committedOffsets()[e][t]);let r=this.resolvedOffsets[e][t];return i(r)&&(r="0"),o.fromValue(r)}async getCoordinator(){return this.coordinator.isConnected()||(this.coordinator=await this.cluster.findBroker(this.coordinator)),this.coordinator}resetOffset({topic:e,partition:t}){this.resolvedOffsets[e][t]=this.committedOffsets()[e][t]}resolveOffset({topic:e,partition:t,offset:r}){this.resolvedOffsets[e][t]=o.fromValue(r).add(1).toString()}countResolvedOffsets(){const e=this.committedOffsets(),t=this.topics.map((t=>{return r=this.resolvedOffsets[t],s=e[t],c(r).map((e=>((e,t)=>{const r=o.fromValue(e);return i(t)?r:r.subtract(o.fromValue(t))})(r[e],s[e])));var r,s}));return s(t).reduce(((e,t)=>e.add(t)),o.fromValue(0))}async setDefaultOffset({topic:e,partition:t}){const{groupId:r,generationId:o,memberId:s}=this,i=this.cluster.defaultOffset(this.topicConfigurations[e]),n=await this.getCoordinator();await n.offsetCommit({groupId:r,memberId:s,groupGenerationId:o,topics:[{topic:e,partitions:[{partition:t,offset:i}]}]}),this.clearOffsets({topic:e,partition:t})}async seek({topic:e,partition:t,offset:r}){if(!this.memberAssignment[e]||!this.memberAssignment[e].includes(t))return;if(!this.autoCommit)return void this.resolveOffset({topic:e,partition:t,offset:o.fromValue(r).subtract(1).toString()});const{groupId:s,generationId:i,memberId:n}=this,a=await this.getCoordinator();await a.offsetCommit({groupId:s,memberId:n,groupGenerationId:i,topics:[{topic:e,partitions:[{partition:t,offset:r}]}]}),this.clearOffsets({topic:e,partition:t})}async commitOffsetsIfNecessary(){const e=Date.now(),t=null!=this.autoCommitInterval&&e>=this.lastCommit+this.autoCommitInterval,r=null!=this.autoCommitThreshold&&this.countResolvedOffsets().gte(o.fromValue(this.autoCommitThreshold));if(t||r)return this.commitOffsets()}uncommittedOffsets(){const e=e=>c(this.resolvedOffsets[e]),t=e=>t=>({partition:t,offset:this.resolvedOffsets[e][t]}),r=e=>({partition:t,offset:r})=>r!==this.committedOffsets()[e][t]&&o.fromValue(r).greaterThanOrEqual(0);return{topics:this.topics.map((o=>({topic:o,partitions:e(o).map(t(o)).filter(r(o))}))).filter((({partitions:e})=>e.length>0))}}async commitOffsets(e={}){const{groupId:t,generationId:r,memberId:o}=this,{topics:s=this.uncommittedOffsets().topics}=e;if(0===s.length)return void(this.lastCommit=Date.now());const i={groupId:t,memberId:o,groupGenerationId:r,topics:s};try{const e=await this.getCoordinator();await e.offsetCommit(i),this.instrumentationEmitter.emit(a,i),s.forEach((({topic:e,partitions:t})=>{const r=t.reduce(((e,{partition:t,offset:r})=>p(e,{[t]:r})),{});this[d][e]=p({},this.committedOffsets()[e],r)})),this.lastCommit=Date.now()}catch(e){throw"NOT_COORDINATOR_FOR_GROUP"===e.type&&await this.cluster.refreshMetadata(),e}}async resolveOffsets(){const{groupId:e}=this,t=e=>t=>i(this.committedOffsets()[e][t]),r=this.topics.map((e=>({topic:e,partitions:this.memberAssignment[e].filter(t(e)).map((e=>({partition:e})))}))).filter((e=>e.partitions.length>0));if(0===r.length)return;const o=await this.getCoordinator(),{responses:s}=await o.offsetFetch({groupId:e,topics:r}),a=s.map((({topic:e,partitions:t})=>p({topic:e,partitions:t.filter((({offset:e})=>i(e))).map((({partition:e})=>p({partition:e})))},this.topicConfigurations[e]))),c=(e,{partition:t,offset:r})=>p(e,{[t]:r});let d=s;if(a.some((e=>e.partitions.length>0))){const e=await this.cluster.fetchTopicsOffset(a);d=n(s,e)}d.forEach((({topic:e,partitions:t})=>{this.committedOffsets()[e]=t.reduce(c,{...this.committedOffsets()[e]})}))}clearOffsets({topic:e,partition:t}){delete this.committedOffsets()[e][t],delete this.resolvedOffsets[e][t]}clearAllOffsets(){const e=this.committedOffsets();for(const t in e)delete e[t];for(const t of this.topics)e[t]={};this.resolvedOffsets=this.topics.reduce(((e,t)=>p(e,{[t]:{}})),{})}committedOffsets(){return this[d]||(this[d]=this.groupId?this.cluster.committedOffsets({groupId:this.groupId}):{}),this[d]}}},54137:(e,t,r)=>{const o=r(96390),{keys:s,assign:i}=Object,n=(e,{partition:t,offset:r})=>i(e,{[t]:r}),a=(e,{topic:t,partitions:r})=>i(e,{[t]:r.reduce(n,{})});e.exports=(e,t)=>{const r=e.reduce(a,{}),i=t.reduce(a,{});return s(r).map((e=>{const t=r[e];return{topic:e,partitions:s(t).map((r=>{const s=t[r],n=o(s)?i[e][r]:s;return{partition:Number(r),offset:n}}))}}))}},96390:(e,t,r)=>{const o=r(73278);e.exports=e=>!e&&0!==e||o.fromValue(e).isNegative()},82436:(e,t,r)=>{const{EventEmitter:o}=r(82361),s=r(73278),i=r(99701),n=r(24230),{KafkaJSError:a}=r(29879),c=r(24722),{events:{FETCH:p,FETCH_START:d,START_BATCH_PROCESS:u,END_BATCH_PROCESS:l,REBALANCING:h}}=r(39311),m=e=>"REBALANCE_IN_PROGRESS"===e.type||"NOT_COORDINATOR_FOR_GROUP"===e.type,f=e=>e instanceof a,g="consuming-stop";e.exports=class extends o{constructor({logger:e,consumerGroup:t,instrumentationEmitter:r,eachBatchAutoResolve:o=!0,partitionsConsumedConcurrently:s,eachBatch:n,eachMessage:a,heartbeatInterval:c,onCrash:p,retry:d,autoCommit:u=!0}){super(),this.logger=e.namespace("Runner"),this.consumerGroup=t,this.instrumentationEmitter=r,this.eachBatchAutoResolve=o,this.eachBatch=n,this.eachMessage=a,this.heartbeatInterval=c,this.retrier=i(Object.assign({},d)),this.onCrash=p,this.autoCommit=u,this.partitionsConsumedConcurrently=s,this.running=!1,this.consuming=!1}get consuming(){return this._consuming}set consuming(e){this._consuming!==e&&(this._consuming=e,this.emit(e?"consuming-start":g))}async join(){await this.consumerGroup.joinAndSync(),this.running=!0}async scheduleJoin(){if(this.running)return this.join().catch(this.onCrash);this.logger.debug("consumer not running, exiting",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId})}async start(){if(!this.running)try{await this.consumerGroup.connect(),await this.join(),this.running=!0,this.scheduleFetch()}catch(e){this.onCrash(e)}}async stop(){if(this.running){this.logger.debug("stop consumer group",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),this.running=!1;try{await this.waitForConsumer(),await this.consumerGroup.leave()}catch(e){}}}waitForConsumer(){return new Promise((e=>{if(!this.consuming)return e();this.logger.debug("waiting for consumer to finish...",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),this.once(g,(()=>e()))}))}async processEachMessage(e){const{topic:t,partition:r}=e;for(const o of e.messages){if(!this.running||this.consumerGroup.hasSeekOffset({topic:t,partition:r}))break;try{await this.eachMessage({topic:t,partition:r,message:o,heartbeat:async()=>{await this.consumerGroup.heartbeat({interval:this.heartbeatInterval})}})}catch(e){throw f(e)||this.logger.error("Error when calling eachMessage",{topic:t,partition:r,offset:o.offset,stack:e.stack,error:e}),await this.autoCommitOffsets(),e}this.consumerGroup.resolveOffset({topic:t,partition:r,offset:o.offset}),await this.consumerGroup.heartbeat({interval:this.heartbeatInterval}),await this.autoCommitOffsetsIfNecessary()}}async processEachBatch(e){const{topic:t,partition:r}=e,o=e.messages[e.messages.length-1];try{await this.eachBatch({batch:e,resolveOffset:i=>{const n=o&&(a=i,c=o.offset,s.fromValue(a).equals(s.fromValue(c)))?e.lastOffset():i;var a,c;this.consumerGroup.resolveOffset({topic:t,partition:r,offset:n})},heartbeat:async()=>{await this.consumerGroup.heartbeat({interval:this.heartbeatInterval})},commitOffsetsIfNecessary:async e=>e?this.consumerGroup.commitOffsets(e):this.consumerGroup.commitOffsetsIfNecessary(),uncommittedOffsets:()=>this.consumerGroup.uncommittedOffsets(),isRunning:()=>this.running,isStale:()=>this.consumerGroup.hasSeekOffset({topic:t,partition:r})})}catch(o){throw f(o)||this.logger.error("Error when calling eachBatch",{topic:t,partition:r,offset:e.firstOffset(),stack:o.stack,error:o}),await this.autoCommitOffsets(),o}this.eachBatchAutoResolve&&this.consumerGroup.resolveOffset({topic:t,partition:r,offset:e.lastOffset()})}async fetch(){const e=Date.now();this.instrumentationEmitter.emit(d,{});const t=await this.consumerGroup.fetch();this.instrumentationEmitter.emit(p,{numberOfBatches:0,duration:Date.now()-e});const r=async e=>{const t=Date.now(),r={topic:e.topic,partition:e.partition,highWatermark:e.highWatermark,offsetLag:e.offsetLag(),offsetLagLow:e.offsetLagLow(),batchSize:e.messages.length,firstOffset:e.firstOffset(),lastOffset:e.lastOffset()};if(e.isEmptyDueToFiltering())return this.instrumentationEmitter.emit(u,r),this.consumerGroup.resolveOffset({topic:e.topic,partition:e.partition,offset:e.lastOffset()}),await this.autoCommitOffsetsIfNecessary(),void this.instrumentationEmitter.emit(l,{...r,duration:Date.now()-t});e.isEmpty()||(this.instrumentationEmitter.emit(u,r),this.eachMessage?await this.processEachMessage(e):this.eachBatch&&await this.processEachBatch(e),this.instrumentationEmitter.emit(l,{...r,duration:Date.now()-t}),await this.consumerGroup.heartbeat({interval:this.heartbeatInterval}))},{lock:o,unlock:s,unlockWithError:i}=c(),a=n({limit:this.partitionsConsumedConcurrently});let h=!1,m=0,f=0;const g=[];for(;;){const e=t.next();if(e.done)break;this.running?g.push((async()=>{const t=await e.value;f+=t.length,t.map((e=>a((async()=>{try{if(!this.running)return;await r(e)}catch(e){i(e)}finally{m++,h&&m===f&&s()}})).catch(i)))})):e.value.catch((e=>{this.logger.debug("Ignoring error in fetch request while stopping runner",{error:e.message||e,stack:e.stack})}))}await Promise.all(g.map((e=>e()))),h=!0,f===m&&s();const I=await o;if(I)throw I;await this.autoCommitOffsets(),await this.consumerGroup.heartbeat({interval:this.heartbeatInterval})}async scheduleFetch(){if(this.running)return this.retrier((async(e,t,r)=>{try{this.consuming=!0,await this.fetch(),this.consuming=!1,this.running&&setImmediate((()=>this.scheduleFetch()))}catch(o){if(!this.running)return void this.logger.debug("consumer not running, exiting",{error:o.message,groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId});if(m(o))return this.logger.warn("The group is rebalancing, re-joining",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:o.message,retryCount:t,retryTime:r}),this.instrumentationEmitter.emit(h,{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),await this.join(),void setImmediate((()=>this.scheduleFetch()));if("UNKNOWN_MEMBER_ID"===o.type)return this.logger.error("The coordinator is not aware of this member, re-joining the group",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:o.message,retryCount:t,retryTime:r}),this.consumerGroup.memberId=null,await this.join(),void setImmediate((()=>this.scheduleFetch()));if("KafkaJSOffsetOutOfRange"===o.name)return void setImmediate((()=>this.scheduleFetch()));if("KafkaJSNotImplemented"===o.name)return e(o);throw this.logger.debug("Error while fetching data, trying again...",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:o.message,stack:o.stack,retryCount:t,retryTime:r}),o}finally{this.consuming=!1}})).catch(this.onCrash);this.logger.debug("consumer not running, exiting",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId})}autoCommitOffsets(){if(this.autoCommit)return this.consumerGroup.commitOffsets()}autoCommitOffsetsIfNecessary(){if(this.autoCommit)return this.consumerGroup.commitOffsetsIfNecessary()}commitOffsets(e){if(this.running)return this.retrier((async(t,r,o)=>{try{await this.consumerGroup.commitOffsets(e)}catch(s){if(!this.running)return void this.logger.debug("consumer not running, exiting",{error:s.message,groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,offsets:e});if(m(s)&&(this.logger.warn("The group is rebalancing, re-joining",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:s.message,retryCount:r,retryTime:o}),this.instrumentationEmitter.emit(h,{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId}),setImmediate((()=>this.scheduleJoin())),t(new a(s))),"UNKNOWN_MEMBER_ID"===s.type&&(this.logger.error("The coordinator is not aware of this member, re-joining the group",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:s.message,retryCount:r,retryTime:o}),this.consumerGroup.memberId=null,setImmediate((()=>this.scheduleJoin())),t(new a(s))),"KafkaJSNotImplemented"===s.name)return t(s);throw this.logger.debug("Error while committing offsets, trying again...",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,error:s.message,stack:s.stack,retryCount:r,retryTime:o,offsets:e}),s}}));this.logger.debug("consumer not running, exiting",{groupId:this.consumerGroup.groupId,memberId:this.consumerGroup.memberId,offsets:e})}}},42499:e=>{e.exports=class extends Map{set(e,t,r){super.set([e,t],r)}has(e,t){return Array.from(this.keys()).some((([r,o])=>r===e&&o===t))}pop(){if(0===this.size)return;const[e,t]=this.entries().next().value;this.delete(e);const[r,o]=e;return{topic:r,partition:o,offset:t}}}},11381:e=>{const t=e=>({topic:e,paused:new Set,pauseAll:!1,resumed:new Set});e.exports=class{constructor(){this.assignedPartitionsByTopic={},this.subscriptionStatesByTopic={}}assign(e=[]){this.assignedPartitionsByTopic=e.reduce(((e,{topic:t,partitions:r=[]})=>({...e,[t]:{topic:t,partitions:r}})),{})}pause(e=[]){e.forEach((({topic:e,partitions:r})=>{const o=this.subscriptionStatesByTopic[e]||t(e);void 0===r?(o.paused.clear(),o.resumed.clear(),o.pauseAll=!0):Array.isArray(r)&&(r.forEach((e=>{o.paused.add(e),o.resumed.delete(e)})),o.pauseAll=!1),this.subscriptionStatesByTopic[e]=o}))}resume(e=[]){e.forEach((({topic:e,partitions:r})=>{const o=this.subscriptionStatesByTopic[e]||t(e);void 0===r?(o.paused.clear(),o.resumed.clear(),o.pauseAll=!1):Array.isArray(r)&&r.forEach((e=>{o.paused.delete(e),o.pauseAll&&o.resumed.add(e)})),this.subscriptionStatesByTopic[e]=o}))}assigned(){return Object.values(this.assignedPartitionsByTopic).map((({topic:e,partitions:t})=>({topic:e,partitions:t.sort()})))}active(){return Object.values(this.assignedPartitionsByTopic).map((({topic:e,partitions:t})=>({topic:e,partitions:t.filter((t=>!this.isPaused(e,t))).sort()})))}paused(){return Object.values(this.assignedPartitionsByTopic).map((({topic:e,partitions:t})=>({topic:e,partitions:t.filter((t=>this.isPaused(e,t))).sort()}))).filter((({partitions:e})=>0!==e.length))}isPaused(e,t){const r=this.subscriptionStatesByTopic[e];if(!r)return!1;const o=r.resumed.has(t),s=r.paused.has(t);return r.pauseAll&&!o||s}}},79152:e=>{e.exports=()=>({KAFKAJS_DEBUG_PROTOCOL_BUFFERS:process.env.KAFKAJS_DEBUG_PROTOCOL_BUFFERS,KAFKAJS_DEBUG_EXTENDED_PROTOCOL_BUFFERS:process.env.KAFKAJS_DEBUG_EXTENDED_PROTOCOL_BUFFERS})},29879:(e,t,r)=>{const o=r(65557),{bugs:s}=o;class i extends Error{constructor(e,{retriable:t=!0}={}){super(e),Error.captureStackTrace(this,this.constructor),this.message=e.message||e,this.name="KafkaJSError",this.retriable=t,this.helpUrl=e.helpUrl}}class n extends i{constructor(e){super(e,{retriable:!1}),this.name="KafkaJSNonRetriableError",this.originalError=e}}class a extends i{constructor(e,{retriable:t=e.retriable}={}){super(e,{retriable:t}),this.type=e.type,this.code=e.code,this.name="KafkaJSProtocolError"}}class c extends i{constructor(e,{broker:t,code:r}={}){super(e),this.broker=t,this.code=r,this.name="KafkaJSConnectionError"}}class p extends i{constructor(){super(...arguments),this.name="KafkaJSMetadataNotLoaded"}}class d extends n{constructor(){super(...arguments),this.name="KafkaJSTimeout"}}const u=s?s.url:null;class l extends Error{constructor(e,t){super(e),this.errors=t,this.name="KafkaJSAggregateError"}}e.exports={KafkaJSError:i,KafkaJSNonRetriableError:n,KafkaJSPartialMessageError:class extends n{constructor(){super(...arguments),this.name="KafkaJSPartialMessageError"}},KafkaJSBrokerNotFound:class extends i{constructor(){super(...arguments),this.name="KafkaJSBrokerNotFound"}},KafkaJSProtocolError:a,KafkaJSConnectionError:c,KafkaJSConnectionClosedError:class extends c{constructor(e,{host:t,port:r}={}){super(e,{broker:`${t}:${r}`}),this.host=t,this.port=r,this.name="KafkaJSConnectionClosedError"}},KafkaJSRequestTimeoutError:class extends i{constructor(e,{broker:t,correlationId:r,createdAt:o,sentAt:s,pendingDuration:i}={}){super(e),this.broker=t,this.correlationId=r,this.createdAt=o,this.sentAt=s,this.pendingDuration=i,this.name="KafkaJSRequestTimeoutError"}},KafkaJSSASLAuthenticationError:class extends n{constructor(){super(...arguments),this.name="KafkaJSSASLAuthenticationError"}},KafkaJSNumberOfRetriesExceeded:class extends n{constructor(e,{retryCount:t,retryTime:r}){super(e),this.stack=`${this.name}\n  Caused by: ${e.stack}`,this.originalError=e,this.retryCount=t,this.retryTime=r,this.name="KafkaJSNumberOfRetriesExceeded"}},KafkaJSOffsetOutOfRange:class extends a{constructor(e,{topic:t,partition:r}){super(e),this.topic=t,this.partition=r,this.name="KafkaJSOffsetOutOfRange"}},KafkaJSMemberIdRequired:class extends a{constructor(e,{memberId:t}){super(e),this.memberId=t,this.name="KafkaJSMemberIdRequired"}},KafkaJSGroupCoordinatorNotFound:class extends n{constructor(){super(...arguments),this.name="KafkaJSGroupCoordinatorNotFound"}},KafkaJSNotImplemented:class extends n{constructor(){super(...arguments),this.name="KafkaJSNotImplemented"}},KafkaJSMetadataNotLoaded:p,KafkaJSTopicMetadataNotLoaded:class extends p{constructor(e,{topic:t}={}){super(e),this.topic=t,this.name="KafkaJSTopicMetadataNotLoaded"}},KafkaJSStaleTopicMetadataAssignment:class extends i{constructor(e,{topic:t,unknownPartitions:r}={}){super(e),this.topic=t,this.unknownPartitions=r,this.name="KafkaJSStaleTopicMetadataAssignment"}},KafkaJSDeleteGroupsError:class extends i{constructor(e,t=[]){super(e),this.groups=t,this.name="KafkaJSDeleteGroupsError"}},KafkaJSTimeout:d,KafkaJSLockTimeout:class extends d{constructor(){super(...arguments),this.name="KafkaJSLockTimeout"}},KafkaJSServerDoesNotSupportApiKey:class extends n{constructor(e,{apiKey:t,apiName:r}={}){super(e),this.apiKey=t,this.apiName=r,this.name="KafkaJSServerDoesNotSupportApiKey"}},KafkaJSUnsupportedMagicByteInMessageSet:class extends n{constructor(){super(...arguments),this.name="KafkaJSUnsupportedMagicByteInMessageSet"}},KafkaJSDeleteTopicRecordsError:class extends i{constructor({partitions:e}){super("Error while deleting records",{retriable:e.filter((({error:e})=>null!=e)).every((({error:e})=>!0===e.retriable))}),this.name="KafkaJSDeleteTopicRecordsError",this.partitions=e}},KafkaJSInvariantViolation:class extends n{constructor(e){const t=e.message||e;if(super(`Invariant violated: ${t}. This is likely a bug and should be reported.`),this.name="KafkaJSInvariantViolation",null!==u){const e=encodeURIComponent(`Invariant violation: ${t}`);this.helpUrl=`${u}/new?assignees=&labels=bug&template=bug_report.md&title=${e}`}}},KafkaJSInvalidVarIntError:class extends n{constructor(){super(...arguments),this.name="KafkaJSNonRetriableError"}},KafkaJSInvalidLongError:class extends n{constructor(){super(...arguments),this.name="KafkaJSNonRetriableError"}},KafkaJSCreateTopicError:class extends a{constructor(e,t){super(e),this.topic=t,this.name="KafkaJSCreateTopicError"}},KafkaJSAggregateError:l}},873:(e,t,r)=>{const{createLogger:o,LEVELS:{INFO:s}}=r(10354),i=r(52190),n=r(91230),a=r(8048),c=r(73798),p=r(40763),d=r(55929),u=r(52845),l=r(89992),h=Symbol("private:Kafka:createCluster"),m=Symbol("private:Kafka:clusterRetry"),f=Symbol("private:Kafka:logger"),g=Symbol("private:Kafka:offsets");e.exports=class{constructor({brokers:e,ssl:t,sasl:r,clientId:i,connectionTimeout:c,authenticationTimeout:p,reauthenticationThreshold:d,requestTimeout:u,enforceRequestTimeout:I=!1,retry:y,socketFactory:w=l(),logLevel:T=s,logCreator:E=n}){this[g]=new Map,this[f]=o({level:T,logCreator:E}),this[m]=y,this[h]=({metadataMaxAge:o,allowAutoTopicCreation:s=!0,maxInFlightRequests:n=null,instrumentationEmitter:l=null,isolationLevel:h})=>new a({logger:this[f],retry:this[m],offsets:this[g],socketFactory:w,brokers:e,ssl:t,sasl:r,clientId:i,connectionTimeout:c,authenticationTimeout:p,reauthenticationThreshold:d,requestTimeout:u,enforceRequestTimeout:I,metadataMaxAge:o,instrumentationEmitter:l,allowAutoTopicCreation:s,maxInFlightRequests:n,isolationLevel:h})}producer({createPartitioner:e,retry:t,metadataMaxAge:r=3e5,allowAutoTopicCreation:o,idempotent:s,transactionalId:n,transactionTimeout:a,maxInFlightRequests:p}={}){const d=new i,u=this[h]({metadataMaxAge:r,allowAutoTopicCreation:o,maxInFlightRequests:p,instrumentationEmitter:d});return c({retry:{...this[m],...t},logger:this[f],cluster:u,createPartitioner:e,idempotent:s,transactionalId:n,transactionTimeout:a,instrumentationEmitter:d})}consumer({groupId:e,partitionAssigners:t,metadataMaxAge:r=3e5,sessionTimeout:o,rebalanceTimeout:s,heartbeatInterval:n,maxBytesPerPartition:a,minBytes:c,maxBytes:d,maxWaitTimeInMs:l,retry:g={retries:5},allowAutoTopicCreation:I,maxInFlightRequests:y,readUncommitted:w=!1,rackId:T=""}={}){const E=w?u.READ_UNCOMMITTED:u.READ_COMMITTED,b=new i,S=this[h]({metadataMaxAge:r,allowAutoTopicCreation:I,maxInFlightRequests:y,isolationLevel:E,instrumentationEmitter:b});return p({retry:{...this[m],...g},logger:this[f],cluster:S,groupId:e,partitionAssigners:t,sessionTimeout:o,rebalanceTimeout:s,heartbeatInterval:n,maxBytesPerPartition:a,minBytes:c,maxBytes:d,maxWaitTimeInMs:l,isolationLevel:E,instrumentationEmitter:b,rackId:T,metadataMaxAge:r})}admin({retry:e}={}){const t=new i,r=this[h]({allowAutoTopicCreation:!1,instrumentationEmitter:t});return d({retry:{...this[m],...e},logger:this[f],instrumentationEmitter:t,cluster:r})}logger(){return this[f]}}},52190:(e,t,r)=>{const{EventEmitter:o}=r(82361),s=r(40267),{KafkaJSError:i}=r(29879);e.exports=class{constructor(){this.emitter=new o}emit(e,t){if(!e)throw new i("Invalid event name",{retriable:!1});if(this.emitter.listenerCount(e)>0){const r=new s(e,t);this.emitter.emit(e,r)}}addListener(e,t){return this.emitter.addListener(e,t),()=>this.emitter.removeListener(e,t)}}},40267:e=>{let t=0;e.exports=class{constructor(e,r){this.id=(t===Number.MAX_VALUE&&(t=0),t++),this.type=e,this.timestamp=Date.now(),this.payload=r}}},51429:e=>{e.exports=e=>t=>`${e}.${t}`},91230:(e,t,r)=>{const{LEVELS:o}=r(10354);e.exports=()=>({namespace:e,level:t,label:r,log:s})=>{const i=e?`[${e}] `:"",n=JSON.stringify(Object.assign({level:r},s,{message:`${i}${s.message}`}));switch(t){case o.INFO:return console.info(n);case o.ERROR:return console.error(n);case o.WARN:return console.warn(n);case o.DEBUG:return console.log(n)}}},10354:e=>{const{assign:t}=Object,r={NOTHING:0,ERROR:1,WARN:2,INFO:4,DEBUG:5},o=(e,r,o,s,i)=>(n,a={})=>{r>o()||i({namespace:s,level:r,label:e,log:t({timestamp:(new Date).toISOString(),logger:"kafkajs",message:n},a)})},s=e=>{const t=(process.env.KAFKAJS_LOG_LEVEL||"").toUpperCase();return null==r[t]?e:r[t]};e.exports={LEVELS:r,createLogger:({level:e=r.INFO,logCreator:i}={})=>{let n=s(e);const a=i(n),c=(e,t=null)=>{const r=s(t);return p(e,r)},p=(e,s=null)=>{const i=()=>null==s?n:s,p={info:o("INFO",r.INFO,i,e,a),error:o("ERROR",r.ERROR,i,e,a),warn:o("WARN",r.WARN,i,e,a),debug:o("DEBUG",r.DEBUG,i,e,a)};return t(p,{namespace:c,setLogLevel:e=>{n=e}})};return p()}}},62109:(e,t,r)=>{const o=r(36829),s=r(52882),i=r(56341),{KafkaJSConnectionError:n,KafkaJSConnectionClosedError:a}=r(29879),{INT_32_MAX_VALUE:c}=r(53904),p=r(79152),d=r(6472),{CONNECTION_STATUS:u,CONNECTED_STATUS:l}=r(35315),h=({apiName:e,apiKey:t,apiVersion:r})=>`${e}(key: ${t}, version: ${r})`;e.exports=class{constructor({host:e,port:t,logger:r,socketFactory:o,requestTimeout:s,rack:n=null,ssl:a=null,sasl:c=null,clientId:l="kafkajs",connectionTimeout:h=1e3,enforceRequestTimeout:m=!1,maxInFlightRequests:f=null,instrumentationEmitter:g=null}){this.host=e,this.port=t,this.rack=n,this.clientId=l,this.broker=`${this.host}:${this.port}`,this.logger=r.namespace("Connection"),this.socketFactory=o,this.ssl=a,this.sasl=c,this.requestTimeout=s,this.connectionTimeout=h,this.bytesBuffered=0,this.bytesNeeded=i.int32Size(),this.chunks=[],this.connectionStatus=u.DISCONNECTED,this.correlationId=0,this.requestQueue=new d({instrumentationEmitter:g,maxInFlightRequests:f,requestTimeout:s,enforceRequestTimeout:m,clientId:l,broker:this.broker,logger:r.namespace("RequestQueue"),isConnected:()=>this.connected}),this.authHandlers=null,this.authExpectResponse=!1;const I=e=>(t,r={})=>{(0,this.logger[e])(t,{broker:this.broker,clientId:l,...r})};this.logDebug=I("debug"),this.logError=I("error");const y=p();this.shouldLogBuffers="1"===y.KAFKAJS_DEBUG_PROTOCOL_BUFFERS,this.shouldLogFetchBuffer=this.shouldLogBuffers&&"1"===y.KAFKAJS_DEBUG_EXTENDED_PROTOCOL_BUFFERS}get connected(){return l.includes(this.connectionStatus)}connect(){return new Promise(((e,t)=>{if(this.connected)return e(!0);let r;const s=()=>{clearTimeout(r),this.connectionStatus=u.CONNECTED,this.requestQueue.scheduleRequestTimeoutCheck(),e(!0)},i=e=>{this.processData(e)},c=async()=>{clearTimeout(r);const e=this.connected;this.authHandlers?this.authHandlers.onError():e&&(this.logDebug("Kafka server has closed connection"),this.rejectRequests(new a("Closed connection",{host:this.host,port:this.port}))),await this.disconnect()},p=async e=>{clearTimeout(r);const o=new n(`Connection error: ${e.message}`,{broker:`${this.host}:${this.port}`,code:e.code});this.logError(o.message,{stack:e.stack}),this.rejectRequests(o),await this.disconnect(),t(o)},d=async()=>{const e=new n("Connection timeout",{broker:`${this.host}:${this.port}`});this.logError(e.message),this.rejectRequests(e),await this.disconnect(),t(e)};this.logDebug("Connecting",{ssl:!!this.ssl,sasl:!!this.sasl});try{r=setTimeout(d,this.connectionTimeout),this.socket=o({socketFactory:this.socketFactory,host:this.host,port:this.port,ssl:this.ssl,onConnect:s,onData:i,onEnd:c,onError:p,onTimeout:d})}catch(e){clearTimeout(r),t(new n(`Failed to connect: ${e.message}`,{broker:`${this.host}:${this.port}`}))}}))}async disconnect(){return this.connectionStatus=u.DISCONNECTING,this.logDebug("disconnecting..."),await this.requestQueue.waitForPendingRequests(),this.requestQueue.destroy(),this.socket&&(this.socket.end(),this.socket.unref()),this.connectionStatus=u.DISCONNECTED,this.logDebug("disconnected"),!0}authenticate({authExpectResponse:e=!1,request:t,response:r}){return this.authExpectResponse=e,new Promise((async(e,o)=>{this.authHandlers={onSuccess:t=>{this.authHandlers=null,this.authExpectResponse=!1,r.decode(t).then((e=>r.parse(e))).then(e).catch(o)},onError:()=>{this.authHandlers=null,this.authExpectResponse=!1,o(new n("Connection closed by the server",{broker:`${this.host}:${this.port}`}))}};try{const e=await t.encode();this.failIfNotConnected(),this.socket.write(e.buffer,"binary")}catch(e){o(e)}}))}async send({request:e,response:t,requestTimeout:r=null,logResponseError:o=!0}){this.failIfNotConnected();const i=!e.expectResponse||e.expectResponse(),{correlationId:n,size:a,entry:c,payload:p}=await(async()=>{const{clientId:t}=this,o=this.nextCorrelationId(),n=await s({request:e,correlationId:o,clientId:t}),{apiKey:a,apiName:c,apiVersion:p}=e;return this.logDebug(`Request ${h(e)}`,{correlationId:o,expectResponse:i,size:Buffer.byteLength(n.buffer)}),new Promise(((e,t)=>{try{this.failIfNotConnected();const s={apiKey:a,apiName:c,apiVersion:p,correlationId:o,resolve:e,reject:t};this.requestQueue.push({entry:s,expectResponse:i,requestTimeout:r,sendRequest:()=>{this.socket.write(n.buffer,"binary")}})}catch(e){t(e)}}))})();if(i)try{const e=await t.decode(p);this.requestQueue.maybeThrottle(e.clientSideThrottleTime);const r=await t.parse(e),o="Fetch"===c.apiName;return this.logDebug(`Response ${h(c)}`,{correlationId:n,size:a,data:o&&!this.shouldLogFetchBuffer?"[filtered]":r}),r}catch(e){o&&this.logError(`Response ${h(c)}`,{error:e.message,correlationId:n,size:a});const t=Buffer.isBuffer(p);throw this.logDebug(`Response ${h(c)}`,{error:e.message,correlationId:n,payload:t&&!this.shouldLogBuffers?{type:"Buffer",data:"[filtered]"}:p}),e}}failIfNotConnected(){if(!this.connected)throw new n("Not connected",{broker:`${this.host}:${this.port}`})}nextCorrelationId(){return this.correlationId>=c&&(this.correlationId=0),this.correlationId++}processData(e){if(this.authHandlers&&!this.authExpectResponse)return this.authHandlers.onSuccess(e);for(this.chunks.push(e),this.bytesBuffered+=Buffer.byteLength(e);this.bytesNeeded<=this.bytesBuffered;){const e=this.chunks.length>1?Buffer.concat(this.chunks):this.chunks[0],t=new i(e),r=t.readInt32();if(!t.canReadBytes(r))return this.chunks=[e],this.bytesBuffered=Buffer.byteLength(e),void(this.bytesNeeded=i.int32Size()+r);const o=new i(t.readBytes(r)),s=t.readAll();if(this.chunks=[s],this.bytesBuffered=Buffer.byteLength(s),this.bytesNeeded=i.int32Size(),this.authHandlers){const t=i.int32Size()+r,o=e.slice(0,t);return this.authHandlers.onSuccess(o)}const n=o.readInt32(),a=o.readAll();this.requestQueue.fulfillRequest({size:r,correlationId:n,payload:a})}}rejectRequests(e){this.requestQueue.rejectAll(e)}}},35315:e=>{const t={CONNECTED:"connected",DISCONNECTING:"disconnecting",DISCONNECTED:"disconnected"},r=[t.CONNECTED,t.DISCONNECTING];e.exports={CONNECTION_STATUS:t,CONNECTED_STATUS:r}},28202:(e,t,r)=>{const o=r(51429)("network");e.exports={NETWORK_REQUEST:o("request"),NETWORK_REQUEST_TIMEOUT:o("request_timeout"),NETWORK_REQUEST_QUEUE_SIZE:o("request_queue_size")}},6472:(e,t,r)=>{const{EventEmitter:o}=r(82361),s=r(32764),i=r(28202),{KafkaJSInvariantViolation:n}=r(29879),a=Symbol("private:RequestQueue:emitQueueSizeEvent"),c=Symbol("private:RequestQueue:emitQueueEmpty"),p="requestQueueEmpty";e.exports=class extends o{constructor({instrumentationEmitter:e=null,maxInFlightRequests:t,requestTimeout:r,enforceRequestTimeout:o,clientId:s,broker:n,logger:d,isConnected:u=(()=>!0)}){super(),this.instrumentationEmitter=e,this.maxInFlightRequests=t,this.requestTimeout=r,this.enforceRequestTimeout=o,this.clientId=s,this.broker=n,this.logger=d,this.isConnected=u,this.inflight=new Map,this.pending=[],this.throttledUntil=-1,this.throttleCheckTimeoutId=null,this[c]=()=>{0===this.pending.length&&0===this.inflight.size&&this.emit(p)},this[a]=()=>{e&&e.emit(i.NETWORK_REQUEST_QUEUE_SIZE,{broker:this.broker,clientId:this.clientId,queueSize:this.pending.length}),this[c]()}}scheduleRequestTimeoutCheck(){this.enforceRequestTimeout&&(this.destroy(),this.requestTimeoutIntervalId=setInterval((()=>{this.inflight.forEach((e=>{Date.now()-e.sentAt>e.requestTimeout&&e.timeoutRequest()})),this.isConnected()||this.destroy()}),Math.min(this.requestTimeout,100)))}maybeThrottle(e){if(e){const t=Date.now()+e;this.throttledUntil=Math.max(t,this.throttledUntil)}}push(e){const{correlationId:t}=e.entry,r=this.requestTimeout,o=e.requestTimeout,i=Math.max(r,o||0),p=new s({entry:e.entry,expectResponse:e.expectResponse,broker:this.broker,clientId:this.clientId,instrumentationEmitter:this.instrumentationEmitter,requestTimeout:i,send:()=>{if(this.inflight.has(t))throw new n("Correlation id already exists");this.inflight.set(t,p),e.sendRequest()},timeout:()=>{this.inflight.delete(t),this.checkPendingRequests(),this[c]()}});this.canSendSocketRequestImmediately()?this.sendSocketRequest(p):(this.pending.push(p),this.scheduleCheckPendingRequests(),this.logger.debug("Request enqueued",{clientId:this.clientId,broker:this.broker,correlationId:t}),this[a]())}sendSocketRequest(e){e.send(),e.expectResponse||(this.logger.debug("Request does not expect a response, resolving immediately",{clientId:this.clientId,broker:this.broker,correlationId:e.correlationId}),this.inflight.delete(e.correlationId),e.completed({size:0,payload:null}))}fulfillRequest({correlationId:e,payload:t,size:r}){const o=this.inflight.get(e);this.inflight.delete(e),this.checkPendingRequests(),o?o.completed({size:r,payload:t}):this.logger.warn("Response without match",{clientId:this.clientId,broker:this.broker,correlationId:e}),this[c]()}rejectAll(e){const t=[...this.inflight.values(),...this.pending];for(const r of t)r.rejected(e),this.inflight.delete(r.correlationId);this.pending=[],this.inflight.clear(),this[a]()}waitForPendingRequests(){return new Promise((e=>{if(0===this.pending.length&&0===this.inflight.size)return e();this.logger.debug("Waiting for pending requests",{clientId:this.clientId,broker:this.broker,currentInflightRequests:this.inflight.size,currentPendingQueueSize:this.pending.length}),this.once(p,(()=>e()))}))}destroy(){clearInterval(this.requestTimeoutIntervalId),clearTimeout(this.throttleCheckTimeoutId),this.throttleCheckTimeoutId=null}canSendSocketRequestImmediately(){return!(null!=this.maxInFlightRequests&&this.inflight.size>=this.maxInFlightRequests||this.throttledUntil>Date.now())}checkPendingRequests(){for(;this.pending.length>0&&this.canSendSocketRequestImmediately();){const e=this.pending.shift();this.sendSocketRequest(e),this.logger.debug("Consumed pending request",{clientId:this.clientId,broker:this.broker,correlationId:e.correlationId,pendingDuration:e.pendingDuration,currentPendingQueueSize:this.pending.length}),this[a]()}this.scheduleCheckPendingRequests()}scheduleCheckPendingRequests(){const e=this.throttledUntil-Date.now();e>0&&!this.throttleCheckTimeoutId&&(this.throttleCheckTimeoutId=setTimeout((()=>{this.throttleCheckTimeoutId=null,this.checkPendingRequests()}),e))}}},32764:(e,t,r)=>{const{KafkaJSRequestTimeoutError:o,KafkaJSNonRetriableError:s}=r(29879),i=r(28202),n=Symbol("private:SocketRequest:state"),a=Symbol("private:SocketRequest:emitEvent"),c={PENDING:Symbol("PENDING"),SENT:Symbol("SENT"),COMPLETED:Symbol("COMPLETED"),REJECTED:Symbol("REJECTED")};e.exports=class{constructor({requestTimeout:e,broker:t,clientId:r,entry:o,expectResponse:s,send:i,timeout:p,instrumentationEmitter:d=null}){this.createdAt=Date.now(),this.requestTimeout=e,this.broker=t,this.clientId=r,this.entry=o,this.correlationId=o.correlationId,this.expectResponse=s,this.sendRequest=i,this.timeoutHandler=p,this.sentAt=null,this.duration=null,this.pendingDuration=null,this[n]=c.PENDING,this[a]=(e,t)=>d&&d.emit(e,t)}send(){this.throwIfInvalidState({accepted:[c.PENDING],next:c.SENT}),this.sendRequest(),this.sentAt=Date.now(),this.pendingDuration=this.sentAt-this.createdAt,this[n]=c.SENT}timeoutRequest(){const{apiName:e,apiKey:t,apiVersion:r}=this.entry,s=`${e}(key: ${t}, version: ${r})`,n={broker:this.broker,clientId:this.clientId,correlationId:this.correlationId,createdAt:this.createdAt,sentAt:this.sentAt,pendingDuration:this.pendingDuration};this.timeoutHandler(),this.rejected(new o(`Request ${s} timed out`,n)),this[a](i.NETWORK_REQUEST_TIMEOUT,{...n,apiName:e,apiKey:t,apiVersion:r})}completed({size:e,payload:t}){this.throwIfInvalidState({accepted:[c.SENT],next:c.COMPLETED});const{entry:r,correlationId:o,broker:s,clientId:p,createdAt:d,sentAt:u,pendingDuration:l}=this;this[n]=c.COMPLETED,this.duration=Date.now()-this.sentAt,r.resolve({correlationId:o,entry:r,size:e,payload:t}),this[a](i.NETWORK_REQUEST,{broker:s,clientId:p,correlationId:o,size:e,createdAt:d,sentAt:u,pendingDuration:l,duration:this.duration,apiName:r.apiName,apiKey:r.apiKey,apiVersion:r.apiVersion})}rejected(e){this.throwIfInvalidState({accepted:[c.PENDING,c.SENT],next:c.REJECTED}),this[n]=c.REJECTED,this.duration=Date.now()-this.sentAt,this.entry.reject(e)}throwIfInvalidState({accepted:e,next:t}){if(e.includes(this[n]))return;const r=this[n].toString();throw new s(`Invalid state, can't transition from ${r} to ${t.toString()}`)}}},36829:e=>{e.exports=({socketFactory:e,host:t,port:r,ssl:o,onConnect:s,onData:i,onEnd:n,onError:a,onTimeout:c})=>{const p=e({host:t,port:r,ssl:o,onConnect:s});return p.on("data",i),p.on("end",n),p.on("error",a),p.on("timeout",c),p}},89992:(e,t,r)=>{e.exports=()=>{const e=r(41808),t=r(24404);return({host:r,port:o,ssl:s,onConnect:i})=>{const n=s?t.connect(Object.assign({host:r,port:o,servername:r},s),i):e.connect({host:r,port:o},i);return n.setKeepAlive(!0,6e4),n}}},88460:e=>{e.exports=e=>e.map((({topic:e,partitions:t,messagesPerPartition:r,sequencePerPartition:o})=>({topic:e,partitions:t.map((e=>({partition:e,firstSequence:o[e],messages:r[e]})))})))},56236:(e,t,r)=>{const o=r(99701),{KafkaJSNonRetriableError:s}=r(29879),i=r(7022),n=r(81352),a=r(39491),c=r(75497),p=Math.pow(2,32),d=["NOT_COORDINATOR_FOR_GROUP","GROUP_COORDINATOR_NOT_AVAILABLE","GROUP_LOAD_IN_PROGRESS","CONCURRENT_TRANSACTIONS"],u=["UNKNOWN_TOPIC_OR_PARTITION","COORDINATOR_LOAD_IN_PROGRESS"],l=["COORDINATOR_NOT_AVAILABLE","NOT_COORDINATOR"];e.exports=({logger:e,cluster:t,transactionTimeout:r=6e4,transactional:h,transactionalId:m})=>{if(h&&!m)throw new s("Cannot manage transactions without a transactionalId");const f=o(t.retry);let g=-1,I=0,y={},w={};const T=n({logger:e});T.on("transition",(({to:e})=>{e===c.READY&&(w={})}));const E=()=>t.findGroupCoordinator({groupId:m,coordinatorType:i.TRANSACTION}),b=()=>{if(!h)throw new s("Method unavailable if non-transactional")},S=T.createGuarded({getProducerId:()=>g,getProducerEpoch:()=>I,getTransactionalId:()=>m,initProducerId:async()=>f((async(o,s,i)=>{try{await t.refreshMetadataIfNecessary();const o=await(h?E():t.findControllerBroker()),s=await o.initProducerId({transactionalId:h?m:void 0,transactionTimeout:r});T.transitionTo(c.READY),g=s.producerId,I=s.producerEpoch,y={},e.debug("Initialized producer id & epoch",{producerId:g,producerEpoch:I})}catch(t){if(d.includes(t.type))throw"CONCURRENT_TRANSACTIONS"===t.type&&e.debug("There is an ongoing transaction on this transactionId, retrying",{error:t.message,stack:t.stack,transactionalId:m,retryCount:s,retryTime:i}),t;o(t)}})),getSequence:(e,t)=>S.isInitialized()?(y[e]=y[e]||{},y[e][t]=y[e][t]||0,y[e][t]):0,updateSequence(t,r,o){if(!S.isInitialized())return;let s=S.getSequence(t,r)+o;s>=p&&(e.debug(`Sequence for ${t} ${r} exceeds max value (${s}). Rotating to 0.`),s=0),y[t][r]=s},beginTransaction(){b(),T.transitionTo(c.TRANSACTING)},async addPartitionsToTransaction(e){b();const t={};e.forEach((({topic:e,partitions:r})=>{w[e]=w[e]||{},r.forEach((({partition:r})=>{w[e][r]||(t[e]=t[e]||[],t[e].push(r))}))}));const r=Object.keys(t).map((e=>({topic:e,partitions:t[e]})));if(r.length){const e=await E();await e.addPartitionsToTxn({transactionalId:m,producerId:g,producerEpoch:I,topics:r})}r.forEach((({topic:e,partitions:t})=>{t.forEach((t=>{w[e][t]=!0}))}))},async commit(){b(),T.transitionTo(c.COMMITTING);const e=await E();await e.endTxn({producerId:g,producerEpoch:I,transactionalId:m,transactionResult:!0}),T.transitionTo(c.READY)},async abort(){b(),T.transitionTo(c.ABORTING);const e=await E();await e.endTxn({producerId:g,producerEpoch:I,transactionalId:m,transactionResult:!1}),T.transitionTo(c.READY)},isInitialized:()=>-1!==g,isTransactional:()=>h,isInTransaction:()=>T.state()===c.TRANSACTING,async sendOffsets({consumerGroupId:r,topics:o}){a(r,"Missing consumerGroupId"),a(o,"Missing offset topics");const s=await E();await s.addOffsetsToTxn({transactionalId:m,producerId:g,producerEpoch:I,groupId:r});let n=await t.findGroupCoordinator({groupId:r,coordinatorType:i.GROUP});return f((async(s,a,c)=>{try{await n.txnOffsetCommit({transactionalId:m,producerId:g,producerEpoch:I,groupId:r,topics:o})}catch(o){if(u.includes(o.type))throw e.debug("Group coordinator is not ready yet, retrying",{error:o.message,stack:o.stack,transactionalId:m,retryCount:a,retryTime:c}),o;if(l.includes(o.type)||"ECONNREFUSED"===o.code)throw e.debug("Invalid group coordinator, finding new group coordinator and retrying",{error:o.message,stack:o.stack,transactionalId:m,retryCount:a,retryTime:c}),n=await t.findGroupCoordinator({groupId:r,coordinatorType:i.GROUP}),o;s(o)}}))}},{initProducerId:{legalStates:[c.UNINITIALIZED,c.READY]},beginTransaction:{legalStates:[c.READY],async:!1},addPartitionsToTransaction:{legalStates:[c.TRANSACTING]},sendOffsets:{legalStates:[c.TRANSACTING]},commit:{legalStates:[c.TRANSACTING]},abort:{legalStates:[c.TRANSACTING]}});return S}},81352:(e,t,r)=>{const{EventEmitter:o}=r(82361),{KafkaJSNonRetriableError:s}=r(29879),i=r(75497),n={[i.UNINITIALIZED]:[i.READY],[i.READY]:[i.READY,i.TRANSACTING],[i.TRANSACTING]:[i.COMMITTING,i.ABORTING],[i.COMMITTING]:[i.READY],[i.ABORTING]:[i.READY]};e.exports=({logger:e,initialState:t=i.UNINITIALIZED})=>{let r=t;const a=Object.assign(new o,{createGuarded(e,t){const o=Object.keys(t).reduce(((o,i)=>(o[i]=((e,t,{legalStates:o,async:i=!0})=>{if(!e[t])throw new s(`Cannot add guard on missing method "${t}"`);return(...n)=>{const a=e[t];if(!o.includes(r)){const e=new s(`Transaction state exception: Cannot call "${t}" in state "${r}"`);if(i)return Promise.reject(e);throw e}return a.apply(e,n)}})(e,i,t[i]),o)),{});return{...e,...o}},transitionTo(t){if(e.debug(`Transaction state transition ${r} --\x3e ${t}`),!n[r].includes(t))throw new s(`Transaction state exception: Invalid transition ${r} --\x3e ${t}`);a.emit("transition",{to:t,from:r}),r=t},state:()=>r});return a}},75497:e=>{e.exports={UNINITIALIZED:"UNINITIALIZED",READY:"READY",TRANSACTING:"TRANSACTING",COMMITTING:"COMMITTING",ABORTING:"ABORTING"}},80065:e=>{e.exports=({topic:e,partitionMetadata:t,messages:r,partitioner:o})=>0===t.length?{}:r.reduce(((r,s)=>{const i=o({topic:e,partitionMetadata:t,message:s}),n=r[i]||[];return Object.assign(r,{[i]:[...n,s]})}),{})},73798:(e,t,r)=>{const o=r(99701),{CONNECTION_STATUS:s}=r(35315),{DefaultPartitioner:i}=r(88691),n=r(52190),a=r(56236),c=r(33062),{events:p,wrap:d,unwrap:u}=r(17293),{KafkaJSNonRetriableError:l}=r(29879),{values:h,keys:m}=Object,f=h(p),g=m(p).map((e=>`producer.events.${e}`)).join(", "),{CONNECT:I,DISCONNECT:y}=p;e.exports=({cluster:e,logger:t,createPartitioner:r=i,retry:h,idempotent:m=!1,transactionalId:w,transactionTimeout:T,instrumentationEmitter:E})=>{let b=s.DISCONNECTED;if(h=h||{retries:m?Number.MAX_SAFE_INTEGER:5},m&&h.retries<1)throw new l("Idempotent producer must allow retries to protect against transient errors");const S=t.namespace("Producer");m&&h.retries<Number.MAX_SAFE_INTEGER&&S.warn("Limiting retries for the idempotent producer may invalidate EoS guarantees");const A=r(),O=o(Object.assign({},e.retry,h)),C=E||new n,N=a({logger:S,cluster:e,transactionTimeout:T,transactional:!1,transactionalId:w}),{send:R,sendBatch:k}=c({logger:S,cluster:e,partitioner:A,eosManager:N,idempotent:m,retrier:O,getConnectionStatus:()=>b});let x;return{connect:async()=>{await e.connect(),b=s.CONNECTED,C.emit(I),m&&!N.isInitialized()&&await N.initProducerId()},disconnect:async()=>{b=s.DISCONNECTING,await e.disconnect(),b=s.DISCONNECTED,C.emit(y)},isIdempotent:()=>m,events:p,on:(e,t)=>{if(!f.includes(e))throw new l(`Event name should be one of ${g}`);return C.addListener(u(e),(r=>{r.type=d(r.type),Promise.resolve(t(r)).catch((t=>{S.error(`Failed to execute listener: ${t.message}`,{eventName:e,stack:t.stack})}))}))},send:R,sendBatch:k,transaction:async()=>{if(!w)throw new l("Must provide transactional id for transactional producer");let t=!1;if(x=x||a({logger:S,cluster:e,transactionTimeout:T,transactional:!0,transactionalId:w}),x.isInTransaction())throw new l("There is already an ongoing transaction for this producer. Please end the transaction before beginning another.");x.isInitialized()||await x.initProducerId(),x.beginTransaction();const{send:r,sendBatch:o}=c({logger:S,cluster:e,partitioner:A,retrier:O,eosManager:x,idempotent:!0,getConnectionStatus:()=>b}),s=()=>x.isInTransaction()&&!t,i=e=>(...t)=>s()?e(...t):Promise.reject(new l("Cannot continue to use transaction once ended"));return{sendBatch:i(o),send:i(r),abort:i((async()=>{await x.abort(),t=!0})),commit:i((async()=>{await x.commit(),t=!0})),sendOffsets:i((async({consumerGroupId:t,topics:r})=>{await x.sendOffsets({consumerGroupId:t,topics:r});for(const o of r){const{topic:r,partitions:s}=o;for(const{partition:o,offset:i}of s)e.markOffsetAsCommitted({groupId:t,topic:r,partition:o,offset:i})}})),isActive:s}},logger:()=>S}}},17293:(e,t,r)=>{const o=r(76),s=r(28202),i=r(51429)("producer"),n={CONNECT:i("connect"),DISCONNECT:i("disconnect"),REQUEST:i(s.NETWORK_REQUEST),REQUEST_TIMEOUT:i(s.NETWORK_REQUEST_TIMEOUT),REQUEST_QUEUE_SIZE:i(s.NETWORK_REQUEST_QUEUE_SIZE)},a={[n.REQUEST]:s.NETWORK_REQUEST,[n.REQUEST_TIMEOUT]:s.NETWORK_REQUEST_TIMEOUT,[n.REQUEST_QUEUE_SIZE]:s.NETWORK_REQUEST_QUEUE_SIZE},c=o(a);e.exports={events:n,wrap:e=>c[e]||e,unwrap:e=>a[e]||e}},33062:(e,t,r)=>{const o=r(39326),{KafkaJSError:s,KafkaJSNonRetriableError:i}=r(29879),{CONNECTION_STATUS:n}=r(35315);e.exports=({logger:e,cluster:t,partitioner:r,eosManager:a,idempotent:c,retrier:p,getConnectionStatus:d})=>{const u=o({logger:e,cluster:t,retrier:p,partitioner:r,eosManager:a}),l=async({acks:e=-1,timeout:t,compression:r,topicMessages:o=[]})=>{if(o.some((({topic:e})=>!e)))throw new i("Invalid topic");if(c&&-1!==e)throw new i("Not requiring ack for all messages invalidates the idempotent producer's EoS guarantees");for(const{topic:e,messages:t}of o){if(!t)throw new i(`Invalid messages array [${t}] for topic "${e}"`);const r=t.find((e=>void 0===e.value));if(r)throw new i(`Invalid message without value for topic "${e}": ${JSON.stringify(r)}`)}(()=>{switch(d()){case n.DISCONNECTING:throw new i("The producer is disconnecting; therefore, it can't safely accept messages anymore");case n.DISCONNECTED:throw new s("The producer is disconnected")}})();const a=o.reduce(((e,{topic:t,messages:r})=>{const o=e.findIndex((({topic:e})=>t===e));return-1===o?e.push({topic:t,messages:r}):e[o].messages=[...e[o].messages,...r],e}),[]);return await u({acks:e,timeout:t,compression:r,topicMessages:a})};return{send:async({acks:e,timeout:t,compression:r,topic:o,messages:s})=>l({acks:e,timeout:t,compression:r,topicMessages:[{topic:o,messages:s}]}),sendBatch:l}}},14655:(e,t,r)=>{const o=r(79416),s=r(13583);e.exports=s(o)},79416:e=>{const t=1540483477;e.exports=e=>{const r=Buffer.isBuffer(e)?e:Buffer.from(String(e)),o=r.length;let s=2538058380^o,i=o/4;for(let e=0;e<i;e++){const o=4*e;let i=(255&r[o+0])+((255&r[o+1])<<8)+((255&r[o+2])<<16)+((255&r[o+3])<<24);i*=t,i^=i>>>24,i*=t,s*=t,s^=i}switch(o%4){case 3:s^=(255&r[2+(-4&o)])<<16;case 2:s^=(255&r[1+(-4&o)])<<8;case 1:s^=255&r[-4&o],s*=t}return s^=s>>>13,s*=t,s^=s>>>15,s}},13583:(e,t,r)=>{const o=r(35427),s=e=>2147483647&e;e.exports=e=>()=>{const t={};return({topic:r,partitionMetadata:i,message:n})=>{r in t||(t[r]=o(32).readUInt32BE(0));const a=i.length,c=i.filter((e=>e.leader>=0)),p=c.length;return null!==n.partition&&void 0!==n.partition?n.partition:null!==n.key&&void 0!==n.key?s(e(n.key))%a:p>0?c[s(++t[r])%p].partitionId:s(++t[r])%a}}},35427:(e,t,r)=>{const{KafkaJSNonRetriableError:o}=r(29879),s=e=>({randomBytes:t=>e.getRandomValues(Buffer.allocUnsafe(t))});let i=null;global&&global.crypto?i=void 0===global.crypto.randomBytes?s(global.crypto):global.crypto:global&&global.msCrypto?i=s(global.msCrypto):global&&!global.crypto&&(i=r(6113)),e.exports=e=>{if(e>65536)throw new o(`Byte length (${e}) exceeds the max number of bytes of entropy available (65536)`);if(!i)throw new o("No available crypto implementation");return i.randomBytes(e)}},55476:(e,t,r)=>{const o=r(64953),s=r(13583);e.exports=s(o)},64953:(e,t,r)=>{const o=r(73278),s=o.fromValue(2538058380),i=o.fromValue(1540483477),n=o.fromValue(24);e.exports=e=>{const t=Buffer.isBuffer(e)?e:Buffer.from(String(e)),r=t.length;let a=o.fromValue(s.xor(r)),c=Math.floor(r/4);for(let e=0;e<c;e++){const r=4*e;let s=(255&t[r+0])+((255&t[r+1])<<8)+((255&t[r+2])<<16)+((255&t[r+3])<<24);s=o.fromValue(s),s=s.multiply(i),s=s.xor(s.toInt()>>>n),s=o.fromValue(s).multiply(i),a=a.multiply(i),a=a.xor(s)}switch(r%4){case 3:a=a.xor((255&t[2+(-4&r)])<<16);case 2:a=a.xor((255&t[1+(-4&r)])<<8);case 1:a=a.xor(255&t[-4&r]),a=a.multiply(i)}return a=a.xor(a.toInt()>>>13),a=a.multiply(i),a=a.xor(a.toInt()>>>15),a.toInt()}},88691:(e,t,r)=>{const o=r(14655),s=r(55476);e.exports={DefaultPartitioner:o,JavaCompatiblePartitioner:s}},10922:(e,t,r)=>{const o=r(74358);e.exports=({topics:e})=>{const t=e.map((({topicName:e,partitions:t})=>t.map((t=>({topicName:e,...t})))));return o(t)}},39326:(e,t,r)=>{const o=r(74358),{KafkaJSMetadataNotLoaded:s}=r(29879),{staleMetadata:i}=r(21701),n=r(80065),a=r(88460),c=r(10922),{keys:p}=Object;e.exports=({logger:e,cluster:t,partitioner:r,eosManager:d,retrier:u})=>async({acks:l,timeout:h,compression:m,topicMessages:f})=>{const g=new Map;return u((async(u,I,y)=>{const w=f.map((({topic:e})=>e));await t.addMultipleTargetTopics(w);try{const i=await(async o=>{const i=new Map;await t.refreshMetadataIfNecessary();for(const{topic:a,messages:c}of f){const u=t.findTopicPartitionMetadata(a);if(0===u.length)throw e.debug("Producing to topic without metadata",{topic:a,targetTopics:Array.from(t.targetTopics)}),new s("Producing to topic without metadata");const l=n({topic:a,partitionMetadata:u,messages:c,partitioner:r}),h=p(l),m=h.reduce(((e,t)=>(e[t]=d.getSequence(a,t),e)),{}),f=t.findLeaderForPartitions(a,h),g=p(f);i.set(a,{partitionsPerLeader:f,messagesPerPartition:l,sequencePerPartition:m});for(const e of g){const r=await t.findBroker({nodeId:e});o.has(r)||o.set(r,null)}}return Array.from(o.keys()).filter((e=>!o.get(e))).map((async e=>{const t=Array.from(i.entries()).filter((([t,{partitionsPerLeader:r}])=>!!r[e.nodeId])).map((([t,{partitionsPerLeader:r,messagesPerPartition:o,sequencePerPartition:s}])=>({topic:t,partitions:r[e.nodeId],sequencePerPartition:s,messagesPerPartition:o}))),r=a(t);try{d.isTransactional()&&await d.addPartitionsToTransaction(r);const t=await e.produce({transactionalId:d.isTransactional()?d.getTransactionalId():void 0,producerId:d.getProducerId(),producerEpoch:d.getProducerEpoch(),acks:l,timeout:h,compression:m,topicData:r}),s=0!==l?c(t):[];s.forEach((({topicName:e,partition:t})=>{const r=i.get(e).messagesPerPartition[t].length;d.updateSequence(e,t,r)})),o.set(e,s)}catch(t){throw o.delete(e),t}}))})(g);await Promise.all(i);const u=Array.from(g.values());return o(u)}catch(r){if("KafkaJSConnectionClosedError"===r.name&&t.removeBroker({host:r.host,port:r.port}),!t.isConnected())throw e.debug(`Cluster has disconnected, reconnecting: ${r.message}`,{retryCount:I,retryTime:y}),await t.connect(),await t.refreshMetadata(),r;if(i(r)||"KafkaJSMetadataNotLoaded"===r.name||"KafkaJSConnectionError"===r.name||"KafkaJSConnectionClosedError"===r.name||"KafkaJSProtocolError"===r.name&&r.retriable)throw e.error(`Failed to send messages: ${r.message}`,{retryCount:I,retryTime:y}),await t.refreshMetadata(),r;if(e.error(`${r.message}`,{retryCount:I,retryTime:y}),r.retriable)throw r;u(r)}}))}},13595:e=>{e.exports={UNKNOWN:0,ANY:1,ALL:2,READ:3,WRITE:4,CREATE:5,DELETE:6,ALTER:7,DESCRIBE:8,CLUSTER_ACTION:9,DESCRIBE_CONFIGS:10,ALTER_CONFIGS:11,IDEMPOTENT_WRITE:12}},34517:e=>{e.exports={UNKNOWN:0,ANY:1,DENY:2,ALLOW:3}},77666:e=>{e.exports={UNKNOWN:0,ANY:1,TOPIC:2,GROUP:3,CLUSTER:4,TRANSACTIONAL_ID:5,DELEGATION_TOKEN:6}},18279:e=>{e.exports={UNKNOWN:0,TOPIC:2,BROKER:4,BROKER_LOGGER:8}},9955:e=>{e.exports={UNKNOWN:0,TOPIC_CONFIG:1,DYNAMIC_BROKER_CONFIG:2,DYNAMIC_DEFAULT_BROKER_CONFIG:3,STATIC_BROKER_CONFIG:4,DEFAULT_CONFIG:5,DYNAMIC_BROKER_LOGGER_CONFIG:6}},7022:e=>{e.exports={GROUP:0,TRANSACTION:1}},21574:e=>{var t=new Int32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);e.exports=e=>{const{buffer:r}=e,o=r.length;let s=-1;for(let e=0;e<o;e++)s=t[255&(s^r[e])]^s>>>8;return-1^s}},56341:(e,t,r)=>{const{KafkaJSInvalidVarIntError:o,KafkaJSInvalidLongError:s}=r(29879),i=r(73278);e.exports=class e{static int32Size(){return 4}static decodeZigZag(e){return e>>>1^-(1&e)}static decodeZigZag64(e){return e.shiftRightUnsigned(1).xor(e.and(i.fromInt(1)).negate())}constructor(e){this.buffer=e,this.offset=0}readInt8(){const e=this.buffer.readInt8(this.offset);return this.offset+=1,e}canReadInt16(){return this.canReadBytes(2)}readInt16(){const e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}canReadInt32(){return this.canReadBytes(4)}readInt32(){const e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}canReadInt64(){return this.canReadBytes(8)}readInt64(){const e=this.buffer[this.offset],t=this.buffer[this.offset+7],r=(e<<24)+65536*this.buffer[this.offset+1]+256*this.buffer[this.offset+2]+this.buffer[this.offset+3],o=this.buffer[this.offset+4]*2**24+65536*this.buffer[this.offset+5]+256*this.buffer[this.offset+6]+t;return this.offset+=8,(BigInt(r)<<32n)+BigInt(o)}readDouble(){const e=this.buffer.readDoubleBE(this.offset);return this.offset+=8,e}readString(){const e=this.readInt16();if(-1===e)return null;const t=this.buffer.slice(this.offset,this.offset+e).toString("utf8");return this.offset+=e,t}readVarIntString(){const e=this.readVarInt();if(-1===e)return null;const t=this.buffer.slice(this.offset,this.offset+e).toString("utf8");return this.offset+=e,t}readUVarIntString(){const e=this.readUVarInt();if(0===e)return null;const t=this.buffer.slice(this.offset,this.offset+e).toString("utf8");return this.offset+=e,t}canReadBytes(e){return Buffer.byteLength(this.buffer)-this.offset>=e}readBytes(e=this.readInt32()){if(-1===e)return null;const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readVarIntBytes(){const e=this.readVarInt();if(-1===e)return null;const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readUVarIntBytes(){const e=this.readUVarInt();if(0===e)return null;const t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}readBoolean(){return 1===this.readInt8()}readAll(){const e=this.buffer.slice(this.offset);return this.offset+=Buffer.byteLength(this.buffer),e}readArray(e){const t=this.readInt32();if(-1===t)return[];const r=new Array(t);for(let o=0;o<t;o++)r[o]=e(this);return r}readVarIntArray(e){const t=this.readVarInt();if(-1===t)return[];const r=new Array(t);for(let o=0;o<t;o++)r[o]=e(this);return r}readUVarIntArray(e){const t=this.readUVarInt();if(0===t)return[];const r=new Array(t-1);for(let o=0;o<t-1;o++)r[o]=e(this);return r}async readArrayAsync(e){const t=this.readInt32();if(-1===t)return[];const r=new Array(t);for(let o=0;o<t;o++)r[o]=await e(this);return r}readVarInt(){let t,r=0,o=0;do{t=this.buffer[this.offset++],r+=(127&t)<<o,o+=7}while(t>=128);return e.decodeZigZag(r)}readUVarInt(){let e,t=0,r=0;for(;0!=(128&(e=this.buffer[this.offset++]));)if(t|=(127&e)<<r,r+=7,r>28)throw new o("Invalid VarInt, must contain 5 bytes or less");return t|=e<<r,t>>>0}readVarLong(){let t,r=i.fromInt(0),o=0;do{if(o>63)throw new s("Invalid Long, must contain 9 bytes or less");t=this.buffer[this.offset++],r=r.add(i.fromInt(127&t).shiftLeft(o)),o+=7}while(t>=128);return e.decodeZigZag64(r)}slice(t){return new e(this.buffer.slice(this.offset,this.offset+t))}forward(e){this.offset+=e}}},28783:(e,t,r)=>{const o=r(73278),s=4294967168,i=0xffffffffffffff80n;e.exports=class e{static encodeZigZag(e){return e<<1^e>>31}static encodeZigZag64(e){const t=o.fromValue(e);return t.shiftLeft(1).xor(t.shiftRight(63))}static sizeOfVarInt(e){let t=this.encodeZigZag(e),r=1;for(;0!=(t&s);)r+=1,t>>>=7;return r}static sizeOfVarLong(t){let r=e.encodeZigZag64(t),s=1;for(;r.and(i).notEquals(o.fromInt(0));)s+=1,r=r.shiftRightUnsigned(7);return s}static sizeOfVarIntBytes(t){const r=null==t?-1:Buffer.byteLength(t);return r<0?e.sizeOfVarInt(-1):e.sizeOfVarInt(r)+r}static nextPowerOfTwo(e){return 1<<31-Math.clz32(e)+1}constructor(t=511){this.buf=Buffer.alloc(e.nextPowerOfTwo(t)),this.offset=0}writeBufferInternal(e){const t=e.length;this.ensureAvailable(t),e.copy(this.buf,this.offset,0),this.offset+=t}ensureAvailable(t){if(this.offset+t>this.buf.length){const r=e.nextPowerOfTwo(this.offset+t),o=Buffer.alloc(r);this.buf.copy(o,0,0,this.offset),this.buf=o}}get buffer(){return this.buf.slice(0,this.offset)}writeInt8(e){return this.ensureAvailable(1),this.buf.writeInt8(e,this.offset),this.offset+=1,this}writeInt16(e){return this.ensureAvailable(2),this.buf.writeInt16BE(e,this.offset),this.offset+=2,this}writeInt32(e){return this.ensureAvailable(4),this.buf.writeInt32BE(e,this.offset),this.offset+=4,this}writeUInt32(e){return this.ensureAvailable(4),this.buf.writeUInt32BE(e,this.offset),this.offset+=4,this}writeInt64(e){this.ensureAvailable(8);const t=o.fromValue(e);return this.buf.writeInt32BE(t.getHighBits(),this.offset),this.buf.writeInt32BE(t.getLowBits(),this.offset+4),this.offset+=8,this}writeDouble(e){return this.ensureAvailable(8),this.buf.writeDoubleBE(e,this.offset),this.offset+=8,this}writeBoolean(e){return e?this.writeInt8(1):this.writeInt8(0),this}writeString(e){if(null==e)return this.writeInt16(-1),this;const t=Buffer.byteLength(e,"utf8");return this.ensureAvailable(2+t),this.writeInt16(t),this.buf.write(e,this.offset,t,"utf8"),this.offset+=t,this}writeVarIntString(e){if(null==e)return this.writeVarInt(-1),this;const t=Buffer.byteLength(e,"utf8");return this.writeVarInt(t),this.ensureAvailable(t),this.buf.write(e,this.offset,t,"utf8"),this.offset+=t,this}writeUVarIntString(e){if(null==e)return this.writeUVarInt(0),this;const t=Buffer.byteLength(e,"utf8");return this.writeUVarInt(t+1),this.ensureAvailable(t),this.buf.write(e,this.offset,t,"utf8"),this.offset+=t,this}writeBytes(e){if(null==e)return this.writeInt32(-1),this;if(Buffer.isBuffer(e))this.ensureAvailable(4+e.length),this.writeInt32(e.length),this.writeBufferInternal(e);else{const t=String(e),r=Buffer.byteLength(t,"utf8");this.ensureAvailable(4+r),this.writeInt32(r),this.buf.write(t,this.offset,r,"utf8"),this.offset+=r}return this}writeVarIntBytes(e){if(null==e)return this.writeVarInt(-1),this;if(Buffer.isBuffer(e))this.writeVarInt(e.length),this.writeBufferInternal(e);else{const t=String(e),r=Buffer.byteLength(t,"utf8");this.writeVarInt(r),this.ensureAvailable(r),this.buf.write(t,this.offset,r,"utf8"),this.offset+=r}return this}writeUVarIntBytes(e){if(null==e)return this.writeVarInt(0),this;if(Buffer.isBuffer(e))this.writeUVarInt(e.length+1),this.writeBufferInternal(e);else{const t=String(e),r=Buffer.byteLength(t,"utf8");this.writeUVarInt(r+1),this.ensureAvailable(r),this.buf.write(t,this.offset,r,"utf8"),this.offset+=r}return this}writeEncoder(e){if(null==e||!Buffer.isBuffer(e.buf))throw new Error("value should be an instance of Encoder");return this.writeBufferInternal(e.buffer),this}writeEncoderArray(e){if(!Array.isArray(e)||e.some((e=>null==e||!Buffer.isBuffer(e.buf))))throw new Error("all values should be an instance of Encoder[]");return e.forEach((e=>{this.writeBufferInternal(e.buffer)})),this}writeBuffer(e){if(!Buffer.isBuffer(e))throw new Error("value should be an instance of Buffer");return this.writeBufferInternal(e),this}writeNullableArray(e,t){const r=0!==e.length?e.length:-1;return this.writeArray(e,t,r),this}writeArray(e,t,r){const o=null==r?e.length:r;if(this.writeInt32(o),void 0!==t)switch(t){case"int32":case"number":e.forEach((e=>this.writeInt32(e)));break;case"string":e.forEach((e=>this.writeString(e)));break;case"object":this.writeEncoderArray(e)}else e.forEach((e=>{switch(typeof e){case"number":this.writeInt32(e);break;case"string":this.writeString(e);break;case"object":this.writeEncoder(e)}}));return this}writeVarIntArray(e,t){if("object"===t)this.writeVarInt(e.length),this.writeEncoderArray(e);else{const t=e.filter((e=>"object"==typeof e));this.writeVarInt(t.length),this.writeEncoderArray(t)}return this}writeUVarIntArray(e,t){if("object"===t)this.writeUVarInt(e.length+1),this.writeEncoderArray(e);else{const t=e.filter((e=>"object"==typeof e));this.writeUVarInt(t.length+1),this.writeEncoderArray(t)}return this}writeVarInt(t){return this.writeUVarInt(e.encodeZigZag(t))}writeUVarInt(e){const t=[];for(;0!=(e&s);)t.push(127&e|128),e>>>=7;return t.push(127&e),this.writeBufferInternal(Buffer.from(t)),this}writeVarLong(t){const r=[];let s=e.encodeZigZag64(t);for(;s.and(i).notEquals(o.fromInt(0));)r.push(s.and(127).or(128).toInt()),s=s.shiftRightUnsigned(7);return r.push(s.toInt()),this.writeBufferInternal(Buffer.from(r)),this}size(){return this.offset}toJSON(){return this.buffer.toJSON()}}},21701:(e,t,r)=>{const{KafkaJSProtocolError:o}=r(29879),s=r(6779),i=[{type:"UNKNOWN",code:-1,retriable:!1,message:"The server experienced an unexpected error when processing the request"},{type:"OFFSET_OUT_OF_RANGE",code:1,retriable:!1,message:"The requested offset is not within the range of offsets maintained by the server"},{type:"CORRUPT_MESSAGE",code:2,retriable:!0,message:"This message has failed its CRC checksum, exceeds the valid size, or is otherwise corrupt"},{type:"UNKNOWN_TOPIC_OR_PARTITION",code:3,retriable:!0,message:"This server does not host this topic-partition"},{type:"INVALID_FETCH_SIZE",code:4,retriable:!1,message:"The requested fetch size is invalid"},{type:"LEADER_NOT_AVAILABLE",code:5,retriable:!0,message:"There is no leader for this topic-partition as we are in the middle of a leadership election"},{type:"NOT_LEADER_FOR_PARTITION",code:6,retriable:!0,message:"This server is not the leader for that topic-partition"},{type:"REQUEST_TIMED_OUT",code:7,retriable:!0,message:"The request timed out"},{type:"BROKER_NOT_AVAILABLE",code:8,retriable:!1,message:"The broker is not available"},{type:"REPLICA_NOT_AVAILABLE",code:9,retriable:!1,message:"The replica is not available for the requested topic-partition"},{type:"MESSAGE_TOO_LARGE",code:10,retriable:!1,message:"The request included a message larger than the max message size the server will accept"},{type:"STALE_CONTROLLER_EPOCH",code:11,retriable:!1,message:"The controller moved to another broker"},{type:"OFFSET_METADATA_TOO_LARGE",code:12,retriable:!1,message:"The metadata field of the offset request was too large"},{type:"NETWORK_EXCEPTION",code:13,retriable:!0,message:"The server disconnected before a response was received"},{type:"GROUP_LOAD_IN_PROGRESS",code:14,retriable:!0,message:"The coordinator is loading and hence can't process requests for this group"},{type:"GROUP_COORDINATOR_NOT_AVAILABLE",code:15,retriable:!0,message:"The group coordinator is not available"},{type:"NOT_COORDINATOR_FOR_GROUP",code:16,retriable:!0,message:"This is not the correct coordinator for this group"},{type:"INVALID_TOPIC_EXCEPTION",code:17,retriable:!1,message:"The request attempted to perform an operation on an invalid topic"},{type:"RECORD_LIST_TOO_LARGE",code:18,retriable:!1,message:"The request included message batch larger than the configured segment size on the server"},{type:"NOT_ENOUGH_REPLICAS",code:19,retriable:!0,message:"Messages are rejected since there are fewer in-sync replicas than required"},{type:"NOT_ENOUGH_REPLICAS_AFTER_APPEND",code:20,retriable:!0,message:"Messages are written to the log, but to fewer in-sync replicas than required"},{type:"INVALID_REQUIRED_ACKS",code:21,retriable:!1,message:"Produce request specified an invalid value for required acks"},{type:"ILLEGAL_GENERATION",code:22,retriable:!1,message:"Specified group generation id is not valid"},{type:"INCONSISTENT_GROUP_PROTOCOL",code:23,retriable:!1,message:"The group member's supported protocols are incompatible with those of existing members"},{type:"INVALID_GROUP_ID",code:24,retriable:!1,message:"The configured groupId is invalid"},{type:"UNKNOWN_MEMBER_ID",code:25,retriable:!1,message:"The coordinator is not aware of this member"},{type:"INVALID_SESSION_TIMEOUT",code:26,retriable:!1,message:"The session timeout is not within the range allowed by the broker (as configured by group.min.session.timeout.ms and group.max.session.timeout.ms)"},{type:"REBALANCE_IN_PROGRESS",code:27,retriable:!1,message:"The group is rebalancing, so a rejoin is needed",helpUrl:s("docs/faq","what-does-it-mean-to-get-rebalance-in-progress-errors")},{type:"INVALID_COMMIT_OFFSET_SIZE",code:28,retriable:!1,message:"The committing offset data size is not valid"},{type:"TOPIC_AUTHORIZATION_FAILED",code:29,retriable:!1,message:"Not authorized to access topics: [Topic authorization failed]"},{type:"GROUP_AUTHORIZATION_FAILED",code:30,retriable:!1,message:"Not authorized to access group: Group authorization failed"},{type:"CLUSTER_AUTHORIZATION_FAILED",code:31,retriable:!1,message:"Cluster authorization failed"},{type:"INVALID_TIMESTAMP",code:32,retriable:!1,message:"The timestamp of the message is out of acceptable range"},{type:"UNSUPPORTED_SASL_MECHANISM",code:33,retriable:!1,message:"The broker does not support the requested SASL mechanism"},{type:"ILLEGAL_SASL_STATE",code:34,retriable:!1,message:"Request is not valid given the current SASL state"},{type:"UNSUPPORTED_VERSION",code:35,retriable:!1,message:"The version of API is not supported"},{type:"TOPIC_ALREADY_EXISTS",code:36,retriable:!1,message:"Topic with this name already exists"},{type:"INVALID_PARTITIONS",code:37,retriable:!1,message:"Number of partitions is invalid"},{type:"INVALID_REPLICATION_FACTOR",code:38,retriable:!1,message:"Replication-factor is invalid"},{type:"INVALID_REPLICA_ASSIGNMENT",code:39,retriable:!1,message:"Replica assignment is invalid"},{type:"INVALID_CONFIG",code:40,retriable:!1,message:"Configuration is invalid"},{type:"NOT_CONTROLLER",code:41,retriable:!0,message:"This is not the correct controller for this cluster"},{type:"INVALID_REQUEST",code:42,retriable:!1,message:"This most likely occurs because of a request being malformed by the client library or the message was sent to an incompatible broker. See the broker logs for more details"},{type:"UNSUPPORTED_FOR_MESSAGE_FORMAT",code:43,retriable:!1,message:"The message format version on the broker does not support the request"},{type:"POLICY_VIOLATION",code:44,retriable:!1,message:"Request parameters do not satisfy the configured policy"},{type:"OUT_OF_ORDER_SEQUENCE_NUMBER",code:45,retriable:!1,message:"The broker received an out of order sequence number"},{type:"DUPLICATE_SEQUENCE_NUMBER",code:46,retriable:!1,message:"The broker received a duplicate sequence number"},{type:"INVALID_PRODUCER_EPOCH",code:47,retriable:!1,message:"Producer attempted an operation with an old epoch. Either there is a newer producer with the same transactionalId, or the producer's transaction has been expired by the broker"},{type:"INVALID_TXN_STATE",code:48,retriable:!1,message:"The producer attempted a transactional operation in an invalid state"},{type:"INVALID_PRODUCER_ID_MAPPING",code:49,retriable:!1,message:"The producer attempted to use a producer id which is not currently assigned to its transactional id"},{type:"INVALID_TRANSACTION_TIMEOUT",code:50,retriable:!1,message:"The transaction timeout is larger than the maximum value allowed by the broker (as configured by max.transaction.timeout.ms)"},{type:"CONCURRENT_TRANSACTIONS",code:51,retriable:!0,message:"The producer attempted to update a transaction while another concurrent operation on the same transaction was ongoing"},{type:"TRANSACTION_COORDINATOR_FENCED",code:52,retriable:!1,message:"Indicates that the transaction coordinator sending a WriteTxnMarker is no longer the current coordinator for a given producer"},{type:"TRANSACTIONAL_ID_AUTHORIZATION_FAILED",code:53,retriable:!1,message:"Transactional Id authorization failed"},{type:"SECURITY_DISABLED",code:54,retriable:!1,message:"Security features are disabled"},{type:"OPERATION_NOT_ATTEMPTED",code:55,retriable:!1,message:"The broker did not attempt to execute this operation. This may happen for batched RPCs where some operations in the batch failed, causing the broker to respond without trying the rest"},{type:"KAFKA_STORAGE_ERROR",code:56,retriable:!0,message:"Disk error when trying to access log file on the disk"},{type:"LOG_DIR_NOT_FOUND",code:57,retriable:!1,message:"The user-specified log directory is not found in the broker config"},{type:"SASL_AUTHENTICATION_FAILED",code:58,retriable:!1,message:"SASL Authentication failed",helpUrl:s("docs/configuration","sasl")},{type:"UNKNOWN_PRODUCER_ID",code:59,retriable:!1,message:"This exception is raised by the broker if it could not locate the producer metadata associated with the producerId in question. This could happen if, for instance, the producer's records were deleted because their retention time had elapsed. Once the last records of the producerId are removed, the producer's metadata is removed from the broker, and future appends by the producer will return this exception"},{type:"REASSIGNMENT_IN_PROGRESS",code:60,retriable:!1,message:"A partition reassignment is in progress"},{type:"DELEGATION_TOKEN_AUTH_DISABLED",code:61,retriable:!1,message:"Delegation Token feature is not enabled"},{type:"DELEGATION_TOKEN_NOT_FOUND",code:62,retriable:!1,message:"Delegation Token is not found on server"},{type:"DELEGATION_TOKEN_OWNER_MISMATCH",code:63,retriable:!1,message:"Specified Principal is not valid Owner/Renewer"},{type:"DELEGATION_TOKEN_REQUEST_NOT_ALLOWED",code:64,retriable:!1,message:"Delegation Token requests are not allowed on PLAINTEXT/1-way SSL channels and on delegation token authenticated channels"},{type:"DELEGATION_TOKEN_AUTHORIZATION_FAILED",code:65,retriable:!1,message:"Delegation Token authorization failed"},{type:"DELEGATION_TOKEN_EXPIRED",code:66,retriable:!1,message:"Delegation Token is expired"},{type:"INVALID_PRINCIPAL_TYPE",code:67,retriable:!1,message:"Supplied principalType is not supported"},{type:"NON_EMPTY_GROUP",code:68,retriable:!1,message:"The group is not empty"},{type:"GROUP_ID_NOT_FOUND",code:69,retriable:!1,message:"The group id was not found"},{type:"FETCH_SESSION_ID_NOT_FOUND",code:70,retriable:!0,message:"The fetch session ID was not found"},{type:"INVALID_FETCH_SESSION_EPOCH",code:71,retriable:!0,message:"The fetch session epoch is invalid"},{type:"LISTENER_NOT_FOUND",code:72,retriable:!0,message:"There is no listener on the leader broker that matches the listener on which metadata request was processed"},{type:"TOPIC_DELETION_DISABLED",code:73,retriable:!1,message:"Topic deletion is disabled"},{type:"FENCED_LEADER_EPOCH",code:74,retriable:!0,message:"The leader epoch in the request is older than the epoch on the broker"},{type:"UNKNOWN_LEADER_EPOCH",code:75,retriable:!0,message:"The leader epoch in the request is newer than the epoch on the broker"},{type:"UNSUPPORTED_COMPRESSION_TYPE",code:76,retriable:!1,message:"The requesting client does not support the compression type of given partition"},{type:"STALE_BROKER_EPOCH",code:77,retriable:!1,message:"Broker epoch has changed"},{type:"OFFSET_NOT_AVAILABLE",code:78,retriable:!0,message:"The leader high watermark has not caught up from a recent leader election so the offsets cannot be guaranteed to be monotonically increasing"},{type:"MEMBER_ID_REQUIRED",code:79,retriable:!1,message:"The group member needs to have a valid member id before actually entering a consumer group"},{type:"PREFERRED_LEADER_NOT_AVAILABLE",code:80,retriable:!0,message:"The preferred leader was not available"},{type:"GROUP_MAX_SIZE_REACHED",code:81,retriable:!1,message:"The consumer group has reached its max size. It already has the configured maximum number of members"},{type:"FENCED_INSTANCE_ID",code:82,retriable:!1,message:"The broker rejected this static consumer since another consumer with the same group instance id has registered with a different member id"},{type:"ELIGIBLE_LEADERS_NOT_AVAILABLE",code:83,retriable:!0,message:"Eligible topic partition leaders are not available"},{type:"ELECTION_NOT_NEEDED",code:84,retriable:!0,message:"Leader election not needed for topic partition"},{type:"NO_REASSIGNMENT_IN_PROGRESS",code:85,retriable:!1,message:"No partition reassignment is in progress"},{type:"GROUP_SUBSCRIBED_TO_TOPIC",code:86,retriable:!1,message:"Deleting offsets of a topic is forbidden while the consumer group is actively subscribed to it"},{type:"INVALID_RECORD",code:87,retriable:!1,message:"This record has failed the validation on broker and hence be rejected"},{type:"UNSTABLE_OFFSET_COMMIT",code:88,retriable:!0,message:"There are unstable offsets that need to be cleared"}],n=e=>new o(i.find((t=>t.code===e))||{type:"KAFKAJS_UNKNOWN_ERROR_CODE",code:-99,retriable:!1,message:`Unknown error code ${e}`});e.exports={failure:e=>0!==e,errorCodes:i,createErrorFromCode:n,failIfVersionNotSupported:e=>{if(35===e)throw n(35)},staleMetadata:e=>["UNKNOWN_TOPIC_OR_PARTITION","LEADER_NOT_AVAILABLE","NOT_LEADER_FOR_PARTITION"].includes(e.type)}},52845:e=>{e.exports={READ_UNCOMMITTED:0,READ_COMMITTED:1}},16332:(e,t,r)=>{const{promisify:o}=r(73837),s=r(59796),i=o(s.gzip),n=o(s.unzip);e.exports={compress:async e=>await i(e.buffer),decompress:async e=>await n(e)}},42972:(e,t,r)=>{const{KafkaJSNotImplemented:o}=r(29879),s={None:0,GZIP:1,Snappy:2,LZ4:3,ZSTD:4},i={[s.GZIP]:()=>r(16332),[s.Snappy]:()=>{throw new o("Snappy compression not implemented")},[s.LZ4]:()=>{throw new o("LZ4 compression not implemented")},[s.ZSTD]:()=>{throw new o("ZSTD compression not implemented")}};e.exports={Types:s,Codecs:i,lookupCodec:e=>i[e]?i[e]():null,lookupCodecByAttributes:e=>{const t=i[7&e];return t?t():null},COMPRESSION_CODEC_MASK:7}},82691:(e,t,r)=>{const{KafkaJSPartialMessageError:o,KafkaJSUnsupportedMagicByteInMessageSet:s}=r(29879),i=r(72650),n=r(72801);e.exports=(e,t,r)=>{const a=Buffer.byteLength(r.slice(t).buffer);if(a<t)throw new o(`Tried to decode a partial message: remainingBytes(${a}) < messageSize(${t})`);const c=r.readInt32(),p=r.readInt8(),d=((e,t)=>{switch(t){case 0:return i(e);case 1:return n(e);default:throw new s(`Unsupported MessageSet message version, magic byte: ${t}`)}})(r,p);return Object.assign({offset:e,size:t,crc:c,magicByte:p},d)}},56615:(e,t,r)=>{const o={0:r(3154),1:r(86740)};e.exports=({version:e=0})=>o[e]},72650:e=>{e.exports=e=>({attributes:e.readInt8(),key:e.readBytes(),value:e.readBytes()})},3154:(e,t,r)=>{const o=r(28783),s=r(21574),{Types:i,COMPRESSION_CODEC_MASK:n}=r(42972);e.exports=({compression:e=i.None,key:t,value:r})=>{const a=(new o).writeInt8(0).writeInt8(e&n).writeBytes(t).writeBytes(r),c=s(a);return(new o).writeInt32(c).writeEncoder(a)}},72801:e=>{e.exports=e=>({attributes:e.readInt8(),timestamp:e.readInt64().toString(),key:e.readBytes(),value:e.readBytes()})},86740:(e,t,r)=>{const o=r(28783),s=r(21574),{Types:i,COMPRESSION_CODEC_MASK:n}=r(42972);e.exports=({compression:e=i.None,timestamp:t=Date.now(),key:r,value:a})=>{const c=(new o).writeInt8(1).writeInt8(e&n).writeInt64(t).writeBytes(r).writeBytes(a),p=s(c);return(new o).writeInt32(p).writeEncoder(c)}},44321:(e,t,r)=>{const o=r(73278),s=r(56341),i=r(82691),{lookupCodecByAttributes:n}=r(42972),{KafkaJSPartialMessageError:a}=r(29879);e.exports=async(e,t=null)=>{const r=[],o=t||e.readInt32(),i=e.slice(o);for(;i.offset<o;)try{const e=p(i),t=n(e.attributes);if(t){const o=await t.decompress(e.value);r.push(...c(new s(o),e))}else r.push(e)}catch(e){if("KafkaJSPartialMessageError"===e.name)break;if("KafkaJSUnsupportedMagicByteInMessageSet"===e.name)break;throw e}return e.forward(o),r};const c=(e,t)=>{const r=[];for(;e.offset<e.buffer.length;)r.push(p(e));if(t.magicByte>0&&t.offset>=0){const e=o.fromValue(t.offset)-o.fromValue(r[r.length-1].offset);for(const t of r)t.offset=o.fromValue(t.offset).add(e).toString()}return r},p=e=>{if(!e.canReadInt64())throw new a("Tried to decode a partial message: There isn't enough bytes to read the offset");const t=e.readInt64().toString();if(!e.canReadInt32())throw new a("Tried to decode a partial message: There isn't enough bytes to read the message size");const r=e.readInt32();return i(t,r,e)}},42032:(e,t,r)=>{const o=r(28783),s=r(56615),{Types:i}=r(42972);e.exports=({messageVersion:e=0,compression:t,entries:r})=>{const n=t!==i.None,a=s({version:e}),c=new o;return r.forEach(((e,t)=>{const r=a(e);c.writeInt64(n?t:-1),c.writeInt32(r.size()),c.writeEncoder(r)})),c}},46911:e=>{e.exports=e=>{let r=-1;for(let o=0;o<e.length;o++)r=t[255&(r^e[o])]^r>>>8;return(-1^r)>>>0};var t=new Int32Array([0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697])},83398:(e,t,r)=>{const o=r(46911);e.exports=e=>{return t=o(e),Uint32Array.from([t])[0];var t}},37778:e=>{e.exports=e=>({key:e.readVarIntString(),value:e.readVarIntBytes()})},39537:(e,t,r)=>{const o=r(28783);e.exports=({key:e,value:t})=>(new o).writeVarIntString(e).writeVarIntBytes(t)},21240:(e,t,r)=>{const o=r(73278),s=r(37778),i=r(62515);e.exports=(e,t={})=>{const{firstOffset:r,firstTimestamp:n,magicByte:a,isControlBatch:c=!1,timestampType:p,maxTimestamp:d}=t,u=e.readInt8(),l=e.readVarLong(),h=p===i.LOG_APPEND_TIME&&d?d:o.fromValue(n).add(l).toString(),m=e.readVarInt(),f=o.fromValue(r).add(m).toString(),g=e.readVarIntBytes(),I=e.readVarIntBytes(),y=e.readVarIntArray(s).reduce(((e,{key:t,value:r})=>({...e,[t]:r})),{});return{magicByte:a,attributes:u,timestamp:h,offset:f,key:g,value:I,headers:y,isControlRecord:c,batchContext:t}}},16575:(e,t,r)=>{const o=r(28783),s=r(39537);e.exports=({offsetDelta:e=0,timestampDelta:t=0,key:r,value:n,headers:a={}})=>{const c=Object.keys(a).map((e=>({key:e,value:a[e]}))),p=1+o.sizeOfVarLong(t)+o.sizeOfVarInt(e)+o.sizeOfVarIntBytes(r)+o.sizeOfVarIntBytes(n)+i(c);return(new o).writeVarInt(p).writeInt8(0).writeVarLong(t).writeVarInt(e).writeVarIntBytes(r).writeVarIntBytes(n).writeVarIntArray(c.map(s))};const i=e=>{let t=o.sizeOfVarInt(e.length);for(const r of e){const e=Buffer.byteLength(r.key),s=Buffer.byteLength(r.value);t+=o.sizeOfVarInt(e)+e,null===r.value?t+=o.sizeOfVarInt(-1):t+=o.sizeOfVarInt(s)+s}return t}},43294:(e,t,r)=>{const o=r(56341),{KafkaJSPartialMessageError:s}=r(29879),{lookupCodecByAttributes:i}=r(42972),n=r(21240),a=r(62515);e.exports=async e=>{const t=e.readInt64().toString(),r=e.readInt32(),o=e.slice(r);e.forward(r);const n=Buffer.byteLength(o.buffer);if(n<r)throw new s(`Tried to decode a partial record batch: remainingBytes(${n}) < recordBatchLength(${r})`);const p=o.readInt32(),d=o.readInt8(),u=(o.readInt32(),o.readInt16()),l=o.readInt32(),h=o.readInt64().toString(),m=o.readInt64().toString(),f=o.readInt64().toString(),g=o.readInt16(),I=o.readInt32(),y=(16&u)>0,w=(32&u)>0,T=(8&u)>0?a.LOG_APPEND_TIME:a.CREATE_TIME,E=i(u),b={firstOffset:t,firstTimestamp:h,partitionLeaderEpoch:p,inTransaction:y,isControlBatch:w,lastOffsetDelta:l,producerId:f,producerEpoch:g,firstSequence:I,maxTimestamp:m,timestampType:T},S=await c(E,o,{...b,magicByte:d});return{...b,records:S}};const c=async(e,t,r)=>{if(!e)return t.readArray((e=>p(e,r)));const s=t.readInt32();if(s<=0)return[];const i=t.readAll(),n=await e.decompress(i),a=new o(n),c=new Array(s);for(let e=0;e<s;e++)c[e]=p(a,r);return c},p=(e,t)=>{const r=e.readVarIntBytes();return n(new o(r),t)}},72872:(e,t,r)=>{const o=r(73278),s=r(28783),i=r(83398),{Types:n,lookupCodec:a,COMPRESSION_CODEC_MASK:c}=r(42972);e.exports={RecordBatch:async({compression:e=n.None,firstOffset:t=o.fromInt(0),firstTimestamp:r=Date.now(),maxTimestamp:p=Date.now(),partitionLeaderEpoch:d=0,lastOffsetDelta:u=0,transactional:l=!1,producerId:h=o.fromValue(-1),producerEpoch:m=0,firstSequence:f=0,records:g=[]})=>{const I=0|e&c|(l?16:0),y=(new s).writeInt16(I).writeInt32(u).writeInt64(r).writeInt64(p).writeInt64(h).writeInt16(m).writeInt32(f);if(e===n.None)g.every((e=>typeof e==typeof g[0]))?y.writeArray(g,typeof g[0]):y.writeArray(g);else{const t=await(async(e,t)=>{const r=a(e),o=new s;return o.writeEncoderArray(t),r.compress(o)})(e,g);y.writeInt32(g.length).writeBuffer(t)}const w=(new s).writeInt32(d).writeInt8(2).writeUInt32(i(y.buffer)).writeEncoder(y);return(new s).writeInt64(t).writeBytes(w.buffer)},MAGIC_BYTE:2}},52882:(e,t,r)=>{const o=r(28783);e.exports=async({correlationId:e,clientId:t,request:{apiKey:r,apiVersion:s,encode:i}})=>{const n=await i(),a=(new o).writeInt16(r).writeInt16(s).writeInt32(e).writeString(t).writeEncoder(n);return(new o).writeInt32(a.size()).writeEncoder(a)}},4530:(e,t,r)=>{const o={0:({transactionalId:e,producerId:t,producerEpoch:o,groupId:s})=>{const i=r(28831),n=r(92374);return{request:i({transactionalId:e,producerId:t,producerEpoch:o,groupId:s}),response:n}},1:({transactionalId:e,producerId:t,producerEpoch:o,groupId:s})=>{const i=r(73347),n=r(62058);return{request:i({transactionalId:e,producerId:t,producerEpoch:o,groupId:s}),response:n}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},28831:(e,t,r)=>{const o=r(28783),{AddOffsetsToTxn:s}=r(99211);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,groupId:i})=>({apiKey:s,apiVersion:0,apiName:"AddOffsetsToTxn",encode:async()=>(new o).writeString(e).writeInt64(t).writeInt16(r).writeString(i)})},92374:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},73347:(e,t,r)=>{const o=r(28831);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,groupId:s})=>Object.assign(o({transactionalId:e,producerId:t,producerEpoch:r,groupId:s}),{apiVersion:1})},62058:(e,t,r)=>{const{parse:o,decode:s}=r(92374);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},73350:(e,t,r)=>{const o={0:({transactionalId:e,producerId:t,producerEpoch:o,topics:s})=>{const i=r(1805),n=r(75256);return{request:i({transactionalId:e,producerId:t,producerEpoch:o,topics:s}),response:n}},1:({transactionalId:e,producerId:t,producerEpoch:o,topics:s})=>{const i=r(37919),n=r(41361);return{request:i({transactionalId:e,producerId:t,producerEpoch:o,topics:s}),response:n}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},1805:(e,t,r)=>{const o=r(28783),{AddPartitionsToTxn:s}=r(99211);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,topics:n})=>({apiKey:s,apiVersion:0,apiName:"AddPartitionsToTxn",encode:async()=>(new o).writeString(e).writeInt64(t).writeInt16(r).writeArray(n.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=e=>(new o).writeInt32(e)},75256:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=async e=>({topic:e.readString(),partitionErrors:await e.readArrayAsync(a)}),a=e=>({partition:e.readInt32(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),errors:await t.readArrayAsync(n)}},parse:async e=>{const t=e.errors.map((({partitionErrors:e})=>({partitionsWithErrors:e.filter((({errorCode:e})=>s(e)))}))).filter((({partitionsWithErrors:e})=>e.length));if(t.length>0)throw i(t[0].partitionsWithErrors[0].errorCode);return e}}},37919:(e,t,r)=>{const o=r(1805);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,topics:s})=>Object.assign(o({transactionalId:e,producerId:t,producerEpoch:r,topics:s}),{apiVersion:1})},41361:(e,t,r)=>{const{parse:o,decode:s}=r(75256);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},31858:(e,t,r)=>{const o={0:({resources:e,validateOnly:t})=>{const o=r(57654),s=r(93829);return{request:o({resources:e,validateOnly:t}),response:s}},1:({resources:e,validateOnly:t})=>{const o=r(54836),s=r(49739);return{request:o({resources:e,validateOnly:t}),response:s}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},57654:(e,t,r)=>{const o=r(28783),{AlterConfigs:s}=r(99211);e.exports=({resources:e,validateOnly:t=!1})=>({apiKey:s,apiVersion:0,apiName:"AlterConfigs",encode:async()=>(new o).writeArray(e.map(i)).writeBoolean(t)});const i=({type:e,name:t,configEntries:r})=>(new o).writeInt8(e).writeString(t).writeArray(r.map(n)),n=({name:e,value:t})=>(new o).writeString(e).writeString(t)},93829:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),resources:t.readArray(n)}},parse:async e=>{const t=e.resources.filter((({errorCode:e})=>s(e)));if(t.length>0)throw i(t[0].errorCode);return e}}},54836:(e,t,r)=>{const o=r(57654);e.exports=({resources:e,validateOnly:t})=>Object.assign(o({resources:e,validateOnly:t}),{apiVersion:1})},49739:(e,t,r)=>{const{parse:o,decode:s}=r(93829);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},99211:e=>{e.exports={Produce:0,Fetch:1,ListOffsets:2,Metadata:3,LeaderAndIsr:4,StopReplica:5,UpdateMetadata:6,ControlledShutdown:7,OffsetCommit:8,OffsetFetch:9,GroupCoordinator:10,JoinGroup:11,Heartbeat:12,LeaveGroup:13,SyncGroup:14,DescribeGroups:15,ListGroups:16,SaslHandshake:17,ApiVersions:18,CreateTopics:19,DeleteTopics:20,DeleteRecords:21,InitProducerId:22,OffsetForLeaderEpoch:23,AddPartitionsToTxn:24,AddOffsetsToTxn:25,EndTxn:26,WriteTxnMarkers:27,TxnOffsetCommit:28,DescribeAcls:29,CreateAcls:30,DeleteAcls:31,DescribeConfigs:32,AlterConfigs:33,AlterReplicaLogDirs:34,DescribeLogDirs:35,SaslAuthenticate:36,CreatePartitions:37,CreateDelegationToken:38,RenewDelegationToken:39,ExpireDelegationToken:40,DescribeDelegationToken:41,DeleteGroups:42,ElectPreferredLeaders:43}},67020:(e,t,r)=>{const o={0:()=>{const e=r(20092),t=r(62839);return{request:e(),response:t,logResponseError:!0}},1:()=>{const e=r(14778),t=r(64313);return{request:e(),response:t,logResponseError:!1}},2:()=>{const e=r(94125),t=r(43267);return{request:e(),response:t,logResponseError:!1}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},20092:(e,t,r)=>{const o=r(28783),{ApiVersions:s}=r(99211);e.exports=()=>({apiKey:s,apiVersion:0,apiName:"ApiVersions",encode:async()=>new o})},62839:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701),a=e=>({apiKey:e.readInt16(),minVersion:e.readInt16(),maxVersion:e.readInt16()});e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return n(r),{errorCode:r,apiVersions:t.readArray(a)}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},14778:(e,t,r)=>{const o=r(20092);e.exports=()=>({...o(),apiVersion:1})},64313:(e,t,r)=>{const o=r(56341),{failIfVersionNotSupported:s}=r(21701),{parse:i}=r(62839),n=e=>({apiKey:e.readInt16(),minVersion:e.readInt16(),maxVersion:e.readInt16()});e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return s(r),{errorCode:r,apiVersions:t.readArray(n),throttleTime:t.canReadInt32()?t.readInt32():0}},parse:i}},94125:(e,t,r)=>{const o=r(20092);e.exports=()=>({...o(),apiVersion:2})},43267:(e,t,r)=>{const{parse:o,decode:s}=r(64313);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},64950:(e,t,r)=>{const o={0:({creations:e})=>{const t=r(92073),o=r(98650);return{request:t({creations:e}),response:o}},1:({creations:e})=>{const t=r(60160),o=r(11274);return{request:t({creations:e}),response:o}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},92073:(e,t,r)=>{const o=r(28783),{CreateAcls:s}=r(99211),i=({resourceType:e,resourceName:t,principal:r,host:s,operation:i,permissionType:n})=>(new o).writeInt8(e).writeString(t).writeString(r).writeString(s).writeInt8(i).writeInt8(n);e.exports=({creations:e})=>({apiKey:s,apiVersion:0,apiName:"CreateAcls",encode:async()=>(new o).writeArray(e.map(i))})},98650:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),creationResponses:t.readArray(n)}},parse:async e=>{const t=e.creationResponses.filter((({errorCode:e})=>s(e)));if(t.length>0)throw i(t[0].errorCode);return e}}},60160:(e,t,r)=>{const o=r(28783),{CreateAcls:s}=r(99211),i=({resourceType:e,resourceName:t,resourcePatternType:r,principal:s,host:i,operation:n,permissionType:a})=>(new o).writeInt8(e).writeString(t).writeInt8(r).writeString(s).writeString(i).writeInt8(n).writeInt8(a);e.exports=({creations:e})=>({apiKey:s,apiVersion:1,apiName:"CreateAcls",encode:async()=>(new o).writeArray(e.map(i))})},11274:(e,t,r)=>{const{parse:o,decode:s}=r(98650);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},14842:(e,t,r)=>{const o={0:({topicPartitions:e,timeout:t,validateOnly:o})=>{const s=r(53272),i=r(31451);return{request:s({topicPartitions:e,timeout:t,validateOnly:o}),response:i}},1:({topicPartitions:e,validateOnly:t,timeout:o})=>{const s=r(72620),i=r(71932);return{request:s({topicPartitions:e,validateOnly:t,timeout:o}),response:i}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},53272:(e,t,r)=>{const o=r(28783),{CreatePartitions:s}=r(99211);e.exports=({topicPartitions:e,validateOnly:t=!1,timeout:r=5e3})=>({apiKey:s,apiVersion:0,apiName:"CreatePartitions",encode:async()=>(new o).writeArray(e.map(i)).writeInt32(r).writeBoolean(t)});const i=({topic:e,count:t,assignments:r=[]})=>(new o).writeString(e).writeInt32(t).writeNullableArray(r.map(n)),n=e=>(new o).writeNullableArray(e)},31451:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=(e,t)=>e.topic.localeCompare(t.topic),a=e=>({topic:e.readString(),errorCode:e.readInt16(),errorMessage:e.readString()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),topicErrors:t.readArray(a).sort(n)}},parse:async e=>{const t=e.topicErrors.filter((({errorCode:e})=>s(e)));if(t.length>0)throw i(t[0].errorCode);return e}}},72620:(e,t,r)=>{const o=r(53272);e.exports=({topicPartitions:e,validateOnly:t,timeout:r})=>Object.assign(o({topicPartitions:e,validateOnly:t,timeout:r}),{apiVersion:1})},71932:(e,t,r)=>{const{parse:o,decode:s}=r(31451);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},42346:(e,t,r)=>{const o={0:({topics:e,timeout:t})=>{const o=r(69752),s=r(74108);return{request:o({topics:e,timeout:t}),response:s}},1:({topics:e,validateOnly:t,timeout:o})=>{const s=r(54098),i=r(38053);return{request:s({topics:e,validateOnly:t,timeout:o}),response:i}},2:({topics:e,validateOnly:t,timeout:o})=>{const s=r(55669),i=r(79695);return{request:s({topics:e,validateOnly:t,timeout:o}),response:i}},3:({topics:e,validateOnly:t,timeout:o})=>{const s=r(24208),i=r(9264);return{request:s({topics:e,validateOnly:t,timeout:o}),response:i}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},69752:(e,t,r)=>{const o=r(28783),{CreateTopics:s}=r(99211);e.exports=({topics:e,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"CreateTopics",encode:async()=>(new o).writeArray(e.map(i)).writeInt32(t)});const i=({topic:e,numPartitions:t=1,replicationFactor:r=1,replicaAssignment:s=[],configEntries:i=[]})=>(new o).writeString(e).writeInt32(t).writeInt16(r).writeArray(s.map(n)).writeArray(i.map(a)),n=({partition:e,replicas:t})=>(new o).writeInt32(e).writeArray(t),a=({name:e,value:t})=>(new o).writeString(e).writeString(t)},74108:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),{KafkaJSAggregateError:n,KafkaJSCreateTopicError:a}=r(29879),c=(e,t)=>e.topic.localeCompare(t.topic),p=e=>({topic:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>({topicErrors:new o(e).readArray(p).sort(c)}),parse:async e=>{const t=e.topicErrors.filter((({errorCode:e})=>s(e)));if(t.length>0)throw new n("Topic creation errors",t.map((e=>new a(i(e.errorCode),e.topic))));return e}}},54098:(e,t,r)=>{const o=r(28783),{CreateTopics:s}=r(99211);e.exports=({topics:e,validateOnly:t=!1,timeout:r=5e3})=>({apiKey:s,apiVersion:1,apiName:"CreateTopics",encode:async()=>(new o).writeArray(e.map(i)).writeInt32(r).writeBoolean(t)});const i=({topic:e,numPartitions:t=1,replicationFactor:r=1,replicaAssignment:s=[],configEntries:i=[]})=>(new o).writeString(e).writeInt32(t).writeInt16(r).writeArray(s.map(n)).writeArray(i.map(a)),n=({partition:e,replicas:t})=>(new o).writeInt32(e).writeArray(t),a=({name:e,value:t})=>(new o).writeString(e).writeString(t)},38053:(e,t,r)=>{const o=r(56341),{parse:s}=r(74108),i=(e,t)=>e.topic.localeCompare(t.topic),n=e=>({topic:e.readString(),errorCode:e.readInt16(),errorMessage:e.readString()});e.exports={decode:async e=>({topicErrors:new o(e).readArray(n).sort(i)}),parse:s}},55669:(e,t,r)=>{const o=r(54098);e.exports=({topics:e,validateOnly:t,timeout:r})=>Object.assign(o({topics:e,validateOnly:t,timeout:r}),{apiVersion:2})},79695:(e,t,r)=>{const o=r(56341),{parse:s}=r(38053),i=(e,t)=>e.topic.localeCompare(t.topic),n=e=>({topic:e.readString(),errorCode:e.readInt16(),errorMessage:e.readString()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),topicErrors:t.readArray(n).sort(i)}},parse:s}},24208:(e,t,r)=>{const o=r(55669);e.exports=({topics:e,validateOnly:t,timeout:r})=>Object.assign(o({topics:e,validateOnly:t,timeout:r}),{apiVersion:3})},9264:(e,t,r)=>{const{parse:o,decode:s}=r(79695);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},11491:(e,t,r)=>{const o={0:({filters:e})=>{const t=r(96054),o=r(56061);return{request:t({filters:e}),response:o}},1:({filters:e})=>{const t=r(52349),o=r(41765);return{request:t({filters:e}),response:o}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},96054:(e,t,r)=>{const o=r(28783),{DeleteAcls:s}=r(99211),i=({resourceType:e,resourceName:t,principal:r,host:s,operation:i,permissionType:n})=>(new o).writeInt8(e).writeString(t).writeString(r).writeString(s).writeInt8(i).writeInt8(n);e.exports=({filters:e})=>({apiKey:s,apiVersion:0,apiName:"DeleteAcls",encode:async()=>(new o).writeArray(e.map(i))})},56061:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString(),principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),a=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),matchingAcls:e.readArray(n)});e.exports={decodeMatchingAcls:n,decodeFilterResponse:a,decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),filterResponses:t.readArray(a)}},parse:async e=>{const t=e.filterResponses.filter((({errorCode:e})=>s(e)));if(t.length>0)throw i(t[0].errorCode);for(const t of e.filterResponses){const e=t.matchingAcls.filter((({errorCode:e})=>s(e)));if(e.length>0)throw i(e[0].errorCode)}return e}}},52349:(e,t,r)=>{const o=r(28783),{DeleteAcls:s}=r(99211),i=({resourceType:e,resourceName:t,resourcePatternType:r,principal:s,host:i,operation:n,permissionType:a})=>(new o).writeInt8(e).writeString(t).writeInt8(r).writeString(s).writeString(i).writeInt8(n).writeInt8(a);e.exports=({filters:e})=>({apiKey:s,apiVersion:1,apiName:"DeleteAcls",encode:async()=>(new o).writeArray(e.map(i))})},41765:(e,t,r)=>{const o=r(56341),{parse:s}=r(56061),i=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString(),resourcePatternType:e.readInt8(),principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),n=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),matchingAcls:e.readArray(i)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:0,clientSideThrottleTime:t.readInt32(),filterResponses:t.readArray(n)}},parse:s}},62086:(e,t,r)=>{const o={0:e=>{const t=r(91254),o=r(95276);return{request:t(e),response:o}},1:e=>{const t=r(47967),o=r(74782);return{request:t(e),response:o}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},91254:(e,t,r)=>{const o=r(28783),{DeleteGroups:s}=r(99211);e.exports=e=>({apiKey:s,apiVersion:0,apiName:"DeleteGroups",encode:async()=>(new o).writeArray(e.map(i))});const i=e=>(new o).writeString(e)},95276:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=e=>({groupId:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),a=t.readArray(n);for(const e of a)s(e.errorCode)&&(e.error=i(e.errorCode));return{throttleTimeMs:r,results:a}},parse:async e=>e}},47967:(e,t,r)=>{const o=r(91254);e.exports=e=>Object.assign(o(e),{apiVersion:1})},74782:(e,t,r)=>{const{parse:o,decode:s}=r(95276);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},28035:(e,t,r)=>{const o={0:({topics:e,timeout:t})=>{const o=r(92970),s=r(89645);return{request:o({topics:e,timeout:t}),response:s({topics:e})}},1:({topics:e,timeout:t})=>{const o=r(38993),s=r(2328);return{request:o({topics:e,timeout:t}),response:s({topics:e})}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},92970:(e,t,r)=>{const o=r(28783),{DeleteRecords:s}=r(99211);e.exports=({topics:e,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"DeleteRecords",encode:async()=>(new o).writeArray(e.map((({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map((({partition:e,offset:t})=>(new o).writeInt32(e).writeInt64(t))))))).writeInt32(t)})},89645:(e,t,r)=>{const o=r(56341),{KafkaJSDeleteTopicRecordsError:s}=r(29879),{failure:i,createErrorFromCode:n}=r(21701),a=(e,t)=>e.topic.localeCompare(t.topic),c=async e=>{const t=new o(e);return{throttleTime:t.readInt32(),topics:t.readArray((e=>({topic:e.readString(),partitions:e.readArray((e=>({partition:e.readInt32(),lowWatermark:e.readInt64(),errorCode:e.readInt16()})))}))).sort(a)}};e.exports=({topics:e})=>{return{decode:c,parse:(t=e,async e=>{const r=e.topics.map((({partitions:e})=>({partitionsWithErrors:e.filter((({errorCode:e})=>i(e)))}))).filter((({partitionsWithErrors:e})=>e.length));if(r.length>0){const[{topic:o}]=e.topics,[{partitions:i}]=t,[{partitionsWithErrors:a}]=r;throw new s({topic:o,partitions:a.map((({partition:e,errorCode:t})=>({partition:e,error:n(t),offset:i.find((t=>t.partition===e)).offset})))})}return e})};var t}},38993:(e,t,r)=>{const o=r(92970);e.exports=({topics:e,timeout:t})=>Object.assign(o({topics:e,timeout:t}),{apiVersion:1})},2328:(e,t,r)=>{const o=r(89645);e.exports=({topics:e})=>{const{parse:t,decode:r}=o({topics:e});return{decode:async e=>{const t=await r(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:t}}},29038:(e,t,r)=>{const o={0:({topics:e,timeout:t})=>{const o=r(44255),s=r(88534);return{request:o({topics:e,timeout:t}),response:s}},1:({topics:e,timeout:t})=>{const o=r(57827),s=r(27530);return{request:o({topics:e,timeout:t}),response:s}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},44255:(e,t,r)=>{const o=r(28783),{DeleteTopics:s}=r(99211);e.exports=({topics:e,timeout:t=5e3})=>({apiKey:s,apiVersion:0,apiName:"DeleteTopics",encode:async()=>(new o).writeArray(e).writeInt32(t)})},88534:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=(e,t)=>e.topic.localeCompare(t.topic),a=e=>({topic:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>({topicErrors:new o(e).readArray(a).sort(n)}),parse:async e=>{const t=e.topicErrors.filter((({errorCode:e})=>s(e)));if(t.length>0)throw i(t[0].errorCode);return e}}},57827:(e,t,r)=>{const o=r(44255);e.exports=({topics:e,timeout:t})=>Object.assign(o({topics:e,timeout:t}),{apiVersion:1})},27530:(e,t,r)=>{const o=r(56341),{parse:s}=r(88534),i=(e,t)=>e.topic.localeCompare(t.topic),n=e=>({topic:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:0,clientSideThrottleTime:t.readInt32(),topicErrors:t.readArray(n).sort(i)}},parse:s}},45665:(e,t,r)=>{const o={0:({resourceType:e,resourceName:t,principal:o,host:s,operation:i,permissionType:n})=>{const a=r(81106),c=r(22590);return{request:a({resourceType:e,resourceName:t,principal:o,host:s,operation:i,permissionType:n}),response:c}},1:({resourceType:e,resourceName:t,resourcePatternType:o,principal:s,host:i,operation:n,permissionType:a})=>{const c=r(7696),p=r(47952);return{request:c({resourceType:e,resourceName:t,resourcePatternType:o,principal:s,host:i,operation:n,permissionType:a}),response:p}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},81106:(e,t,r)=>{const o=r(28783),{DescribeAcls:s}=r(99211);e.exports=({resourceType:e,resourceName:t,principal:r,host:i,operation:n,permissionType:a})=>({apiKey:s,apiVersion:0,apiName:"DescribeAcls",encode:async()=>(new o).writeInt8(e).writeString(t).writeString(r).writeString(i).writeInt8(n).writeInt8(a)})},22590:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=e=>({principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),a=e=>({resourceType:e.readInt8(),resourceName:e.readString(),acls:e.readArray(n)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),errorCode:t.readInt16(),errorMessage:t.readString(),resources:t.readArray(a)}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},7696:(e,t,r)=>{const o=r(28783),{DescribeAcls:s}=r(99211);e.exports=({resourceType:e,resourceName:t,resourcePatternType:r,principal:i,host:n,operation:a,permissionType:c})=>({apiKey:s,apiVersion:1,apiName:"DescribeAcls",encode:async()=>(new o).writeInt8(e).writeString(t).writeInt8(r).writeString(i).writeString(n).writeInt8(a).writeInt8(c)})},47952:(e,t,r)=>{const{parse:o}=r(22590),s=r(56341),i=e=>({principal:e.readString(),host:e.readString(),operation:e.readInt8(),permissionType:e.readInt8()}),n=e=>({resourceType:e.readInt8(),resourceName:e.readString(),resourcePatternType:e.readInt8(),acls:e.readArray(i)});e.exports={decode:async e=>{const t=new s(e);return{throttleTime:0,clientSideThrottleTime:t.readInt32(),errorCode:t.readInt16(),errorMessage:t.readString(),resources:t.readArray(n)}},parse:o}},26450:(e,t,r)=>{const o={0:({resources:e})=>{const t=r(77511),o=r(73707);return{request:t({resources:e}),response:o}},1:({resources:e,includeSynonyms:t})=>{const o=r(94017),s=r(71636);return{request:o({resources:e,includeSynonyms:t}),response:s}},2:({resources:e,includeSynonyms:t})=>{const o=r(60942),s=r(84410);return{request:o({resources:e,includeSynonyms:t}),response:s}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},77511:(e,t,r)=>{const o=r(28783),{DescribeConfigs:s}=r(99211);e.exports=({resources:e})=>({apiKey:s,apiVersion:0,apiName:"DescribeConfigs",encode:async()=>(new o).writeArray(e.map(i))});const i=({type:e,name:t,configNames:r=[]})=>(new o).writeInt8(e).writeString(t).writeNullableArray(r)},73707:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(9955),a=r(18279),c=e=>{const t=e.readInt16(),r=e.readString(),o=e.readInt8(),s=e.readString(),i=e.readArray((e=>((e,t)=>{const r=e.readString(),o=e.readString(),s=e.readBoolean(),i=e.readBoolean(),c=e.readBoolean();let p;if(i)p=n.DEFAULT_CONFIG;else switch(t){case a.BROKER:p=n.STATIC_BROKER_CONFIG;break;case a.TOPIC:p=n.TOPIC_CONFIG;break;default:p=n.UNKNOWN}return{configName:r,configValue:o,readOnly:s,isDefault:i,configSource:p,isSensitive:c}})(e,o)));return{errorCode:t,errorMessage:r,resourceType:o,resourceName:s,configEntries:i}};e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),resources:t.readArray(c)}},parse:async e=>{const t=e.resources.filter((({errorCode:e})=>s(e)));if(t.length>0)throw i(t[0].errorCode);return e}}},94017:(e,t,r)=>{const o=r(28783),{DescribeConfigs:s}=r(99211);e.exports=({resources:e,includeSynonyms:t=!1})=>({apiKey:s,apiVersion:1,apiName:"DescribeConfigs",encode:async()=>(new o).writeArray(e.map(i)).writeBoolean(t)});const i=({type:e,name:t,configNames:r=[]})=>(new o).writeInt8(e).writeString(t).writeNullableArray(r)},71636:(e,t,r)=>{const o=r(56341),{parse:s}=r(73707),{DEFAULT_CONFIG:i}=r(9955),n=e=>({configName:e.readString(),configValue:e.readString(),configSource:e.readInt8()}),a=e=>{const t=e.readString(),r=e.readString(),o=e.readBoolean(),s=e.readInt8(),a=e.readBoolean(),c=e.readArray(n);return{configName:t,configValue:r,readOnly:o,isDefault:s===i,configSource:s,isSensitive:a,configSynonyms:c}},c=e=>({errorCode:e.readInt16(),errorMessage:e.readString(),resourceType:e.readInt8(),resourceName:e.readString(),configEntries:e.readArray(a)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),resources:t.readArray(c)}},parse:s}},60942:(e,t,r)=>{const o=r(94017);e.exports=({resources:e,includeSynonyms:t})=>Object.assign(o({resources:e,includeSynonyms:t}),{apiVersion:2})},84410:(e,t,r)=>{const{parse:o,decode:s}=r(71636);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},57927:(e,t,r)=>{const o={0:({groupIds:e})=>{const t=r(42228),o=r(53251);return{request:t({groupIds:e}),response:o}},1:({groupIds:e})=>{const t=r(86106),o=r(84332);return{request:t({groupIds:e}),response:o}},2:({groupIds:e})=>{const t=r(94106),o=r(85902);return{request:t({groupIds:e}),response:o}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},42228:(e,t,r)=>{const o=r(28783),{DescribeGroups:s}=r(99211);e.exports=({groupIds:e})=>({apiKey:s,apiVersion:0,apiName:"DescribeGroups",encode:async()=>(new o).writeArray(e)})},53251:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=e=>({memberId:e.readString(),clientId:e.readString(),clientHost:e.readString(),memberMetadata:e.readBytes(),memberAssignment:e.readBytes()}),a=e=>({errorCode:e.readInt16(),groupId:e.readString(),state:e.readString(),protocolType:e.readString(),protocol:e.readString(),members:e.readArray(n)});e.exports={decode:async e=>({groups:new o(e).readArray(a)}),parse:async e=>{const t=e.groups.filter((({errorCode:e})=>s(e)));if(t.length>0)throw i(t[0].errorCode);return e}}},86106:(e,t,r)=>{const o=r(42228);e.exports=({groupIds:e})=>Object.assign(o({groupIds:e}),{apiVersion:1})},84332:(e,t,r)=>{const o=r(56341),{parse:s}=r(53251),i=e=>({memberId:e.readString(),clientId:e.readString(),clientHost:e.readString(),memberMetadata:e.readBytes(),memberAssignment:e.readBytes()}),n=e=>({errorCode:e.readInt16(),groupId:e.readString(),state:e.readString(),protocolType:e.readString(),protocol:e.readString(),members:e.readArray(i)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),groups:t.readArray(n)}},parse:s}},94106:(e,t,r)=>{const o=r(86106);e.exports=({groupIds:e})=>Object.assign(o({groupIds:e}),{apiVersion:2})},85902:(e,t,r)=>{const{parse:o,decode:s}=r(84332);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},32059:(e,t,r)=>{const o={0:({transactionalId:e,producerId:t,producerEpoch:o,transactionResult:s})=>{const i=r(87446),n=r(1707);return{request:i({transactionalId:e,producerId:t,producerEpoch:o,transactionResult:s}),response:n}},1:({transactionalId:e,producerId:t,producerEpoch:o,transactionResult:s})=>{const i=r(25306),n=r(54786);return{request:i({transactionalId:e,producerId:t,producerEpoch:o,transactionResult:s}),response:n}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},87446:(e,t,r)=>{const o=r(28783),{EndTxn:s}=r(99211);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:i})=>({apiKey:s,apiVersion:0,apiName:"EndTxn",encode:async()=>(new o).writeString(e).writeInt64(t).writeInt16(r).writeBoolean(i)})},1707:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},25306:(e,t,r)=>{const o=r(87446);e.exports=({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:s})=>Object.assign(o({transactionalId:e,producerId:t,producerEpoch:r,transactionResult:s}),{apiVersion:1})},54786:(e,t,r)=>{const{parse:o,decode:s}=r(1707);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},98681:(e,t,r)=>{const o=r(52845),s=e=>Number.isSafeInteger(e+100)?e+100:e,i={0:({replicaId:e=-1,maxWaitTime:t,minBytes:o,topics:i})=>{const n=r(12818),a=r(43583);return{request:n({replicaId:e,maxWaitTime:t,minBytes:o,topics:i}),response:a,requestTimeout:s(t)}},1:({replicaId:e=-1,maxWaitTime:t,minBytes:o,topics:i})=>{const n=r(48087),a=r(2155);return{request:n({replicaId:e,maxWaitTime:t,minBytes:o,topics:i}),response:a,requestTimeout:s(t)}},2:({replicaId:e=-1,maxWaitTime:t,minBytes:o,topics:i})=>{const n=r(62045),a=r(7628);return{request:n({replicaId:e,maxWaitTime:t,minBytes:o,topics:i}),response:a,requestTimeout:s(t)}},3:({replicaId:e=-1,maxWaitTime:t,minBytes:o,maxBytes:i,topics:n})=>{const a=r(84704),c=r(11828);return{request:a({replicaId:e,maxWaitTime:t,minBytes:o,maxBytes:i,topics:n}),response:c,requestTimeout:s(t)}},4:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,maxWaitTime:i,minBytes:n,maxBytes:a,topics:c})=>{const p=r(97737),d=r(76668);return{request:p({replicaId:e,isolationLevel:t,maxWaitTime:i,minBytes:n,maxBytes:a,topics:c}),response:d,requestTimeout:s(i)}},5:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,maxWaitTime:i,minBytes:n,maxBytes:a,topics:c})=>{const p=r(52881),d=r(19214);return{request:p({replicaId:e,isolationLevel:t,maxWaitTime:i,minBytes:n,maxBytes:a,topics:c}),response:d,requestTimeout:s(i)}},6:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,maxWaitTime:i,minBytes:n,maxBytes:a,topics:c})=>{const p=r(4939),d=r(35646);return{request:p({replicaId:e,isolationLevel:t,maxWaitTime:i,minBytes:n,maxBytes:a,topics:c}),response:d,requestTimeout:s(i)}},7:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,sessionId:i=0,sessionEpoch:n=-1,forgottenTopics:a=[],maxWaitTime:c,minBytes:p,maxBytes:d,topics:u})=>{const l=r(73431),h=r(33456);return{request:l({replicaId:e,isolationLevel:t,sessionId:i,sessionEpoch:n,forgottenTopics:a,maxWaitTime:c,minBytes:p,maxBytes:d,topics:u}),response:h,requestTimeout:s(c)}},8:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,sessionId:i=0,sessionEpoch:n=-1,forgottenTopics:a=[],maxWaitTime:c,minBytes:p,maxBytes:d,topics:u})=>{const l=r(54427),h=r(47004);return{request:l({replicaId:e,isolationLevel:t,sessionId:i,sessionEpoch:n,forgottenTopics:a,maxWaitTime:c,minBytes:p,maxBytes:d,topics:u}),response:h,requestTimeout:s(c)}},9:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,sessionId:i=0,sessionEpoch:n=-1,forgottenTopics:a=[],maxWaitTime:c,minBytes:p,maxBytes:d,topics:u})=>{const l=r(17988),h=r(39272);return{request:l({replicaId:e,isolationLevel:t,sessionId:i,sessionEpoch:n,forgottenTopics:a,maxWaitTime:c,minBytes:p,maxBytes:d,topics:u}),response:h,requestTimeout:s(c)}},10:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,sessionId:i=0,sessionEpoch:n=-1,forgottenTopics:a=[],maxWaitTime:c,minBytes:p,maxBytes:d,topics:u})=>{const l=r(3504),h=r(53882);return{request:l({replicaId:e,isolationLevel:t,sessionId:i,sessionEpoch:n,forgottenTopics:a,maxWaitTime:c,minBytes:p,maxBytes:d,topics:u}),response:h,requestTimeout:s(c)}},11:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,sessionId:i=0,sessionEpoch:n=-1,forgottenTopics:a=[],maxWaitTime:c,minBytes:p,maxBytes:d,topics:u,rackId:l})=>{const h=r(51592),m=r(98405);return{request:h({replicaId:e,isolationLevel:t,sessionId:i,sessionEpoch:n,forgottenTopics:a,maxWaitTime:c,minBytes:p,maxBytes:d,topics:u,rackId:l}),response:m,requestTimeout:s(c)}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},12818:(e,t,r)=>{const o=r(28783),{Fetch:s}=r(99211);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,topics:n})=>({apiKey:s,apiVersion:0,apiName:"Fetch",encode:async()=>(new o).writeInt32(e).writeInt32(t).writeInt32(r).writeArray(n.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,fetchOffset:t,maxBytes:r})=>(new o).writeInt32(e).writeInt64(t).writeInt32(r)},43583:(e,t,r)=>{const o=r(56341),{KafkaJSOffsetOutOfRange:s}=r(29879),{failure:i,createErrorFromCode:n,errorCodes:a}=r(21701),c=r(74358),p=r(44321),d=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),messages:await p(e)}),u=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(d)}),{code:l}=a.find((e=>"OFFSET_OUT_OF_RANGE"===e.type));e.exports={decode:async e=>{const t=new o(e);return{responses:await t.readArrayAsync(u)}},parse:async e=>{const t=e.responses.map((({topicName:e,partitions:t})=>t.filter((e=>i(e.errorCode))).map((t=>Object.assign({},t,{topic:e}))))),r=c(t);if(r.length>0){const{errorCode:e,topic:t,partition:o}=r[0];if(e===l)throw new s(n(e),{topic:t,partition:o});throw n(e)}return e}}},48087:(e,t,r)=>{const o=r(12818);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,topics:s})=>Object.assign(o({replicaId:e,maxWaitTime:t,minBytes:r,topics:s}),{apiVersion:1})},2155:(e,t,r)=>{const o=r(56341),{parse:s}=r(43583),i=r(44321),n=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),messages:await i(e)}),a=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(n)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),responses:await t.readArrayAsync(a)}},parse:s}},3504:(e,t,r)=>{const o=r(52845),s=r(17988);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:i,topics:n,isolationLevel:a=o.READ_COMMITTED,sessionId:c=0,sessionEpoch:p=-1,forgottenTopics:d=[]})=>Object.assign(s({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:i,topics:n,isolationLevel:a,sessionId:c,sessionEpoch:p,forgottenTopics:d}),{apiVersion:10})},53882:(e,t,r)=>{const{decode:o,parse:s}=r(39272);e.exports={decode:o,parse:s}},51592:(e,t,r)=>{const o=r(28783),{Fetch:s}=r(99211),i=r(52845);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:c,topics:p,rackId:d="",isolationLevel:u=i.READ_COMMITTED,sessionId:l=0,sessionEpoch:h=-1,forgottenTopics:m=[]})=>({apiKey:s,apiVersion:11,apiName:"Fetch",encode:async()=>(new o).writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(c).writeInt8(u).writeInt32(l).writeInt32(h).writeArray(p.map(a)).writeArray(m.map(n)).writeString(d)});const n=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t),a=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(c)),c=({partition:e,currentLeaderEpoch:t=-1,fetchOffset:r,logStartOffset:s=-1,maxBytes:i})=>(new o).writeInt32(e).writeInt32(t).writeInt64(r).writeInt64(s).writeInt32(i)},98405:(e,t,r)=>{const o=r(56341),{parse:s}=r(2155),i=r(45643),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),a=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),preferredReadReplica:e.readInt32(),messages:await i(e)}),c=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(a)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:0,clientSideThrottleTime:t.readInt32(),errorCode:t.readInt16(),sessionId:t.readInt32(),responses:await t.readArrayAsync(c)}},parse:s}},62045:(e,t,r)=>{const o=r(12818);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,topics:s})=>Object.assign(o({replicaId:e,maxWaitTime:t,minBytes:r,topics:s}),{apiVersion:2})},7628:(e,t,r)=>{const{decode:o,parse:s}=r(2155);e.exports={decode:o,parse:s}},84704:(e,t,r)=>{const o=r(28783),{Fetch:s}=r(99211);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:n,topics:a})=>({apiKey:s,apiVersion:3,apiName:"Fetch",encode:async()=>(new o).writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(n).writeArray(a.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,fetchOffset:t,maxBytes:r})=>(new o).writeInt32(e).writeInt64(t).writeInt32(r)},11828:(e,t,r)=>{const{decode:o,parse:s}=r(2155);e.exports={decode:o,parse:s}},45643:(e,t,r)=>{const o=r(56341),s=r(44321),i=r(43294),{MAGIC_BYTE:n}=r(72872);e.exports=async e=>{const t=e.readInt32();if(t<=0||!e.canReadBytes(t))return[];const r=e.readBytes(t),a=new o(r);if(r.slice(16).readInt8(0)===n){const e=[];for(;a.canReadBytes(49);)try{const t=await i(a);e.push(...t.records)}catch(e){if("KafkaJSPartialMessageError"===e.name)break;throw e}return e}return s(a,t)}},97737:(e,t,r)=>{const o=r(28783),{Fetch:s}=r(99211),i=r(52845);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:c,isolationLevel:p=i.READ_COMMITTED})=>({apiKey:s,apiVersion:4,apiName:"Fetch",encode:async()=>(new o).writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(a).writeInt8(p).writeArray(c.map(n))});const n=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(a)),a=({partition:e,fetchOffset:t,maxBytes:r})=>(new o).writeInt32(e).writeInt64(t).writeInt32(r)},76668:(e,t,r)=>{const o=r(56341),{parse:s}=r(2155),i=r(45643),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),a=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await i(e)}),c=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(a)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),responses:await t.readArrayAsync(c)}},parse:s}},52881:(e,t,r)=>{const o=r(28783),{Fetch:s}=r(99211),i=r(52845);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:a,topics:c,isolationLevel:p=i.READ_COMMITTED})=>({apiKey:s,apiVersion:5,apiName:"Fetch",encode:async()=>(new o).writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(a).writeInt8(p).writeArray(c.map(n))});const n=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(a)),a=({partition:e,fetchOffset:t,logStartOffset:r=-1,maxBytes:s})=>(new o).writeInt32(e).writeInt64(t).writeInt64(r).writeInt32(s)},19214:(e,t,r)=>{const o=r(56341),{parse:s}=r(2155),i=r(45643),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),a=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await i(e)}),c=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(a)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),responses:await t.readArrayAsync(c)}},parse:s}},4939:(e,t,r)=>{const o=r(52845),s=r(52881);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:i,topics:n,isolationLevel:a=o.READ_COMMITTED})=>Object.assign(s({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:i,topics:n,isolationLevel:a}),{apiVersion:6})},35646:(e,t,r)=>{const{decode:o,parse:s}=r(19214);e.exports={decode:o,parse:s}},73431:(e,t,r)=>{const o=r(28783),{Fetch:s}=r(99211),i=r(52845);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:c,topics:p,isolationLevel:d=i.READ_COMMITTED,sessionId:u=0,sessionEpoch:l=-1,forgottenTopics:h=[]})=>({apiKey:s,apiVersion:7,apiName:"Fetch",encode:async()=>(new o).writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(c).writeInt8(d).writeInt32(u).writeInt32(l).writeArray(p.map(a)).writeArray(h.map(n))});const n=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t),a=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(c)),c=({partition:e,fetchOffset:t,logStartOffset:r=-1,maxBytes:s})=>(new o).writeInt32(e).writeInt64(t).writeInt64(r).writeInt32(s)},33456:(e,t,r)=>{const o=r(56341),{parse:s}=r(2155),i=r(45643),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),a=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await i(e)}),c=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(a)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),errorCode:t.readInt16(),sessionId:t.readInt32(),responses:await t.readArrayAsync(c)}},parse:s}},54427:(e,t,r)=>{const o=r(52845),s=r(73431);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:i,topics:n,isolationLevel:a=o.READ_COMMITTED,sessionId:c=0,sessionEpoch:p=-1,forgottenTopics:d=[]})=>Object.assign(s({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:i,topics:n,isolationLevel:a,sessionId:c,sessionEpoch:p,forgottenTopics:d}),{apiVersion:8})},47004:(e,t,r)=>{const o=r(56341),{parse:s}=r(2155),i=r(45643),n=e=>({producerId:e.readInt64().toString(),firstOffset:e.readInt64().toString()}),a=async e=>({partition:e.readInt32(),errorCode:e.readInt16(),highWatermark:e.readInt64().toString(),lastStableOffset:e.readInt64().toString(),lastStartOffset:e.readInt64().toString(),abortedTransactions:e.readArray(n),messages:await i(e)}),c=async e=>({topicName:e.readString(),partitions:await e.readArrayAsync(a)});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:0,clientSideThrottleTime:t.readInt32(),errorCode:t.readInt16(),sessionId:t.readInt32(),responses:await t.readArrayAsync(c)}},parse:s}},17988:(e,t,r)=>{const o=r(28783),{Fetch:s}=r(99211),i=r(52845);e.exports=({replicaId:e,maxWaitTime:t,minBytes:r,maxBytes:c,topics:p,isolationLevel:d=i.READ_COMMITTED,sessionId:u=0,sessionEpoch:l=-1,forgottenTopics:h=[]})=>({apiKey:s,apiVersion:9,apiName:"Fetch",encode:async()=>(new o).writeInt32(e).writeInt32(t).writeInt32(r).writeInt32(c).writeInt8(d).writeInt32(u).writeInt32(l).writeArray(p.map(a)).writeArray(h.map(n))});const n=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t),a=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(c)),c=({partition:e,currentLeaderEpoch:t=-1,fetchOffset:r,logStartOffset:s=-1,maxBytes:i})=>(new o).writeInt32(e).writeInt32(t).writeInt64(r).writeInt64(s).writeInt32(i)},39272:(e,t,r)=>{const{decode:o,parse:s}=r(47004);e.exports={decode:o,parse:s}},30163:(e,t,r)=>{const o=r(7022),s={0:({groupId:e})=>{const t=r(66592),o=r(33419);return{request:t({groupId:e}),response:o}},1:({groupId:e,coordinatorType:t=o.GROUP})=>{const s=r(27664),i=r(87451);return{request:s({coordinatorKey:e,coordinatorType:t}),response:i}},2:({groupId:e,coordinatorType:t=o.GROUP})=>{const s=r(99050),i=r(18179);return{request:s({coordinatorKey:e,coordinatorType:t}),response:i}}};e.exports={versions:Object.keys(s),protocol:({version:e})=>s[e]}},66592:(e,t,r)=>{const o=r(28783),{GroupCoordinator:s}=r(99211);e.exports=({groupId:e})=>({apiKey:s,apiVersion:0,apiName:"GroupCoordinator",encode:async()=>(new o).writeString(e)})},33419:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return n(r),{errorCode:r,coordinator:{nodeId:t.readInt32(),host:t.readString(),port:t.readInt32()}}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},27664:(e,t,r)=>{const o=r(28783),{GroupCoordinator:s}=r(99211);e.exports=({coordinatorKey:e,coordinatorType:t})=>({apiKey:s,apiVersion:1,apiName:"GroupCoordinator",encode:async()=>(new o).writeString(e).writeInt8(t)})},87451:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s,errorMessage:t.readString(),coordinator:{nodeId:t.readInt32(),host:t.readString(),port:t.readInt32()}}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},99050:(e,t,r)=>{const o=r(27664);e.exports=({coordinatorKey:e,coordinatorType:t})=>Object.assign(o({coordinatorKey:e,coordinatorType:t}),{apiVersion:2})},18179:(e,t,r)=>{const{parse:o,decode:s}=r(87451);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},46641:(e,t,r)=>{const o={0:({groupId:e,groupGenerationId:t,memberId:o})=>{const s=r(87533),i=r(94732);return{request:s({groupId:e,groupGenerationId:t,memberId:o}),response:i}},1:({groupId:e,groupGenerationId:t,memberId:o})=>{const s=r(57694),i=r(41199);return{request:s({groupId:e,groupGenerationId:t,memberId:o}),response:i}},2:({groupId:e,groupGenerationId:t,memberId:o})=>{const s=r(40686),i=r(42394);return{request:s({groupId:e,groupGenerationId:t,memberId:o}),response:i}},3:({groupId:e,groupGenerationId:t,memberId:o,groupInstanceId:s})=>{const i=r(10034),n=r(41194);return{request:i({groupId:e,groupGenerationId:t,memberId:o,groupInstanceId:s}),response:n}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},87533:(e,t,r)=>{const o=r(28783),{Heartbeat:s}=r(99211);e.exports=({groupId:e,groupGenerationId:t,memberId:r})=>({apiKey:s,apiVersion:0,apiName:"Heartbeat",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r)})},94732:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e).readInt16();return n(t),{errorCode:t}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},57694:(e,t,r)=>{const o=r(87533);e.exports=({groupId:e,groupGenerationId:t,memberId:r})=>Object.assign(o({groupId:e,groupGenerationId:t,memberId:r}),{apiVersion:1})},41199:(e,t,r)=>{const o=r(56341),{failIfVersionNotSupported:s}=r(21701),{parse:i}=r(94732);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),i=t.readInt16();return s(i),{throttleTime:r,errorCode:i}},parse:i}},40686:(e,t,r)=>{const o=r(57694);e.exports=({groupId:e,groupGenerationId:t,memberId:r})=>Object.assign(o({groupId:e,groupGenerationId:t,memberId:r}),{apiVersion:2})},42394:(e,t,r)=>{const{parse:o,decode:s}=r(41199);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},10034:(e,t,r)=>{const o=r(28783),{Heartbeat:s}=r(99211);e.exports=({groupId:e,groupGenerationId:t,memberId:r,groupInstanceId:i})=>({apiKey:s,apiVersion:3,apiName:"Heartbeat",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r).writeString(i)})},41194:(e,t,r)=>{const{parse:o,decode:s}=r(42394);e.exports={decode:s,parse:o}},63146:(e,t,r)=>{const o=r(99211),{KafkaJSServerDoesNotSupportApiKey:s,KafkaJSNotImplemented:i}=r(29879),n={versions:[],protocol:()=>{throw new i}},a={Produce:r(67609),Fetch:r(98681),ListOffsets:r(20364),Metadata:r(41747),LeaderAndIsr:n,StopReplica:n,UpdateMetadata:n,ControlledShutdown:n,OffsetCommit:r(17789),OffsetFetch:r(21761),GroupCoordinator:r(30163),JoinGroup:r(60583),Heartbeat:r(46641),LeaveGroup:r(83083),SyncGroup:r(86096),DescribeGroups:r(57927),ListGroups:r(68119),SaslHandshake:r(26184),ApiVersions:r(67020),CreateTopics:r(42346),DeleteTopics:r(29038),DeleteRecords:r(28035),InitProducerId:r(36961),OffsetForLeaderEpoch:n,AddPartitionsToTxn:r(73350),AddOffsetsToTxn:r(4530),EndTxn:r(32059),WriteTxnMarkers:n,TxnOffsetCommit:r(35302),DescribeAcls:r(45665),CreateAcls:r(64950),DeleteAcls:r(11491),DescribeConfigs:r(26450),AlterConfigs:r(31858),AlterReplicaLogDirs:n,DescribeLogDirs:n,SaslAuthenticate:r(10886),CreatePartitions:r(14842),CreateDelegationToken:n,RenewDelegationToken:n,ExpireDelegationToken:n,DescribeDelegationToken:n,DeleteGroups:r(62086)},c=Object.keys(o),p=Object.values(o),d=e=>c[p.indexOf(e)];e.exports={requests:a,lookup:e=>(t,r)=>{const o=e[t],i=r.versions.map(Number),n=Math.max(...i);if(!o||null==o.maxVersion)throw new s("The Kafka server does not support the requested API version",{apiKey:t,apiName:d(t)});const a=Math.min(n,o.maxVersion);return r.protocol({version:a})}}},36961:(e,t,r)=>{const o={0:({transactionalId:e,transactionTimeout:t=5e3})=>{const o=r(76862),s=r(57280);return{request:o({transactionalId:e,transactionTimeout:t}),response:s}},1:({transactionalId:e,transactionTimeout:t=5e3})=>{const o=r(75427),s=r(32826);return{request:o({transactionalId:e,transactionTimeout:t}),response:s}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},76862:(e,t,r)=>{const o=r(28783),{InitProducerId:s}=r(99211);e.exports=({transactionalId:e,transactionTimeout:t})=>({apiKey:s,apiVersion:0,apiName:"InitProducerId",encode:async()=>(new o).writeString(e).writeInt32(t)})},57280:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),s=t.readInt16();return n(s),{throttleTime:r,errorCode:s,producerId:t.readInt64().toString(),producerEpoch:t.readInt16()}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},75427:(e,t,r)=>{const o=r(76862);e.exports=({transactionalId:e,transactionTimeout:t})=>Object.assign(o({transactionalId:e,transactionTimeout:t}),{apiVersion:1})},32826:(e,t,r)=>{const{parse:o,decode:s}=r(57280);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},60583:(e,t,r)=>{const o=({rebalanceTimeout:e,sessionTimeout:t})=>{const r=e||t;return Number.isSafeInteger(r+5e3)?r+5e3:r},s=e=>null!=e&&""!==e,i={0:({groupId:e,sessionTimeout:t,memberId:s,protocolType:i,groupProtocols:n})=>{const a=r(99369),c=r(90259);return{request:a({groupId:e,sessionTimeout:t,memberId:s,protocolType:i,groupProtocols:n}),response:c,requestTimeout:o({rebalanceTimeout:null,sessionTimeout:t})}},1:({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:i,protocolType:n,groupProtocols:a})=>{const c=r(59369),p=r(59801);return{request:c({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:i,protocolType:n,groupProtocols:a}),response:p,requestTimeout:o({rebalanceTimeout:s,sessionTimeout:t})}},2:({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:i,protocolType:n,groupProtocols:a})=>{const c=r(36146),p=r(21989);return{request:c({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:i,protocolType:n,groupProtocols:a}),response:p,requestTimeout:o({rebalanceTimeout:s,sessionTimeout:t})}},3:({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:i,protocolType:n,groupProtocols:a})=>{const c=r(15318),p=r(69106);return{request:c({groupId:e,sessionTimeout:t,rebalanceTimeout:s,memberId:i,protocolType:n,groupProtocols:a}),response:p,requestTimeout:o({rebalanceTimeout:s,sessionTimeout:t})}},4:({groupId:e,sessionTimeout:t,rebalanceTimeout:i,memberId:n,protocolType:a,groupProtocols:c})=>{const p=r(85125),d=r(32285);return{request:p({groupId:e,sessionTimeout:t,rebalanceTimeout:i,memberId:n,protocolType:a,groupProtocols:c}),response:d,requestTimeout:o({rebalanceTimeout:i,sessionTimeout:t}),logResponseError:s(n)}},5:({groupId:e,sessionTimeout:t,rebalanceTimeout:i,memberId:n,groupInstanceId:a,protocolType:c,groupProtocols:p})=>{const d=r(24454),u=r(36845);return{request:d({groupId:e,sessionTimeout:t,rebalanceTimeout:i,memberId:n,groupInstanceId:a,protocolType:c,groupProtocols:p}),response:u,requestTimeout:o({rebalanceTimeout:i,sessionTimeout:t}),logResponseError:s(n)}}};e.exports={versions:Object.keys(i),protocol:({version:e})=>i[e]}},99369:(e,t,r)=>{const o=r(28783),{JoinGroup:s}=r(99211);e.exports=({groupId:e,sessionTimeout:t,memberId:r,protocolType:n,groupProtocols:a})=>({apiKey:s,apiVersion:0,apiName:"JoinGroup",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r).writeString(n).writeArray(a.map(i))});const i=({name:e,metadata:t=Buffer.alloc(0)})=>(new o).writeString(e).writeBytes(t)},90259:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return n(r),{errorCode:r,generationId:t.readInt32(),groupProtocol:t.readString(),leaderId:t.readString(),memberId:t.readString(),members:t.readArray((e=>({memberId:e.readString(),memberMetadata:e.readBytes()})))}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},59369:(e,t,r)=>{const o=r(28783),{JoinGroup:s}=r(99211);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:n,protocolType:a,groupProtocols:c})=>({apiKey:s,apiVersion:1,apiName:"JoinGroup",encode:async()=>(new o).writeString(e).writeInt32(t).writeInt32(r).writeString(n).writeString(a).writeArray(c.map(i))});const i=({name:e,metadata:t=Buffer.alloc(0)})=>(new o).writeString(e).writeBytes(t)},59801:(e,t,r)=>{const{parse:o,decode:s}=r(90259);e.exports={decode:s,parse:o}},36146:(e,t,r)=>{const o=r(59369);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:i,groupProtocols:n})=>Object.assign(o({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:i,groupProtocols:n}),{apiVersion:2})},21989:(e,t,r)=>{const o=r(56341),{failIfVersionNotSupported:s}=r(21701),{parse:i}=r(90259);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),i=t.readInt16();return s(i),{throttleTime:r,errorCode:i,generationId:t.readInt32(),groupProtocol:t.readString(),leaderId:t.readString(),memberId:t.readString(),members:t.readArray((e=>({memberId:e.readString(),memberMetadata:e.readBytes()})))}},parse:i}},15318:(e,t,r)=>{const o=r(36146);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:i,groupProtocols:n})=>Object.assign(o({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:i,groupProtocols:n}),{apiVersion:3})},69106:(e,t,r)=>{const{parse:o,decode:s}=r(21989);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},85125:(e,t,r)=>{const o=r(15318);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:i,groupProtocols:n})=>Object.assign(o({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:s,protocolType:i,groupProtocols:n}),{apiVersion:4})},32285:(e,t,r)=>{const{decode:o}=r(69106),{KafkaJSMemberIdRequired:s}=r(29879),{failure:i,createErrorFromCode:n,errorCodes:a}=r(21701),{code:c}=a.find((e=>"MEMBER_ID_REQUIRED"===e.type));e.exports={decode:o,parse:async e=>{if(i(e.errorCode)){if(e.errorCode===c)throw new s(n(e.errorCode),{memberId:e.memberId});throw n(e.errorCode)}return e}}},24454:(e,t,r)=>{const o=r(28783),{JoinGroup:s}=r(99211);e.exports=({groupId:e,sessionTimeout:t,rebalanceTimeout:r,memberId:n,groupInstanceId:a=null,protocolType:c,groupProtocols:p})=>({apiKey:s,apiVersion:5,apiName:"JoinGroup",encode:async()=>(new o).writeString(e).writeInt32(t).writeInt32(r).writeString(n).writeString(a).writeString(c).writeArray(p.map(i))});const i=({name:e,metadata:t=Buffer.alloc(0)})=>(new o).writeString(e).writeBytes(t)},36845:(e,t,r)=>{const o=r(56341),{KafkaJSMemberIdRequired:s}=r(29879),{failure:i,createErrorFromCode:n,errorCodes:a,failIfVersionNotSupported:c}=r(21701),{code:p}=a.find((e=>"MEMBER_ID_REQUIRED"===e.type));e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),s=t.readInt16();return c(s),{throttleTime:0,clientSideThrottleTime:r,errorCode:s,generationId:t.readInt32(),groupProtocol:t.readString(),leaderId:t.readString(),memberId:t.readString(),members:t.readArray((e=>({memberId:e.readString(),groupInstanceId:e.readString(),memberMetadata:e.readBytes()})))}},parse:async e=>{if(i(e.errorCode)){if(e.errorCode===p)throw new s(n(e.errorCode),{memberId:e.memberId});throw n(e.errorCode)}return e}}},83083:(e,t,r)=>{const o={0:({groupId:e,memberId:t})=>{const o=r(26413),s=r(49376);return{request:o({groupId:e,memberId:t}),response:s}},1:({groupId:e,memberId:t})=>{const o=r(90885),s=r(80679);return{request:o({groupId:e,memberId:t}),response:s}},2:({groupId:e,memberId:t})=>{const o=r(25191),s=r(8235);return{request:o({groupId:e,memberId:t}),response:s}},3:({groupId:e,memberId:t,groupInstanceId:o})=>{const s=r(75680),i=r(51105);return{request:s({groupId:e,members:[{memberId:t,groupInstanceId:o}]}),response:i}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},26413:(e,t,r)=>{const o=r(28783),{LeaveGroup:s}=r(99211);e.exports=({groupId:e,memberId:t})=>({apiKey:s,apiVersion:0,apiName:"LeaveGroup",encode:async()=>(new o).writeString(e).writeString(t)})},49376:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e).readInt16();return n(t),{errorCode:t}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},90885:(e,t,r)=>{const o=r(26413);e.exports=({groupId:e,memberId:t})=>Object.assign(o({groupId:e,memberId:t}),{apiVersion:1})},80679:(e,t,r)=>{const o=r(56341),{failIfVersionNotSupported:s}=r(21701),{parse:i}=r(49376);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),i=t.readInt16();return s(i),{throttleTime:r,errorCode:i}},parse:i}},25191:(e,t,r)=>{const o=r(90885);e.exports=({groupId:e,memberId:t})=>Object.assign(o({groupId:e,memberId:t}),{apiVersion:2})},8235:(e,t,r)=>{const{parse:o,decode:s}=r(80679);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},75680:(e,t,r)=>{const o=r(28783),{LeaveGroup:s}=r(99211);e.exports=({groupId:e,members:t})=>({apiKey:s,apiVersion:3,apiName:"LeaveGroup",encode:async()=>(new o).writeString(e).writeArray(t.map((e=>i(e))))});const i=({memberId:e,groupInstanceId:t=null})=>(new o).writeString(e).writeString(t)},51105:(e,t,r)=>{const o=r(56341),{failIfVersionNotSupported:s,failure:i,createErrorFromCode:n}=r(21701),{parse:a}=r(8235),c=e=>({memberId:e.readString(),groupInstanceId:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),i=t.readInt16(),n=t.readArray(c);return s(i),{throttleTime:0,clientSideThrottleTime:r,errorCode:i,members:n}},parse:async e=>{const t=a(e),r=e.members.find((e=>i(e.errorCode)));if(r)throw n(r.errorCode);return t}}},68119:(e,t,r)=>{const o={0:()=>{const e=r(41660),t=r(41356);return{request:e(),response:t}},1:()=>{const e=r(50740),t=r(99644);return{request:e(),response:t}},2:()=>{const e=r(73058),t=r(17225);return{request:e(),response:t}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},41660:(e,t,r)=>{const o=r(28783),{ListGroups:s}=r(99211);e.exports=()=>({apiKey:s,apiVersion:0,apiName:"ListGroups",encode:async()=>new o})},41356:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=e=>({groupId:e.readString(),protocolType:e.readString()});e.exports={decodeGroup:n,decode:async e=>{const t=new o(e);return{errorCode:t.readInt16(),groups:t.readArray(n)}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},50740:(e,t,r)=>{const o=r(41660);e.exports=()=>Object.assign(o(),{apiVersion:1})},99644:(e,t,r)=>{const o=r(41356),s=r(56341);e.exports={decode:async e=>{const t=new s(e);return{throttleTime:t.readInt32(),errorCode:t.readInt16(),groups:t.readArray(o.decodeGroup)}},parse:o.parse}},73058:(e,t,r)=>{const o=r(50740);e.exports=()=>Object.assign(o(),{apiVersion:2})},17225:(e,t,r)=>{const{parse:o,decode:s}=r(99644);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},20364:(e,t,r)=>{const o=r(52845),s={0:({replicaId:e=-1,topics:t})=>{const o=r(20130),s=r(99440);return{request:o({replicaId:e,topics:t}),response:s}},1:({replicaId:e=-1,topics:t})=>{const o=r(11452),s=r(22922);return{request:o({replicaId:e,topics:t}),response:s}},2:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,topics:s})=>{const i=r(28246),n=r(30156);return{request:i({replicaId:e,isolationLevel:t,topics:s}),response:n}},3:({replicaId:e=-1,isolationLevel:t=o.READ_COMMITTED,topics:s})=>{const i=r(10330),n=r(32004);return{request:i({replicaId:e,isolationLevel:t,topics:s}),response:n}}};e.exports={versions:Object.keys(s),protocol:({version:e})=>s[e]}},20130:(e,t,r)=>{const o=r(28783),{ListOffsets:s}=r(99211);e.exports=({replicaId:e,topics:t})=>({apiKey:s,apiVersion:0,apiName:"ListOffsets",encode:async()=>(new o).writeInt32(e).writeArray(t.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,timestamp:t=-1,maxNumOffsets:r=1})=>(new o).writeInt32(e).writeInt64(t).writeInt32(r)},99440:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({topic:e.readString(),partitions:e.readArray(c)}),c=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offsets:e.readArray(p)}),p=e=>e.readInt64().toString();e.exports={decode:async e=>({responses:new o(e).readArray(a)}),parse:async e=>{const t=e.responses.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t)[0];if(r)throw i(r.errorCode);return e}}},11452:(e,t,r)=>{const o=r(28783),{ListOffsets:s}=r(99211);e.exports=({replicaId:e,topics:t})=>({apiKey:s,apiVersion:1,apiName:"ListOffsets",encode:async()=>(new o).writeInt32(e).writeArray(t.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,timestamp:t=-1})=>(new o).writeInt32(e).writeInt64(t)},22922:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({topic:e.readString(),partitions:e.readArray(c)}),c=e=>({partition:e.readInt32(),errorCode:e.readInt16(),timestamp:e.readInt64().toString(),offset:e.readInt64().toString()});e.exports={decode:async e=>({responses:new o(e).readArray(a)}),parse:async e=>{const t=e.responses.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t)[0];if(r)throw i(r.errorCode);return e}}},28246:(e,t,r)=>{const o=r(28783),{ListOffsets:s}=r(99211);e.exports=({replicaId:e,isolationLevel:t,topics:r})=>({apiKey:s,apiVersion:2,apiName:"ListOffsets",encode:async()=>(new o).writeInt32(e).writeInt8(t).writeArray(r.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,timestamp:t=-1})=>(new o).writeInt32(e).writeInt64(t)},30156:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({topic:e.readString(),partitions:e.readArray(c)}),c=e=>({partition:e.readInt32(),errorCode:e.readInt16(),timestamp:e.readInt64().toString(),offset:e.readInt64().toString()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),responses:t.readArray(a)}},parse:async e=>{const t=e.responses.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t)[0];if(r)throw i(r.errorCode);return e}}},10330:(e,t,r)=>{const o=r(28246);e.exports=({replicaId:e,isolationLevel:t,topics:r})=>Object.assign(o({replicaId:e,isolationLevel:t,topics:r}),{apiVersion:3})},32004:(e,t,r)=>{const{parse:o,decode:s}=r(30156);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},41747:(e,t,r)=>{const o={0:({topics:e})=>{const t=r(88838),o=r(57995);return{request:t({topics:e}),response:o}},1:({topics:e})=>{const t=r(34063),o=r(48972);return{request:t({topics:e}),response:o}},2:({topics:e})=>{const t=r(89853),o=r(83248);return{request:t({topics:e}),response:o}},3:({topics:e})=>{const t=r(36067),o=r(60626);return{request:t({topics:e}),response:o}},4:({topics:e,allowAutoTopicCreation:t})=>{const o=r(40227),s=r(21901);return{request:o({topics:e,allowAutoTopicCreation:t}),response:s}},5:({topics:e,allowAutoTopicCreation:t})=>{const o=r(55620),s=r(2068);return{request:o({topics:e,allowAutoTopicCreation:t}),response:s}},6:({topics:e,allowAutoTopicCreation:t})=>{const o=r(64234),s=r(74771);return{request:o({topics:e,allowAutoTopicCreation:t}),response:s}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},88838:(e,t,r)=>{const o=r(28783),{Metadata:s}=r(99211);e.exports=({topics:e})=>({apiKey:s,apiVersion:0,apiName:"Metadata",encode:async()=>(new o).writeArray(e)})},57995:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32()}),c=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),partitionMetadata:e.readArray(p)}),p=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray((e=>e.readInt32())),isr:e.readArray((e=>e.readInt32()))});e.exports={decode:async e=>{const t=new o(e);return{brokers:t.readArray(a),topicMetadata:t.readArray(c)}},parse:async e=>{const t=e.topicMetadata.filter((e=>s(e.topicErrorCode)));if(t.length>0){const{topicErrorCode:e}=t[0];throw i(e)}const r=e.topicMetadata.map((e=>e.partitionMetadata.filter((e=>s(e.partitionErrorCode))))),o=n(r);if(o.length>0){const{partitionErrorCode:e}=o[0];throw i(e)}return e}}},34063:(e,t,r)=>{const o=r(28783),{Metadata:s}=r(99211);e.exports=({topics:e})=>({apiKey:s,apiVersion:1,apiName:"Metadata",encode:async()=>(new o).writeNullableArray(e)})},48972:(e,t,r)=>{const o=r(56341),{parse:s}=r(57995),i=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(a)}),a=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray((e=>e.readInt32())),isr:e.readArray((e=>e.readInt32()))});e.exports={decode:async e=>{const t=new o(e);return{brokers:t.readArray(i),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}},parse:s}},89853:(e,t,r)=>{const o=r(34063);e.exports=({topics:e})=>Object.assign(o({topics:e}),{apiVersion:2})},83248:(e,t,r)=>{const o=r(56341),{parse:s}=r(57995),i=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(a)}),a=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray((e=>e.readInt32())),isr:e.readArray((e=>e.readInt32()))});e.exports={decode:async e=>{const t=new o(e);return{brokers:t.readArray(i),clusterId:t.readString(),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}},parse:s}},36067:(e,t,r)=>{const o=r(34063);e.exports=({topics:e})=>Object.assign(o({topics:e}),{apiVersion:3})},60626:(e,t,r)=>{const o=r(56341),{parse:s}=r(57995),i=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(a)}),a=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray((e=>e.readInt32())),isr:e.readArray((e=>e.readInt32()))});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),brokers:t.readArray(i),clusterId:t.readString(),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}},parse:s}},40227:(e,t,r)=>{const o=r(28783),{Metadata:s}=r(99211);e.exports=({topics:e,allowAutoTopicCreation:t=!0})=>({apiKey:s,apiVersion:4,apiName:"Metadata",encode:async()=>(new o).writeNullableArray(e).writeBoolean(t)})},21901:(e,t,r)=>{const{parse:o,decode:s}=r(60626);e.exports={parse:o,decode:s}},55620:(e,t,r)=>{const o=r(40227);e.exports=({topics:e,allowAutoTopicCreation:t=!0})=>Object.assign(o({topics:e,allowAutoTopicCreation:t}),{apiVersion:5})},2068:(e,t,r)=>{const o=r(56341),{parse:s}=r(57995),i=e=>({nodeId:e.readInt32(),host:e.readString(),port:e.readInt32(),rack:e.readString()}),n=e=>({topicErrorCode:e.readInt16(),topic:e.readString(),isInternal:e.readBoolean(),partitionMetadata:e.readArray(a)}),a=e=>({partitionErrorCode:e.readInt16(),partitionId:e.readInt32(),leader:e.readInt32(),replicas:e.readArray((e=>e.readInt32())),isr:e.readArray((e=>e.readInt32())),offlineReplicas:e.readArray((e=>e.readInt32()))});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),brokers:t.readArray(i),clusterId:t.readString(),controllerId:t.readInt32(),topicMetadata:t.readArray(n)}},parse:s}},64234:(e,t,r)=>{const o=r(55620);e.exports=({topics:e,allowAutoTopicCreation:t=!0})=>Object.assign(o({topics:e,allowAutoTopicCreation:t}),{apiVersion:6})},74771:(e,t,r)=>{const{parse:o,decode:s}=r(2068);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},17789:(e,t,r)=>{const o={0:({groupId:e,topics:t})=>{const o=r(70204),s=r(86941);return{request:o({groupId:e,topics:t}),response:s}},1:({groupId:e,groupGenerationId:t,memberId:o,topics:s})=>{const i=r(48698),n=r(6);return{request:i({groupId:e,groupGenerationId:t,memberId:o,topics:s}),response:n}},2:({groupId:e,groupGenerationId:t,memberId:o,retentionTime:s=-1,topics:i})=>{const n=r(14078),a=r(93865);return{request:n({groupId:e,groupGenerationId:t,memberId:o,retentionTime:s,topics:i}),response:a}},3:({groupId:e,groupGenerationId:t,memberId:o,retentionTime:s=-1,topics:i})=>{const n=r(7344),a=r(84369);return{request:n({groupId:e,groupGenerationId:t,memberId:o,retentionTime:s,topics:i}),response:a}},4:({groupId:e,groupGenerationId:t,memberId:o,retentionTime:s=-1,topics:i})=>{const n=r(50161),a=r(33831);return{request:n({groupId:e,groupGenerationId:t,memberId:o,retentionTime:s,topics:i}),response:a}},5:({groupId:e,groupGenerationId:t,memberId:o,topics:s})=>{const i=r(4024),n=r(70434);return{request:i({groupId:e,groupGenerationId:t,memberId:o,topics:s}),response:n}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},70204:(e,t,r)=>{const o=r(28783),{OffsetCommit:s}=r(99211);e.exports=({groupId:e,topics:t})=>({apiKey:s,apiVersion:0,apiName:"OffsetCommit",encode:async()=>(new o).writeString(e).writeArray(t.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r=null})=>(new o).writeInt32(e).writeInt64(t).writeString(r)},86941:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({topic:e.readString(),partitions:e.readArray(c)}),c=e=>({partition:e.readInt32(),errorCode:e.readInt16()});e.exports={decode:async e=>({responses:new o(e).readArray(a)}),parse:async e=>{const t=e.responses.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t)[0];if(r)throw i(r.errorCode);return e}}},48698:(e,t,r)=>{const o=r(28783),{OffsetCommit:s}=r(99211);e.exports=({groupId:e,groupGenerationId:t,memberId:r,topics:n})=>({apiKey:s,apiVersion:1,apiName:"OffsetCommit",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r).writeArray(n.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,timestamp:r=Date.now(),metadata:s=null})=>(new o).writeInt32(e).writeInt64(t).writeInt64(r).writeString(s)},6:(e,t,r)=>{const{parse:o,decode:s}=r(86941);e.exports={decode:s,parse:o}},14078:(e,t,r)=>{const o=r(28783),{OffsetCommit:s}=r(99211);e.exports=({groupId:e,groupGenerationId:t,memberId:r,retentionTime:n,topics:a})=>({apiKey:s,apiVersion:2,apiName:"OffsetCommit",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r).writeInt64(n).writeArray(a.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r=null})=>(new o).writeInt32(e).writeInt64(t).writeString(r)},93865:(e,t,r)=>{const{parse:o,decode:s}=r(86941);e.exports={decode:s,parse:o}},7344:(e,t,r)=>{const o=r(14078);e.exports=({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:i})=>Object.assign(o({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:i}),{apiVersion:3})},84369:(e,t,r)=>{const o=r(56341),{parse:s}=r(86941),i=e=>({topic:e.readString(),partitions:e.readArray(n)}),n=e=>({partition:e.readInt32(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),responses:t.readArray(i)}},parse:s}},50161:(e,t,r)=>{const o=r(7344);e.exports=({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:i})=>Object.assign(o({groupId:e,groupGenerationId:t,memberId:r,retentionTime:s,topics:i}),{apiVersion:4})},33831:(e,t,r)=>{const{parse:o,decode:s}=r(84369);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},4024:(e,t,r)=>{const o=r(28783),{OffsetCommit:s}=r(99211);e.exports=({groupId:e,groupGenerationId:t,memberId:r,topics:n})=>({apiKey:s,apiVersion:5,apiName:"OffsetCommit",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r).writeArray(n.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r=null})=>(new o).writeInt32(e).writeInt64(t).writeString(r)},70434:(e,t,r)=>{const{parse:o,decode:s}=r(33831);e.exports={decode:s,parse:o}},21761:(e,t,r)=>{const o={1:({groupId:e,topics:t})=>{const o=r(98047),s=r(42522);return{request:o({groupId:e,topics:t}),response:s}},2:({groupId:e,topics:t})=>{const o=r(89519),s=r(37269);return{request:o({groupId:e,topics:t}),response:s}},3:({groupId:e,topics:t})=>{const o=r(51640),s=r(48414);return{request:o({groupId:e,topics:t}),response:s}},4:({groupId:e,topics:t})=>{const o=r(20633),s=r(42871);return{request:o({groupId:e,topics:t}),response:s}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},98047:(e,t,r)=>{const o=r(28783),{OffsetFetch:s}=r(99211);e.exports=({groupId:e,topics:t})=>({apiKey:s,apiVersion:1,apiName:"OffsetFetch",encode:async()=>(new o).writeString(e).writeArray(t.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e})=>(new o).writeInt32(e)},42522:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({topic:e.readString(),partitions:e.readArray(c)}),c=e=>({partition:e.readInt32(),offset:e.readInt64().toString(),metadata:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>({responses:new o(e).readArray(a)}),parse:async e=>{const t=e.responses.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t)[0];if(r)throw i(r.errorCode);return e}}},89519:(e,t,r)=>{const o=r(98047);e.exports=({groupId:e,topics:t})=>Object.assign(o({groupId:e,topics:t}),{apiVersion:2})},37269:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({topic:e.readString(),partitions:e.readArray(c)}),c=e=>({partition:e.readInt32(),offset:e.readInt64().toString(),metadata:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e);return{responses:t.readArray(a),errorCode:t.readInt16()}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);const t=e.responses.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t)[0];if(r)throw i(r.errorCode);return e}}},51640:(e,t,r)=>{const o=r(28783),{OffsetFetch:s}=r(99211);e.exports=({groupId:e,topics:t})=>({apiKey:s,apiVersion:3,apiName:"OffsetFetch",encode:async()=>(new o).writeString(e).writeNullableArray(t.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e})=>(new o).writeInt32(e)},48414:(e,t,r)=>{const o=r(56341),{parse:s}=r(37269),i=e=>({topic:e.readString(),partitions:e.readArray(n)}),n=e=>({partition:e.readInt32(),offset:e.readInt64().toString(),metadata:e.readString(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),responses:t.readArray(i),errorCode:t.readInt16()}},parse:s}},20633:(e,t,r)=>{const o=r(51640);e.exports=({groupId:e,topics:t})=>Object.assign(o({groupId:e,topics:t}),{apiVersion:4})},42871:(e,t,r)=>{const{parse:o,decode:s}=r(48414);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},67609:(e,t,r)=>{const o={0:({acks:e,timeout:t,topicData:o})=>{const s=r(75127),i=r(92615);return{request:s({acks:e,timeout:t,topicData:o}),response:i}},1:({acks:e,timeout:t,topicData:o})=>{const s=r(56807),i=r(48683);return{request:s({acks:e,timeout:t,topicData:o}),response:i}},2:({acks:e,timeout:t,topicData:o,compression:s})=>{const i=r(80749),n=r(75468);return{request:i({acks:e,timeout:t,compression:s,topicData:o}),response:n}},3:({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a})=>{const c=r(26088),p=r(34635);return{request:c({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a}),response:p}},4:({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a})=>{const c=r(49221),p=r(64206);return{request:c({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a}),response:p}},5:({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a})=>{const c=r(65353),p=r(84708);return{request:c({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a}),response:p}},6:({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a})=>{const c=r(71392),p=r(61988);return{request:c({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a}),response:p}},7:({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a})=>{const c=r(637),p=r(75250);return{request:c({acks:e,timeout:t,compression:o,topicData:s,transactionalId:i,producerId:n,producerEpoch:a}),response:p}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},75127:(e,t,r)=>{const o=r(28783),{Produce:s}=r(99211),i=r(42032);e.exports=({acks:e,timeout:t,topicData:r})=>({apiKey:s,apiVersion:0,apiName:"Produce",expectResponse:()=>0!==e,encode:async()=>(new o).writeInt16(e).writeInt32(t).writeArray(r.map(n))});const n=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(a)),a=({partition:e,messages:t})=>{const r=i({messageVersion:0,entries:t});return(new o).writeInt32(e).writeInt32(r.size()).writeEncoder(r)}},92615:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offset:e.readInt64().toString()});e.exports={decode:async e=>({topics:new o(e).readArray((e=>({topicName:e.readString(),partitions:e.readArray(a)})))}),parse:async e=>{const t=e.topics.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t);if(r.length>0){const{errorCode:e}=r[0];throw i(e)}return e}}},56807:(e,t,r)=>{const o=r(75127);e.exports=({acks:e,timeout:t,topicData:r})=>Object.assign(o({acks:e,timeout:t,topicData:r}),{apiVersion:1})},48683:(e,t,r)=>{const o=r(56341),{parse:s}=r(92615),i=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offset:e.readInt64().toString()});e.exports={decode:async e=>{const t=new o(e),r=t.readArray((e=>({topicName:e.readString(),partitions:e.readArray(i)})));return{topics:r,throttleTime:t.readInt32()}},parse:s}},80749:(e,t,r)=>{const o=r(28783),{Produce:s}=r(99211),i=r(42032),{Types:n,lookupCodec:a}=r(42972);e.exports=({acks:e,timeout:t,compression:r=n.None,topicData:i})=>({apiKey:s,apiVersion:2,apiName:"Produce",expectResponse:()=>0!==e,encode:async()=>{const s=c(r),n=[];for(const e of i)n.push(await s(e));return(new o).writeInt16(e).writeInt32(t).writeArray(n)}});const c=e=>{const t=p(e);return async({topic:e,partitions:r})=>{const s=[];for(const e of r)s.push(await t(e));return(new o).writeString(e).writeArray(s)}},p=e=>async({partition:t,messages:r})=>{const s=i({messageVersion:1,compression:e,entries:r});if(e===n.None)return(new o).writeInt32(t).writeInt32(s.size()).writeEncoder(s);const c=r[0].timestamp||Date.now(),p=a(e),d=await p.compress(s),u=i({messageVersion:1,entries:[{compression:e,timestamp:c,value:d}]});return(new o).writeInt32(t).writeInt32(u.size()).writeEncoder(u)}},75468:(e,t,r)=>{const o=r(56341),{parse:s}=r(92615),i=e=>({partition:e.readInt32(),errorCode:e.readInt16(),offset:e.readInt64().toString(),timestamp:e.readInt64().toString()});e.exports={decode:async e=>{const t=new o(e),r=t.readArray((e=>({topicName:e.readString(),partitions:e.readArray(i)})));return{topics:r,throttleTime:t.readInt32()}},parse:s}},26088:(e,t,r)=>{const o=r(73278),s=r(28783),{Produce:i}=r(99211),{Types:n}=r(42972),a=r(16575),{RecordBatch:c}=r(72872);e.exports=({acks:e,timeout:t,transactionalId:r=null,producerId:a=o.fromInt(-1),producerEpoch:c=0,compression:d=n.None,topicData:u})=>({apiKey:i,apiVersion:3,apiName:"Produce",expectResponse:()=>0!==e,encode:async()=>{const o=p(d),i=[];for(const e of u)i.push(await o({...e,transactionalId:r,producerId:a,producerEpoch:c}));return(new s).writeString(r).writeInt16(e).writeInt32(t).writeArray(i)}});const p=e=>async({topic:t,partitions:r,transactionalId:o,producerId:i,producerEpoch:n})=>{const a=d(e),c=[];for(const e of r)c.push(await a({...e,transactionalId:o,producerId:i,producerEpoch:n}));return(new s).writeString(t).writeArray(c)},d=e=>async({partition:t,messages:r,transactionalId:o,firstSequence:i,producerId:n,producerEpoch:p})=>{const d=Date.now(),u=r.map((e=>e.timestamp)).filter((e=>null!=e)).sort(),l=0===u.length?[d]:u,h=l[0],m=l[l.length-1],f=r.map(((e,t)=>a({...e,offsetDelta:t,timestampDelta:(e.timestamp||d)-h}))),g=await c({compression:e,records:f,firstTimestamp:h,maxTimestamp:m,producerId:n,producerEpoch:p,firstSequence:i,transactional:!!o,lastOffsetDelta:f.length-1});return(new s).writeInt32(t).writeInt32(g.size()).writeEncoder(g)}},34635:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=r(74358),a=e=>({partition:e.readInt32(),errorCode:e.readInt16(),baseOffset:e.readInt64().toString(),logAppendTime:e.readInt64().toString()});e.exports={decode:async e=>{const t=new o(e),r=t.readArray((e=>({topicName:e.readString(),partitions:e.readArray(a)})));return{topics:r,throttleTime:t.readInt32()}},parse:async e=>{const t=e.topics.map((e=>e.partitions.filter((e=>s(e.errorCode))))),r=n(t);if(r.length>0){const{errorCode:e}=r[0];throw i(e)}return e}}},49221:(e,t,r)=>{const o=r(26088);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a})=>Object.assign(o({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a}),{apiVersion:4})},64206:(e,t,r)=>{const{decode:o,parse:s}=r(34635);e.exports={decode:o,parse:s}},65353:(e,t,r)=>{const o=r(26088);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a})=>Object.assign(o({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a}),{apiVersion:5})},84708:(e,t,r)=>{const o=r(56341),{parse:s}=r(34635),i=e=>({partition:e.readInt32(),errorCode:e.readInt16(),baseOffset:e.readInt64().toString(),logAppendTime:e.readInt64().toString(),logStartOffset:e.readInt64().toString()});e.exports={decode:async e=>{const t=new o(e),r=t.readArray((e=>({topicName:e.readString(),partitions:e.readArray(i)})));return{topics:r,throttleTime:t.readInt32()}},parse:s}},71392:(e,t,r)=>{const o=r(65353);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a})=>Object.assign(o({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a}),{apiVersion:6})},61988:(e,t,r)=>{const{parse:o,decode:s}=r(84708);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},637:(e,t,r)=>{const o=r(71392);e.exports=({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a})=>Object.assign(o({acks:e,timeout:t,transactionalId:r,producerId:s,producerEpoch:i,compression:n,topicData:a}),{apiVersion:7})},75250:(e,t,r)=>{const{decode:o,parse:s}=r(61988);e.exports={decode:o,parse:s}},10886:(e,t,r)=>{const o={0:({authBytes:e})=>{const t=r(87383),o=r(79305);return{request:t({authBytes:e}),response:o}},1:({authBytes:e})=>{const t=r(98439),o=r(5986);return{request:t({authBytes:e}),response:o}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},87383:(e,t,r)=>{const o=r(28783),{SaslAuthenticate:s}=r(99211);e.exports=({authBytes:e})=>({apiKey:s,apiVersion:0,apiName:"SaslAuthenticate",encode:async()=>(new o).writeBuffer(e)})},79305:(e,t,r)=>{const o=r(56341),s=r(28783),{failure:i,createErrorFromCode:n,failIfVersionNotSupported:a,errorCodes:c}=r(21701),{KafkaJSProtocolError:p}=r(29879),d=c.find((e=>58===e.code));e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return a(r),{errorCode:r,errorMessage:t.readString(),authBytes:(new s).writeBytes(t.readBytes()).buffer}},parse:async e=>{if(58===e.errorCode&&e.errorMessage)throw new p({...d,message:e.errorMessage});if(i(e.errorCode))throw n(e.errorCode);return e}}},98439:(e,t,r)=>{const o=r(87383);e.exports=({authBytes:e})=>Object.assign(o({authBytes:e}),{apiVersion:1})},5986:(e,t,r)=>{const o=r(56341),s=r(28783),{parse:i}=r(79305),{failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return n(r),{errorCode:r,errorMessage:t.readString(),authBytes:(new s).writeBytes(t.readBytes()).buffer,sessionLifetimeMs:t.readInt64().toString()}},parse:i}},26184:(e,t,r)=>{const o={0:({mechanism:e})=>{const t=r(38143),o=r(96190);return{request:t({mechanism:e}),response:o}},1:({mechanism:e})=>{const t=r(85389),o=r(80525);return{request:t({mechanism:e}),response:o}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},38143:(e,t,r)=>{const o=r(28783),{SaslHandshake:s}=r(99211);e.exports=({mechanism:e})=>({apiKey:s,apiVersion:0,apiName:"SaslHandshake",encode:async()=>(new o).writeString(e)})},96190:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return n(r),{errorCode:r,enabledMechanisms:t.readArray((e=>e.readString()))}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},85389:(e,t,r)=>{const o=r(38143);e.exports=({mechanism:e})=>({...o({mechanism:e}),apiVersion:1})},80525:(e,t,r)=>{const{decode:o,parse:s}=r(96190);e.exports={decode:o,parse:s}},86096:(e,t,r)=>{const o={0:({groupId:e,generationId:t,memberId:o,groupAssignment:s})=>{const i=r(52322),n=r(15509);return{request:i({groupId:e,generationId:t,memberId:o,groupAssignment:s}),response:n}},1:({groupId:e,generationId:t,memberId:o,groupAssignment:s})=>{const i=r(12596),n=r(93155);return{request:i({groupId:e,generationId:t,memberId:o,groupAssignment:s}),response:n}},2:({groupId:e,generationId:t,memberId:o,groupAssignment:s})=>{const i=r(91901),n=r(70015);return{request:i({groupId:e,generationId:t,memberId:o,groupAssignment:s}),response:n}},3:({groupId:e,generationId:t,memberId:o,groupInstanceId:s,groupAssignment:i})=>{const n=r(97203),a=r(72745);return{request:n({groupId:e,generationId:t,memberId:o,groupInstanceId:s,groupAssignment:i}),response:a}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},52322:(e,t,r)=>{const o=r(28783),{SyncGroup:s}=r(99211);e.exports=({groupId:e,generationId:t,memberId:r,groupAssignment:n})=>({apiKey:s,apiVersion:0,apiName:"SyncGroup",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r).writeArray(n.map(i))});const i=({memberId:e,memberAssignment:t})=>(new o).writeString(e).writeBytes(t)},15509:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i,failIfVersionNotSupported:n}=r(21701);e.exports={decode:async e=>{const t=new o(e),r=t.readInt16();return n(r),{errorCode:r,memberAssignment:t.readBytes()}},parse:async e=>{if(s(e.errorCode))throw i(e.errorCode);return e}}},12596:(e,t,r)=>{const o=r(52322);e.exports=({groupId:e,generationId:t,memberId:r,groupAssignment:s})=>Object.assign(o({groupId:e,generationId:t,memberId:r,groupAssignment:s}),{apiVersion:1})},93155:(e,t,r)=>{const o=r(56341),{failIfVersionNotSupported:s}=r(21701),{parse:i}=r(15509);e.exports={decode:async e=>{const t=new o(e),r=t.readInt32(),i=t.readInt16();return s(i),{throttleTime:r,errorCode:i,memberAssignment:t.readBytes()}},parse:i}},91901:(e,t,r)=>{const o=r(12596);e.exports=({groupId:e,generationId:t,memberId:r,groupAssignment:s})=>Object.assign(o({groupId:e,generationId:t,memberId:r,groupAssignment:s}),{apiVersion:2})},70015:(e,t,r)=>{const{parse:o,decode:s}=r(93155);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},97203:(e,t,r)=>{const o=r(28783),{SyncGroup:s}=r(99211);e.exports=({groupId:e,generationId:t,memberId:r,groupInstanceId:n=null,groupAssignment:a})=>({apiKey:s,apiVersion:3,apiName:"SyncGroup",encode:async()=>(new o).writeString(e).writeInt32(t).writeString(r).writeString(n).writeArray(a.map(i))});const i=({memberId:e,memberAssignment:t})=>(new o).writeString(e).writeBytes(t)},72745:(e,t,r)=>{const{decode:o,parse:s}=r(70015);e.exports={decode:o,parse:s}},35302:(e,t,r)=>{const o={0:({transactionalId:e,groupId:t,producerId:o,producerEpoch:s,topics:i})=>{const n=r(44021),a=r(84272);return{request:n({transactionalId:e,groupId:t,producerId:o,producerEpoch:s,topics:i}),response:a}},1:({transactionalId:e,groupId:t,producerId:o,producerEpoch:s,topics:i})=>{const n=r(52944),a=r(79560);return{request:n({transactionalId:e,groupId:t,producerId:o,producerEpoch:s,topics:i}),response:a}}};e.exports={versions:Object.keys(o),protocol:({version:e})=>o[e]}},44021:(e,t,r)=>{const o=r(28783),{TxnOffsetCommit:s}=r(99211);e.exports=({transactionalId:e,groupId:t,producerId:r,producerEpoch:n,topics:a})=>({apiKey:s,apiVersion:0,apiName:"TxnOffsetCommit",encode:async()=>(new o).writeString(e).writeString(t).writeInt64(r).writeInt16(n).writeArray(a.map(i))});const i=({topic:e,partitions:t})=>(new o).writeString(e).writeArray(t.map(n)),n=({partition:e,offset:t,metadata:r})=>(new o).writeInt32(e).writeInt64(t).writeString(r)},84272:(e,t,r)=>{const o=r(56341),{failure:s,createErrorFromCode:i}=r(21701),n=async e=>({topic:e.readString(),partitions:await e.readArrayAsync(a)}),a=e=>({partition:e.readInt32(),errorCode:e.readInt16()});e.exports={decode:async e=>{const t=new o(e);return{throttleTime:t.readInt32(),topics:await t.readArrayAsync(n)}},parse:async e=>{const t=e.topics.map((({partitions:e})=>({partitionsWithErrors:e.filter((({errorCode:e})=>s(e)))}))).filter((({partitionsWithErrors:e})=>e.length));if(t.length>0)throw i(t[0].partitionsWithErrors[0].errorCode);return e}}},52944:(e,t,r)=>{const o=r(44021);e.exports=({transactionalId:e,groupId:t,producerId:r,producerEpoch:s,topics:i})=>Object.assign(o({transactionalId:e,groupId:t,producerId:r,producerEpoch:s,topics:i}),{apiVersion:1})},79560:(e,t,r)=>{const{parse:o,decode:s}=r(84272);e.exports={decode:async e=>{const t=await s(e);return{...t,throttleTime:0,clientSideThrottleTime:t.throttleTime}},parse:o}},98203:e=>{e.exports={UNKNOWN:0,ANY:1,MATCH:2,LITERAL:3,PREFIXED:4}},75320:(e,t,r)=>{const o=r(77666);e.exports=o},71128:(e,t,r)=>{e.exports={request:r(30326),response:r(21391)}},30326:(e,t,r)=>{const o=r(28783);e.exports=({authorizationIdentity:e,accessKeyId:t,secretAccessKey:r,sessionToken:s=""})=>({encode:async()=>(new o).writeBytes([e,t,r,s].join("\0"))})},21391:e=>{e.exports={decode:async()=>!0,parse:async()=>!0}},13860:(e,t,r)=>{e.exports={request:r(38824),response:r(32303)}},38824:(e,t,r)=>{const o=r(28783);e.exports=async({authorizationIdentity:e=null},t)=>{const r=null==e?"":`"a=${e}`;let s=function(e){let t="";if(null==e)return t;let r="";for(const o in e)t+=`${r}${o}=${e[o]}`,r="";return t}(t.extensions);s.length>0&&(s=`${s}`);const i=`n,${r},auth=Bearer ${t.value}${s}`;return{encode:async()=>(new o).writeBytes(Buffer.from(i))}}},32303:e=>{e.exports={decode:async()=>!0,parse:async()=>!0}},17733:(e,t,r)=>{e.exports={request:r(17985),response:r(17914)}},17985:(e,t,r)=>{const o=r(28783);e.exports=({authorizationIdentity:e=null,username:t,password:r})=>({encode:async()=>(new o).writeBytes([e,t,r].join("\0"))})},17914:e=>{e.exports={decode:async()=>!0,parse:async()=>!0}},22745:(e,t,r)=>{const o=r(28783);e.exports=({finalMessage:e})=>({encode:async()=>(new o).writeBytes(e)})},776:(e,t,r)=>{e.exports=r(18703)},61224:(e,t,r)=>{const o=r(28783);e.exports=({clientFirstMessage:e})=>({encode:async()=>(new o).writeBytes(e)})},18703:(e,t,r)=>{const o=r(56341),s=/^([rsiev])=(.*)$/;e.exports={decode:async e=>new o(e).readBytes(),parse:async e=>{const t=e.toString().split(",").map((e=>{const[t,r,o]=e.match(s);return[r,o]})).reduce(((e,t)=>({...e,[t[0]]:t[1]})),{});return{original:e.toString(),...t}}}},82337:(e,t,r)=>{e.exports={firstMessage:{request:r(61224),response:r(18703)},finalMessage:{request:r(22745),response:r(776)}}},62515:e=>{e.exports={NO_TIMESTAMP:-1,CREATE_TIME:0,LOG_APPEND_TIME:1}},27727:e=>{e.exports={maxRetryTime:3e4,initialRetryTime:300,factor:.2,multiplier:2,retries:5}},6045:e=>{e.exports={maxRetryTime:1e3,initialRetryTime:50,factor:.02,multiplier:1.5,retries:15}},99701:(e,t,r)=>{const{KafkaJSNumberOfRetriesExceeded:o,KafkaJSNonRetriableError:s}=r(29879),i=r(27727),n=(e,t)=>{const r=e*t;return Math.ceil((o=t-r,s=t+r,Math.random()*(s-o)+o));var o,s},a=["RangeError","ReferenceError","SyntaxError","TypeError"],c=(e,t,r,i)=>{let c=!1;const{factor:p,multiplier:d,maxRetryTime:u,retries:l}=e,h=e=>{c=!0,r(e||new Error("Aborted"))},m=(e,f=0)=>{if(c)return;const g=(e=>Math.min(n(p,e)*d,u))(e),I=f<l;i(h,f,e).then(t).catch((t=>{(e=>{return(e.retriable||!1!==e.retriable)&&(t=e,!a.includes(t.name));var t})(t)?I?setTimeout((()=>m(g,f+1)),e):r(new o(t,{retryCount:f,retryTime:e})):r(new s(t))}))};return m};e.exports=(e={})=>t=>new Promise(((r,o)=>{const s=Object.assign({},i,e);c(s,r,o,t)(n(s.factor,s.initialRetryTime))}))},8351:e=>{e.exports=(e,t)=>{const r=[],o=e.length;let s=0;for(;s<o;)-1===t.indexOf(e[s])&&r.push(e[s]),s+=1;return r}},15002:e=>{const t=e=>{throw e};e.exports=function*(e,r=t){const o=[],s=[];for(e.forEach((e=>{let t,i;o.push(new Promise(((e,r)=>{t=e,i=r}))),s.push({resolve:t,reject:i}),e.then((e=>{const{resolve:t}=s.pop();t(e)}),(async e=>{const{reject:t}=s.pop();try{await r(e),t(e)}catch(e){t(e)}}))}));o.length>0;){const e=o.pop();yield e}}},24230:(e,t,r)=>{const{KafkaJSNonRetriableError:o}=r(29879),s=new o("Queued function aborted due to earlier promise rejection");function i(){}e.exports=({limit:e,onChange:t=i}={})=>{if(isNaN(e)||"number"!=typeof e||e<1)throw new o('"limit" cannot be less than 1');let r=[],n=0;const a=(e,o,i)=>{n++,t(n),e().then((e=>{o(e),n--,t(n),r.length>0&&r.shift()()})).catch((e=>{i(e),(()=>{for(const e of r)e(((e,t,r)=>r(s)));r=[],n=0})()}))};return t=>new Promise(((o,s)=>((t,o,s)=>{n<e?a(t,o,s):r.push((e=>{(e||a)(t,o,s)}))})(t,o,s)))}},74358:e=>{e.exports=function(e){return[].concat.apply([],e)}},53163:e=>{e.exports=async(e,t)=>{const r=new Map;for(const o of e){const e=await Promise.resolve(t(o));r.set(e,r.has(e)?[...r.get(e),o]:[o])}return r}},4105:(e,t,r)=>{const{format:o}=r(73837),{KafkaJSLockTimeout:s}=r(29879),i=Symbol("private:Lock:locked"),n=Symbol("private:Lock:timeout"),a=Symbol("private:Lock:waiting"),c=Symbol("private:Lock:timeoutErrorMessage");e.exports=class{constructor({timeout:e,description:t=null}={}){if("number"!=typeof e)throw new TypeError(`'timeout' is not a number, received '${typeof e}'`);this[i]=!1,this[n]=e,this[a]=new Set,this[c]=()=>{const e=o("Timeout while acquiring lock (%d waiting locks)",this[a].size);return t?`${e}: "${t}"`:e}}async acquire(){return new Promise(((e,t)=>{if(!this[i])return this[i]=!0,e();let r=null;const o=async()=>{if(!this[i])return this[i]=!0,clearTimeout(r),this[a].delete(o),e()};this[a].add(o),r=setTimeout((()=>{const e=new s(this[c]());this[a].delete(o),t(e)}),this[n])}))}async release(){this[i]=!1;const e=this[a].values().next().value;if(e)return e()}}},73278:e=>{class t{constructor(e){this.value=e}static isLong(e){return"bigint"==typeof e.value}static fromBits(e){return new t(BigInt(e))}static fromInt(e){return isNaN(e)?t.ZERO:new t(BigInt.asIntN(64,BigInt(e)))}static fromNumber(e){return isNaN(e)?t.ZERO:new t(BigInt(e))}static fromValue(e){return"number"==typeof e?this.fromNumber(e):"string"==typeof e?this.fromString(e):"bigint"==typeof e?new t(e):this.isLong(e)?new t(BigInt(e.value)):new t(BigInt(e))}static fromString(e){if(0===e.length)throw Error("empty string");return"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e?t.ZERO:new t(BigInt(e))}isZero(){return this.value===BigInt(0)}isNegative(){return this.value<BigInt(0)}toString(){return String(this.value)}toNumber(){return Number(this.value)}toInt(){return Number(BigInt.asIntN(32,this.value))}toJSON(){return this.toString()}shiftLeft(e){return new t(this.value<<BigInt(e))}shiftRight(e){return new t(this.value>>BigInt(e))}or(e){return t.isLong(e)||(e=t.fromValue(e)),t.fromBits(this.value|e.value)}xor(e){return t.isLong(e)||(e=t.fromValue(e)),new t(this.value^e.value)}and(e){return t.isLong(e)||(e=t.fromValue(e)),new t(this.value&e.value)}not(){return new t(~this.value)}shiftRightUnsigned(e){return new t(this.value>>BigInt.asUintN(64,BigInt(e)))}equals(e){return t.isLong(e)||(e=t.fromValue(e)),this.value===e.value}greaterThanOrEqual(e){return t.isLong(e)||(e=t.fromValue(e)),this.value>=e.value}gte(e){return this.greaterThanOrEqual(e)}notEquals(e){return t.isLong(e)||(e=t.fromValue(e)),!this.equals(e)}add(e){return t.isLong(e)||(e=t.fromValue(e)),new t(this.value+e.value)}subtract(e){return t.isLong(e)||(e=t.fromValue(e)),this.add(e.negate())}multiply(e){return this.isZero()?t.ZERO:(t.isLong(e)||(e=t.fromValue(e)),new t(this.value*e.value))}divide(e){if(t.isLong(e)||(e=t.fromValue(e)),e.isZero())throw Error("division by zero");return new t(this.value/e.value)}compare(e){return t.isLong(e)||(e=t.fromValue(e)),this.value===e.value?0:this.value>e.value?1:e.value>this.value?-1:void 0}lessThan(e){return t.isLong(e)||(e=t.fromValue(e)),this.value<e.value}negate(){return this.equals(t.MIN_VALUE)?t.MIN_VALUE:this.not().add(t.ONE)}getHighBits(){return Number(BigInt.asIntN(32,this.value>>BigInt(32)))}getLowBits(){return Number(BigInt.asIntN(32,this.value))}}t.MIN_VALUE=new t(BigInt("-9223372036854775808")),t.MAX_VALUE=new t(BigInt("9223372036854775807")),t.ZERO=t.fromInt(0),t.ONE=t.fromInt(1),e.exports=t},89026:e=>{e.exports=e=>{let t=null;return(...r)=>(null==t&&(t=e(...r).finally((()=>t=null))),t)}},42464:e=>{e.exports=e=>{if(!Array.isArray(e))throw new TypeError("'array' is not an array");if(e.length<2)return e;const t=e.slice();for(let e=t.length-1;e>0;e--){const r=Math.floor(Math.random()*(e+1)),o=t[e];t[e]=t[r],t[r]=o}return t}},34742:e=>{e.exports=e=>new Promise((t=>{setTimeout(t,e)}))},76:e=>{const{keys:t}=Object;e.exports=e=>t(e).reduce(((t,r)=>({...t,[e[r]]:r})),{})},86335:(e,t,r)=>{const o=r(34742),{KafkaJSTimeout:s}=r(29879);e.exports=(e,{delay:t=50,maxWait:r=1e4,timeoutMessage:i="Timeout",ignoreTimeout:n=!1}={})=>{let a,c=0,p=!1;const d=async(r,s)=>{c+=t,await o(t);try{const t=await e(c);if(t)return p=!0,clearTimeout(a),r(t);d(r,s)}catch(e){p=!0,clearTimeout(a),s(e)}};return new Promise(((e,t)=>{d(e,t),n||(a=setTimeout((()=>{if(!p)return t(new s(i))}),r))}))}},6779:e=>{e.exports=(e,t)=>`https://kafka.js.org/${e}${t?"#"+t:""}`},65557:e=>{"use strict";e.exports=JSON.parse('{"name":"kafkajs","version":"1.16.0","description":"A modern Apache Kafka client for node.js","author":"Tulio Ornelas <ornelas.tulio@gmail.com>","main":"index.js","types":"types/index.d.ts","license":"MIT","keywords":["kafka","sasl","scram"],"engines":{"node":">=10.13.0"},"repository":{"type":"git","url":"https://github.com/tulios/kafkajs.git"},"bugs":{"url":"https://github.com/tulios/kafkajs/issues"},"homepage":"https://kafka.js.org","scripts":{"jest":"export KAFKA_VERSION=${KAFKA_VERSION:=\'2.4\'} && NODE_ENV=test echo \\"KAFKA_VERSION: ${KAFKA_VERSION}\\" && KAFKAJS_DEBUG_PROTOCOL_BUFFERS=1 jest","test:local":"yarn jest --detectOpenHandles","test:debug":"NODE_ENV=test KAFKAJS_DEBUG_PROTOCOL_BUFFERS=1 node --inspect-brk $(yarn bin 2>/dev/null)/jest --detectOpenHandles --runInBand --watch","test:local:watch":"yarn test:local --watch","test":"yarn lint && JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \'yarn jest --ci --maxWorkers=4 --no-watchman --forceExit\'","lint":"find . -path ./node_modules -prune -o -path ./coverage -prune -o -path ./website -prune -o -name \'*.js\' -print0 | xargs -0 eslint","format":"find . -path ./node_modules -prune -o -path ./coverage -prune -o -path ./website -prune -o -name \'*.js\' -print0 | xargs -0 prettier --write","precommit":"lint-staged","test:group:broker":"yarn jest --forceExit --testPathPattern \'src/broker/.*\'","test:group:admin":"yarn jest --forceExit --testPathPattern \'src/admin/.*\'","test:group:producer":"yarn jest --forceExit --testPathPattern \'src/producer/.*\'","test:group:consumer":"yarn jest --forceExit --testPathPattern \'src/consumer/.*.spec.js\'","test:group:others":"yarn jest --forceExit --testPathPattern \'src/(?!(broker|admin|producer|consumer)/).*\'","test:group:oauthbearer":"OAUTHBEARER_ENABLED=1 yarn jest --forceExit src/producer/index.spec.js src/broker/__tests__/connect.spec.js src/consumer/__tests__/connection.spec.js src/broker/__tests__/disconnect.spec.js src/admin/__tests__/connection.spec.js src/broker/__tests__/reauthenticate.spec.js","test:group:broker:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:broker --ci --maxWorkers=4 --no-watchman\\"","test:group:admin:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:admin --ci --maxWorkers=4 --no-watchman\\"","test:group:producer:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:producer --ci --maxWorkers=4 --no-watchman\\"","test:group:consumer:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:consumer --ci --maxWorkers=4 --no-watchman\\"","test:group:others:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml ./scripts/testWithKafka.sh \\"yarn test:group:others --ci --maxWorkers=4 --no-watchman\\"","test:group:oauthbearer:ci":"JEST_JUNIT_OUTPUT_NAME=test-report.xml COMPOSE_FILE=\'docker-compose.2_4_oauthbearer.yml\' ./scripts/testWithKafka.sh \\"yarn test:group:oauthbearer --ci --maxWorkers=4 --no-watchman\\"","test:types":"tsc -p types/"},"devDependencies":{"@types/node":"^12.0.8","@typescript-eslint/typescript-estree":"^1.10.2","eslint":"^6.8.0","eslint-config-prettier":"^6.0.0","eslint-config-standard":"^13.0.1","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^11.0.0","eslint-plugin-prettier":"^3.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.0","execa":"^2.0.3","glob":"^7.1.4","husky":"^3.0.1","ip":"^1.1.5","jest":"^25.1.0","jest-circus":"^25.1.0","jest-extended":"^0.11.2","jest-junit":"^10.0.0","jsonwebtoken":"^8.5.1","lint-staged":"^9.2.0","mockdate":"^2.0.5","prettier":"^1.18.2","semver":"^6.2.0","typescript":"^3.8.3","uuid":"^3.3.2"},"dependencies":{},"lint-staged":{"*.js":["prettier --write","git add"]}}')}};
//# sourceMappingURL=552.js.map